import{a as Ja,b as Ya,c as Xa,d as Rr,e as kd,g as Qa}from"/build/_shared/chunk-2JQO7FFY.js";import{a as jd}from"/build/_shared/chunk-X3BKRH5I.js";import{e as Ga}from"/build/_shared/chunk-5OWR6T3E.js";import{b as $a,y as Wa}from"/build/_shared/chunk-MNTHBBYS.js";import{a as za,b as Tr,c as M,d as ve,e as Fe,f as oe,g as Ne}from"/build/_shared/chunk-ZSCMMWXX.js";var Zs=M((Ar,Qs)=>{(function(i,e){typeof Ar=="object"&&typeof Qs=="object"?Qs.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Ar=="object"?Ar.freighterApi=e():i.freighterApi=e()})(Ar,function(){return function(i){var e={};function r(t){if(e[t])return e[t].exports;var s=e[t]={i:t,l:!1,exports:{}};return i[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=i,r.c=e,r.d=function(t,s,n){r.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:n})},r.r=function(t){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,s){if(1&s&&(t=r(t)),8&s||4&s&&typeof t=="object"&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&s&&typeof t!="string")for(var o in t)r.d(n,o,function(a){return t[a]}.bind(null,o));return n},r.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(s,"a",s),s},r.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},r.p="",r(r.s=0)}([function(i,e,r){"use strict";var t,s;r.r(e),function(l){l.CREATE_ACCOUNT="CREATE_ACCOUNT",l.FUND_ACCOUNT="FUND_ACCOUNT",l.ADD_ACCOUNT="ADD_ACCOUNT",l.IMPORT_ACCOUNT="IMPORT_ACCOUNT",l.IMPORT_HARDWARE_WALLET="IMPORT_HARDWARE_WALLET",l.LOAD_ACCOUNT="LOAD_ACCOUNT",l.MAKE_ACCOUNT_ACTIVE="MAKE_ACCOUNT_ACTIVE",l.UPDATE_ACCOUNT_NAME="UPDATE_ACCOUNT_NAME",l.GET_MNEMONIC_PHRASE="GET_MNEMONIC_PHRASE",l.CONFIRM_MNEMONIC_PHRASE="CONFIRM_MNEMONIC_PHRASE",l.RECOVER_ACCOUNT="RECOVER_ACCOUNT",l.CONFIRM_PASSWORD="CONFIRM_PASSWORD",l.REJECT_ACCESS="REJECT_ACCESS",l.GRANT_ACCESS="GRANT_ACCESS",l.SIGN_TRANSACTION="SIGN_TRANSACTION",l.HANDLE_SIGNED_HW_TRANSACTION="HANDLE_SIGNED_HW_TRANSACTION",l.REJECT_TRANSACTION="REJECT_TRANSACTION",l.SIGN_FREIGHTER_TRANSACTION="SIGN_FREIGHTER_TRANSACTION",l.SIGN_FREIGHTER_SOROBAN_TRANSACTION="SIGN_FREIGHTER_SOROBAN_TRANSACTION",l.ADD_RECENT_ADDRESS="ADD_RECENT_ADDRESS",l.LOAD_RECENT_ADDRESSES="LOAD_RECENT_ADDRESSES",l.SIGN_OUT="SIGN_OUT",l.SHOW_BACKUP_PHRASE="SHOW_BACKUP_PHRASE",l.SAVE_SETTINGS="SAVE_SETTINGS",l.LOAD_SETTINGS="LOAD_SETTINGS",l.GET_CACHED_ASSET_ICON="GET_CACHED_ASSET_ICON",l.CACHE_ASSET_ICON="CACHE_ASSET_ICON",l.GET_CACHED_ASSET_DOMAIN="GET_CACHED_ASSET_DOMAIN",l.CACHE_ASSET_DOMAIN="CACHE_ASSET_DOMAIN",l.GET_BLOCKED_DOMAINS="GET_BLOCKED_DOMAINS",l.ADD_CUSTOM_NETWORK="ADD_CUSTOM_NETWORK",l.CHANGE_NETWORK="CHANGE_NETWORK",l.REMOVE_CUSTOM_NETWORK="REMOVE_CUSTOM_NETWORK",l.EDIT_CUSTOM_NETWORK="EDIT_CUSTOM_NETWORK",l.RESET_EXP_DATA="RESET_EXP_DATA",l.ADD_TOKEN_ID="ADD_TOKEN_ID",l.GET_TOKEN_IDS="GET_TOKEN_IDS"}(t||(t={})),function(l){l.REQUEST_ACCESS="REQUEST_ACCESS",l.SUBMIT_TRANSACTION="SUBMIT_TRANSACTION",l.REQUEST_NETWORK="REQUEST_NETWORK",l.REQUEST_NETWORK_DETAILS="REQUEST_NETWORK_DETAILS",l.REQUEST_CONNECTION_STATUS="REQUEST_CONNECTION_STATUS"}(s||(s={}));let n=l=>{let m=Date.now()+Math.random();return window.postMessage({source:"FREIGHTER_EXTERNAL_MSG_REQUEST",messageId:m,...l},window.location.origin),new Promise(p=>{let f=0;l.type===s.REQUEST_CONNECTION_STATUS&&(f=setTimeout(()=>{p({isConnected:!1}),window.removeEventListener("message",y)},2e3));let y=b=>{var _,S;b.source===window&&((_=b?.data)===null||_===void 0?void 0:_.source)==="FREIGHTER_EXTERNAL_MSG_RESPONSE"&&((S=b?.data)===null||S===void 0?void 0:S.messagedId)===m&&(p(b.data),window.removeEventListener("message",y),clearTimeout(f))};window.addEventListener("message",y,!1)})},o=()=>(async()=>{let l={publicKey:"",error:""};try{l=await n({type:s.REQUEST_ACCESS})}catch(f){console.error(f)}let{publicKey:m,error:p}=l;if(p)throw p;return m})(),a=(l,m)=>(async(p,f,y)=>{let b="",_="",S="";typeof f=="object"?(b=f.network||"",_=f.accountToSign||"",S=f.networkPassphrase||""):(b=f||"",_=y||"");let E={signedTransaction:"",error:""};try{E=await n({transactionXdr:p,network:b,networkPassphrase:S,accountToSign:_,type:s.SUBMIT_TRANSACTION})}catch(T){console.error(T)}let{signedTransaction:w,error:D}=E;if(D)throw D;return w})(l,m),c=()=>window?.freighter?window.freighter:(async()=>{let l={isConnected:!1};try{l=await n({type:s.REQUEST_CONNECTION_STATUS})}catch(m){console.error(m)}return l.isConnected})(),u=()=>(async()=>{let l={network:"",error:""};try{l=await n({type:s.REQUEST_NETWORK})}catch(f){console.error(f)}let{network:m,error:p}=l;if(p)throw p;return m})(),h=()=>(async()=>{let l={networkDetails:{network:"",networkName:"",networkUrl:"",networkPassphrase:""},error:""};try{l=await n({type:s.REQUEST_NETWORK_DETAILS})}catch(_){console.error(_)}let{networkDetails:m,error:p}=l,{network:f,networkUrl:y,networkPassphrase:b}=m;if(p)throw p;return{network:f,networkUrl:y,networkPassphrase:b}})();r.d(e,"getPublicKey",function(){return o}),r.d(e,"signTransaction",function(){return a}),r.d(e,"isConnected",function(){return c}),r.d(e,"getNetwork",function(){return u}),r.d(e,"getNetworkDetails",function(){return h}),e.default={getPublicKey:o,signTransaction:a,isConnected:c,getNetwork:u,getNetworkDetails:h}}])})});var uc=M((q1,cc)=>{"use strict";function Jd(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}cc.exports=Yd;function Yd(i,e,r){var t=r&&r.stringify||Jd,s=1;if(typeof i=="object"&&i!==null){var n=e.length+s;if(n===1)return i;var o=new Array(n);o[0]=t(i);for(var a=1;a<n;a++)o[a]=t(e[a]);return o.join(" ")}if(typeof i!="string")return i;var c=e.length;if(c===0)return i;for(var u="",h=1-s,l=-1,m=i&&i.length||0,p=0;p<m;){if(i.charCodeAt(p)===37&&p+1<m){switch(l=l>-1?l:0,i.charCodeAt(p+1)){case 100:case 102:if(h>=c||e[h]==null)break;l<p&&(u+=i.slice(l,p)),u+=Number(e[h]),l=p+2,p++;break;case 105:if(h>=c||e[h]==null)break;l<p&&(u+=i.slice(l,p)),u+=Math.floor(Number(e[h])),l=p+2,p++;break;case 79:case 111:case 106:if(h>=c||e[h]===void 0)break;l<p&&(u+=i.slice(l,p));var f=typeof e[h];if(f==="string"){u+="'"+e[h]+"'",l=p+2,p++;break}if(f==="function"){u+=e[h].name||"<anonymous>",l=p+2,p++;break}u+=t(e[h]),l=p+2,p++;break;case 115:if(h>=c)break;l<p&&(u+=i.slice(l,p)),u+=String(e[h]),l=p+2,p++;break;case 37:l<p&&(u+=i.slice(l,p)),u+="%",l=p+2,p++,h--;break}++h}++p}return l===-1?i:(l<m&&(u+=i.slice(l)),u)}});var Ai=M((j1,dc)=>{"use strict";var lc=uc();dc.exports=ze;var Lr=op().console||{},Xd={mapHttpRequest:Ti,mapHttpResponse:Ti,wrapRequestSerializer:un,wrapResponseSerializer:un,wrapErrorSerializer:un,req:Ti,res:Ti,err:rp};function Qd(i,e){return Array.isArray(i)?i.filter(function(t){return t!=="!stdSerializers.err"}):i===!0?Object.keys(e):!1}function ze(i){i=i||{},i.browser=i.browser||{};let e=i.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");let r=i.browser.write||Lr;i.browser.write&&(i.browser.asObject=!0);let t=i.serializers||{},s=Qd(i.browser.serialize,t),n=i.browser.serialize;Array.isArray(i.browser.serialize)&&i.browser.serialize.indexOf("!stdSerializers.err")>-1&&(n=!1);let o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),i.enabled===!1&&(i.level="silent");let a=i.level||"info",c=Object.create(r);c.log||(c.log=Ur),Object.defineProperty(c,"levelVal",{get:h}),Object.defineProperty(c,"level",{get:l,set:m});let u={transmit:e,serialize:s,asObject:i.browser.asObject,levels:o,timestamp:ip(i)};c.levels=ze.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=Ur,c.serializers=t,c._serialize=s,c._stdErrSerialize=n,c.child=p,e&&(c._logEvent=ln());function h(){return this.level==="silent"?1/0:this.levels.values[this.level]}function l(){return this._level}function m(f){if(f!=="silent"&&!this.levels.values[f])throw Error("unknown level "+f);this._level=f,Vt(u,c,"error","log"),Vt(u,c,"fatal","error"),Vt(u,c,"warn","error"),Vt(u,c,"info","log"),Vt(u,c,"debug","log"),Vt(u,c,"trace","log")}function p(f,y){if(!f)throw new Error("missing bindings for child Pino");y=y||{},s&&f.serializers&&(y.serializers=f.serializers);let b=y.serializers;if(s&&b){var _=Object.assign({},t,b),S=i.browser.serialize===!0?Object.keys(_):s;delete f.serializers,Ri([f],S,_,this._stdErrSerialize)}function E(w){this._childLevel=(w._childLevel|0)+1,this.error=zt(w,f,"error"),this.fatal=zt(w,f,"fatal"),this.warn=zt(w,f,"warn"),this.info=zt(w,f,"info"),this.debug=zt(w,f,"debug"),this.trace=zt(w,f,"trace"),_&&(this.serializers=_,this._serialize=S),e&&(this._logEvent=ln([].concat(w._logEvent.bindings,f)))}return E.prototype=this,new E(this)}return c}ze.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ze.stdSerializers=Xd;ze.stdTimeFunctions=Object.assign({},{nullTime:hc,epochTime:fc,unixTime:sp,isoTime:np});function Vt(i,e,r,t){let s=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Ur:s[r]?s[r]:Lr[r]||Lr[t]||Ur,Zd(i,e,r)}function Zd(i,e,r){!i.transmit&&e[r]===Ur||(e[r]=function(t){return function(){let n=i.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Lr?Lr:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(i.serialize&&!i.asObject&&Ri(o,this._serialize,this.serializers,this._stdErrSerialize),i.asObject?t.call(a,ep(this,r,o,n)):t.apply(a,o),i.transmit){let u=i.transmit.level||e.level,h=ze.levels.values[u],l=ze.levels.values[r];if(l<h)return;tp(this,{ts:n,methodLevel:r,methodValue:l,transmitLevel:u,transmitValue:ze.levels.values[i.transmit.level||e.level],send:i.transmit.send,val:e.levelVal},o)}}}(e[r]))}function ep(i,e,r,t){i._serialize&&Ri(r,i._serialize,i.serializers,i._stdErrSerialize);let s=r.slice(),n=s[0],o={};t&&(o.time=t),o.level=ze.levels.values[e];let a=(i._childLevel|0)+1;if(a<1&&(a=1),n!==null&&typeof n=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());n=s.length?lc(s.shift(),s):void 0}else typeof n=="string"&&(n=lc(s.shift(),s));return n!==void 0&&(o.msg=n),o}function Ri(i,e,r,t){for(let s in i)if(t&&i[s]instanceof Error)i[s]=ze.stdSerializers.err(i[s]);else if(typeof i[s]=="object"&&!Array.isArray(i[s]))for(let n in i[s])e&&e.indexOf(n)>-1&&n in r&&(i[s][n]=r[n](i[s][n]))}function zt(i,e,r){return function(){let t=new Array(1+arguments.length);t[0]=e;for(var s=1;s<t.length;s++)t[s]=arguments[s-1];return i[r].apply(this,t)}}function tp(i,e,r){let t=e.send,s=e.ts,n=e.methodLevel,o=e.methodValue,a=e.val,c=i._logEvent.bindings;Ri(r,i._serialize||Object.keys(i.serializers),i.serializers,i._stdErrSerialize===void 0?!0:i._stdErrSerialize),i._logEvent.ts=s,i._logEvent.messages=r.filter(function(u){return c.indexOf(u)===-1}),i._logEvent.level.label=n,i._logEvent.level.value=o,t(n,i._logEvent,a),i._logEvent=ln(c)}function ln(i){return{ts:0,messages:[],bindings:i||[],level:{label:"",value:0}}}function rp(i){let e={type:i.constructor.name,msg:i.message,stack:i.stack};for(let r in i)e[r]===void 0&&(e[r]=i[r]);return e}function ip(i){return typeof i.timestamp=="function"?i.timestamp:i.timestamp===!1?hc:fc}function Ti(){return{}}function un(i){return i}function Ur(){}function hc(){return!1}function fc(){return Date.now()}function sp(){return Math.round(Date.now()/1e3)}function np(){return new Date(Date.now()).toISOString()}function op(){function i(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return i(self)||i(window)||i(this)||{}}}});var bc={};ve(bc,{EventEmitter:()=>W,default:()=>$t});function lt(){}function W(){W.init.call(this)}function pc(i){return i._maxListeners===void 0?W.defaultMaxListeners:i._maxListeners}function ap(i,e,r){if(e)i.call(r);else for(var t=i.length,s=Fr(i,t),n=0;n<t;++n)s[n].call(r)}function cp(i,e,r,t){if(e)i.call(r,t);else for(var s=i.length,n=Fr(i,s),o=0;o<s;++o)n[o].call(r,t)}function up(i,e,r,t,s){if(e)i.call(r,t,s);else for(var n=i.length,o=Fr(i,n),a=0;a<n;++a)o[a].call(r,t,s)}function lp(i,e,r,t,s,n){if(e)i.call(r,t,s,n);else for(var o=i.length,a=Fr(i,o),c=0;c<o;++c)a[c].call(r,t,s,n)}function hp(i,e,r,t){if(e)i.apply(r,t);else for(var s=i.length,n=Fr(i,s),o=0;o<s;++o)n[o].apply(r,t)}function gc(i,e,r,t){var s,n,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(n=i._events,n?(n.newListener&&(i.emit("newListener",e,r.listener?r.listener:r),n=i._events),o=n[e]):(n=i._events=new lt,i._eventsCount=0),!o)o=n[e]=r,++i._eventsCount;else if(typeof o=="function"?o=n[e]=t?[r,o]:[o,r]:t?o.unshift(r):o.push(r),!o.warned&&(s=pc(i),s&&s>0&&o.length>s)){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=i,a.type=e,a.count=o.length,fp(a)}return i}function fp(i){typeof console.warn=="function"?console.warn(i):console.log(i)}function mc(i,e,r){var t=!1;function s(){i.removeListener(e,s),t||(t=!0,r.apply(i,arguments))}return s.listener=r,s}function yc(i){var e=this._events;if(e){var r=e[i];if(typeof r=="function")return 1;if(r)return r.length}return 0}function dp(i,e){for(var r=e,t=r+1,s=i.length;t<s;r+=1,t+=1)i[r]=i[t];i.pop()}function Fr(i,e){for(var r=new Array(e);e--;)r[e]=i[e];return r}function pp(i){for(var e=new Array(i.length),r=0;r<e.length;++r)e[r]=i[r].listener||i[r];return e}var hn,$t,xt=Tr(()=>{"use strict";lt.prototype=Object.create(null);$t=W;W.EventEmitter=W;W.usingDomains=!1;W.prototype.domain=void 0;W.prototype._events=void 0;W.prototype._maxListeners=void 0;W.defaultMaxListeners=10;W.init=function(){this.domain=null,W.usingDomains&&hn.active&&!(this instanceof hn.Domain)&&(this.domain=hn.active),(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new lt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};W.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this};W.prototype.getMaxListeners=function(){return pc(this)};W.prototype.emit=function(e){var r,t,s,n,o,a,c,u=!1,h=e==="error";if(a=this._events,a)h=h&&a.error==null;else if(!h)return!1;if(c=this.domain,h){if(r=arguments[1],c)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=c,r.domainThrown=!1,c.emit("error",r);else{if(r instanceof Error)throw r;var l=new Error('Uncaught, unspecified "error" event. ('+r+")");throw l.context=r,l}return!1}if(t=a[e],!t)return!1;var m=typeof t=="function";switch(s=arguments.length,s){case 1:ap(t,m,this);break;case 2:cp(t,m,this,arguments[1]);break;case 3:up(t,m,this,arguments[1],arguments[2]);break;case 4:lp(t,m,this,arguments[1],arguments[2],arguments[3]);break;default:for(n=new Array(s-1),o=1;o<s;o++)n[o-1]=arguments[o];hp(t,m,this,n)}return u&&c.exit(),!0};W.prototype.addListener=function(e,r){return gc(this,e,r,!1)};W.prototype.on=W.prototype.addListener;W.prototype.prependListener=function(e,r){return gc(this,e,r,!0)};W.prototype.once=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,mc(this,e,r)),this};W.prototype.prependOnceListener=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,mc(this,e,r)),this};W.prototype.removeListener=function(e,r){var t,s,n,o,a;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(s=this._events,!s)return this;if(t=s[e],!t)return this;if(t===r||t.listener&&t.listener===r)--this._eventsCount===0?this._events=new lt:(delete s[e],s.removeListener&&this.emit("removeListener",e,t.listener||r));else if(typeof t!="function"){for(n=-1,o=t.length;o-- >0;)if(t[o]===r||t[o].listener&&t[o].listener===r){a=t[o].listener,n=o;break}if(n<0)return this;if(t.length===1){if(t[0]=void 0,--this._eventsCount===0)return this._events=new lt,this;delete s[e]}else dp(t,n);s.removeListener&&this.emit("removeListener",e,a||r)}return this};W.prototype.removeAllListeners=function(e){var r,t;if(t=this._events,!t)return this;if(!t.removeListener)return arguments.length===0?(this._events=new lt,this._eventsCount=0):t[e]&&(--this._eventsCount===0?this._events=new lt:delete t[e]),this;if(arguments.length===0){for(var s=Object.keys(t),n=0,o;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new lt,this._eventsCount=0,this}if(r=t[e],typeof r=="function")this.removeListener(e,r);else if(r)do this.removeListener(e,r[r.length-1]);while(r[0]);return this};W.prototype.listeners=function(e){var r,t,s=this._events;return s?(r=s[e],r?typeof r=="function"?t=[r.listener||r]:t=pp(r):t=[]):t=[],t};W.listenerCount=function(i,e){return typeof i.listenerCount=="function"?i.listenerCount(e):yc.call(i,e)};W.prototype.listenerCount=yc;W.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}});var Me={};ve(Me,{__assign:()=>dn,__asyncDelegator:()=>Op,__asyncGenerator:()=>Ip,__asyncValues:()=>Tp,__await:()=>Mr,__awaiter:()=>_p,__classPrivateFieldGet:()=>Cp,__classPrivateFieldSet:()=>Pp,__createBinding:()=>vp,__decorate:()=>yp,__exportStar:()=>xp,__extends:()=>gp,__generator:()=>Ep,__importDefault:()=>Np,__importStar:()=>Ap,__makeTemplateObject:()=>Rp,__metadata:()=>wp,__param:()=>bp,__read:()=>wc,__rest:()=>mp,__spread:()=>Sp,__spreadArrays:()=>Dp,__values:()=>pn});function gp(i,e){fn(i,e);function r(){this.constructor=i}i.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function mp(i,e){var r={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(r[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(i);s<t.length;s++)e.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(i,t[s])&&(r[t[s]]=i[t[s]]);return r}function yp(i,e,r,t){var s=arguments.length,n=s<3?e:t===null?t=Object.getOwnPropertyDescriptor(e,r):t,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(i,e,r,t);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n}function bp(i,e){return function(r,t){e(r,t,i)}}function wp(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function _p(i,e,r,t){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function a(h){try{u(t.next(h))}catch(l){o(l)}}function c(h){try{u(t.throw(h))}catch(l){o(l)}}function u(h){h.done?n(h.value):s(h.value).then(a,c)}u((t=t.apply(i,e||[])).next())})}function Ep(i,e){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},t,s,n,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(h){return c([u,h])}}function c(u){if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,s&&(n=u[0]&2?s.return:u[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,u[1])).done)return n;switch(s=0,n&&(u=[u[0]&2,n.value]),u[0]){case 0:case 1:n=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!(n=n.length>0&&n[n.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!n||u[1]>n[0]&&u[1]<n[3])){r.label=u[1];break}if(u[0]===6&&r.label<n[1]){r.label=n[1],n=u;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(u);break}n[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(i,r)}catch(h){u=[6,h],s=0}finally{t=n=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function vp(i,e,r,t){t===void 0&&(t=r),i[t]=e[r]}function xp(i,e){for(var r in i)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=i[r])}function pn(i){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&i[e],t=0;if(r)return r.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&t>=i.length&&(i=void 0),{value:i&&i[t++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wc(i,e){var r=typeof Symbol=="function"&&i[Symbol.iterator];if(!r)return i;var t=r.call(i),s,n=[],o;try{for(;(e===void 0||e-- >0)&&!(s=t.next()).done;)n.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return n}function Sp(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(wc(arguments[e]));return i}function Dp(){for(var i=0,e=0,r=arguments.length;e<r;e++)i+=arguments[e].length;for(var t=Array(i),s=0,e=0;e<r;e++)for(var n=arguments[e],o=0,a=n.length;o<a;o++,s++)t[s]=n[o];return t}function Mr(i){return this instanceof Mr?(this.v=i,this):new Mr(i)}function Ip(i,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=r.apply(i,e||[]),s,n=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(m){t[m]&&(s[m]=function(p){return new Promise(function(f,y){n.push([m,p,f,y])>1||a(m,p)})})}function a(m,p){try{c(t[m](p))}catch(f){l(n[0][3],f)}}function c(m){m.value instanceof Mr?Promise.resolve(m.value.v).then(u,h):l(n[0][2],m)}function u(m){a("next",m)}function h(m){a("throw",m)}function l(m,p){m(p),n.shift(),n.length&&a(n[0][0],n[0][1])}}function Op(i){var e,r;return e={},t("next"),t("throw",function(s){throw s}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(s,n){e[s]=i[s]?function(o){return(r=!r)?{value:Mr(i[s](o)),done:s==="return"}:n?n(o):o}:n}}function Tp(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],r;return e?e.call(i):(i=typeof pn=="function"?pn(i):i[Symbol.iterator](),r={},t("next"),t("throw"),t("return"),r[Symbol.asyncIterator]=function(){return this},r);function t(n){r[n]=i[n]&&function(o){return new Promise(function(a,c){o=i[n](o),s(a,c,o.done,o.value)})}}function s(n,o,a,c){Promise.resolve(c).then(function(u){n({value:u,done:a})},o)}}function Rp(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function Ap(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var r in i)Object.hasOwnProperty.call(i,r)&&(e[r]=i[r]);return e.default=i,e}function Np(i){return i&&i.__esModule?i:{default:i}}function Cp(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function Pp(i,e,r){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,r),r}var fn,dn,qe=Tr(()=>{fn=function(i,e){return fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var s in t)t.hasOwnProperty(s)&&(r[s]=t[s])},fn(i,e)};dn=function(){return dn=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++){r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dn.apply(this,arguments)}});var gn=M(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});function Lp(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSON.parse(i)}catch{return i}}Ni.safeJsonParse=Lp;function Up(i){return typeof i=="string"?i:JSON.stringify(i,(e,r)=>typeof r>"u"?null:r)}Ni.safeJsonStringify=Up});var _c=M((B1,Ci)=>{"use strict";(function(){"use strict";let i;function e(){}i=e,i.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},i.prototype.setItem=function(r,t){this[r]=String(t)},i.prototype.removeItem=function(r){delete this[r]},i.prototype.clear=function(){let r=this;Object.keys(r).forEach(function(t){r[t]=void 0,delete r[t]})},i.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof globalThis<"u"&&globalThis.localStorage?Ci.exports=globalThis.localStorage:typeof window<"u"&&window.localStorage?Ci.exports=window.localStorage:Ci.exports=new e})()});var Ec=M(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.IKeyValueStorage=void 0;var mn=class{};Pi.IKeyValueStorage=mn});var vc=M(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.parseEntry=void 0;var Fp=gn();function Mp(i){var e;return[i[0],Fp.safeJsonParse((e=i[1])!==null&&e!==void 0?e:"")]}Li.parseEntry=Mp});var Sc=M(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});var xc=(qe(),Ne(Me));xc.__exportStar(Ec(),Ui);xc.__exportStar(vc(),Ui)});var Ic=M(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.KeyValueStorage=void 0;var Gt=(qe(),Ne(Me)),Dc=gn(),qp=Gt.__importDefault(_c()),jp=Sc(),Fi=class{constructor(){this.localStorage=qp.default}getKeys(){return Gt.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Gt.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(jp.parseEntry)})}getItem(e){return Gt.__awaiter(this,void 0,void 0,function*(){let r=this.localStorage.getItem(e);if(r!==null)return Dc.safeJsonParse(r)})}setItem(e,r){return Gt.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Dc.safeJsonStringify(r))})}removeItem(e){return Gt.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}};qr.KeyValueStorage=Fi;qr.default=Fi});var Oc=M(($1,Mi)=>{var St=(xt(),Ne(bc));if(St&&St.default){Mi.exports=St.default;for(let i in St)Mi.exports[i]=St[i]}else St&&(Mi.exports=St)});var Tc=M(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.delay=void 0;function kp(i){return new Promise(e=>{setTimeout(()=>{e(!0)},i)})}qi.delay=kp});var Rc=M(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.ONE_THOUSAND=Wt.ONE_HUNDRED=void 0;Wt.ONE_HUNDRED=100;Wt.ONE_THOUSAND=1e3});var Ac=M(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.ONE_YEAR=P.FOUR_WEEKS=P.THREE_WEEKS=P.TWO_WEEKS=P.ONE_WEEK=P.THIRTY_DAYS=P.SEVEN_DAYS=P.FIVE_DAYS=P.THREE_DAYS=P.ONE_DAY=P.TWENTY_FOUR_HOURS=P.TWELVE_HOURS=P.SIX_HOURS=P.THREE_HOURS=P.ONE_HOUR=P.SIXTY_MINUTES=P.THIRTY_MINUTES=P.TEN_MINUTES=P.FIVE_MINUTES=P.ONE_MINUTE=P.SIXTY_SECONDS=P.THIRTY_SECONDS=P.TEN_SECONDS=P.FIVE_SECONDS=P.ONE_SECOND=void 0;P.ONE_SECOND=1;P.FIVE_SECONDS=5;P.TEN_SECONDS=10;P.THIRTY_SECONDS=30;P.SIXTY_SECONDS=60;P.ONE_MINUTE=P.SIXTY_SECONDS;P.FIVE_MINUTES=P.ONE_MINUTE*5;P.TEN_MINUTES=P.ONE_MINUTE*10;P.THIRTY_MINUTES=P.ONE_MINUTE*30;P.SIXTY_MINUTES=P.ONE_MINUTE*60;P.ONE_HOUR=P.SIXTY_MINUTES;P.THREE_HOURS=P.ONE_HOUR*3;P.SIX_HOURS=P.ONE_HOUR*6;P.TWELVE_HOURS=P.ONE_HOUR*12;P.TWENTY_FOUR_HOURS=P.ONE_HOUR*24;P.ONE_DAY=P.TWENTY_FOUR_HOURS;P.THREE_DAYS=P.ONE_DAY*3;P.FIVE_DAYS=P.ONE_DAY*5;P.SEVEN_DAYS=P.ONE_DAY*7;P.THIRTY_DAYS=P.ONE_DAY*30;P.ONE_WEEK=P.SEVEN_DAYS;P.TWO_WEEKS=P.ONE_WEEK*2;P.THREE_WEEKS=P.ONE_WEEK*3;P.FOUR_WEEKS=P.ONE_WEEK*4;P.ONE_YEAR=P.ONE_DAY*365});var yn=M(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});var Nc=(qe(),Ne(Me));Nc.__exportStar(Rc(),ji);Nc.__exportStar(Ac(),ji)});var Pc=M(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.fromMiliseconds=Jt.toMiliseconds=void 0;var Cc=yn();function Bp(i){return i*Cc.ONE_THOUSAND}Jt.toMiliseconds=Bp;function Hp(i){return Math.floor(i/Cc.ONE_THOUSAND)}Jt.fromMiliseconds=Hp});var Uc=M(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});var Lc=(qe(),Ne(Me));Lc.__exportStar(Tc(),ki);Lc.__exportStar(Pc(),ki)});var Fc=M(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.Watch=void 0;var Bi=class{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){let r=this.get(e);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${e}`);let t=Date.now()-r.started;this.timestamps.set(e,{started:r.started,elapsed:t})}get(e){let r=this.timestamps.get(e);if(typeof r>"u")throw new Error(`No timestamp found for label: ${e}`);return r}elapsed(e){let r=this.get(e);return r.elapsed||Date.now()-r.started}};jr.Watch=Bi;jr.default=Bi});var Mc=M(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});Hi.IWatch=void 0;var bn=class{};Hi.IWatch=bn});var qc=M(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});var Kp=(qe(),Ne(Me));Kp.__exportStar(Mc(),wn)});var Dt=M(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var Ki=(qe(),Ne(Me));Ki.__exportStar(Uc(),Yt);Ki.__exportStar(Fc(),Yt);Ki.__exportStar(qc(),Yt);Ki.__exportStar(yn(),Yt)});var $e,jc=Tr(()=>{$e=class{}});var kc={};ve(kc,{IEvents:()=>$e});var _n=Tr(()=>{jc()});var Bc=M(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.IHeartBeat=void 0;var Vp=(_n(),Ne(kc)),En=class extends Vp.IEvents{constructor(e){super()}};Vi.IHeartBeat=En});var xn=M(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});var zp=(qe(),Ne(Me));zp.__exportStar(Bc(),vn)});var Hc=M(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.HEARTBEAT_EVENTS=Xt.HEARTBEAT_INTERVAL=void 0;var $p=Dt();Xt.HEARTBEAT_INTERVAL=$p.FIVE_SECONDS;Xt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}});var Dn=M(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});var Gp=(qe(),Ne(Me));Gp.__exportStar(Hc(),Sn)});var Kc=M(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.HeartBeat=void 0;var In=(qe(),Ne(Me)),Wp=Oc(),Jp=Dt(),Yp=xn(),On=Dn(),kr=class extends Yp.IHeartBeat{constructor(e){super(e),this.events=new Wp.EventEmitter,this.interval=On.HEARTBEAT_INTERVAL,this.interval=e?.interval||On.HEARTBEAT_INTERVAL}static init(e){return In.__awaiter(this,void 0,void 0,function*(){let r=new kr(e);return yield r.init(),r})}init(){return In.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}initialize(){return In.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),Jp.toMiliseconds(this.interval))})}pulse(){this.events.emit(On.HEARTBEAT_EVENTS.pulse)}};zi.HeartBeat=kr});var Vc=M(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});var Tn=(qe(),Ne(Me));Tn.__exportStar(Kc(),Br);Tn.__exportStar(xn(),Br);Tn.__exportStar(Dn(),Br)});var Rn=M(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.PINO_CUSTOM_CONTEXT_KEY=Qt.PINO_LOGGER_DEFAULTS=void 0;Qt.PINO_LOGGER_DEFAULTS={level:"info"};Qt.PINO_CUSTOM_CONTEXT_KEY="custom_context"});var Jc=M(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.generateChildLogger=Le.formatChildLoggerContext=Le.getLoggerContext=Le.setBrowserLoggerContext=Le.getBrowserLoggerContext=Le.getDefaultLoggerOptions=void 0;var Zt=Rn();function Xp(i){return Object.assign(Object.assign({},i),{level:i?.level||Zt.PINO_LOGGER_DEFAULTS.level})}Le.getDefaultLoggerOptions=Xp;function zc(i,e=Zt.PINO_CUSTOM_CONTEXT_KEY){return i[e]||""}Le.getBrowserLoggerContext=zc;function $c(i,e,r=Zt.PINO_CUSTOM_CONTEXT_KEY){return i[r]=e,i}Le.setBrowserLoggerContext=$c;function Gc(i,e=Zt.PINO_CUSTOM_CONTEXT_KEY){let r="";return typeof i.bindings>"u"?r=zc(i,e):r=i.bindings().context||"",r}Le.getLoggerContext=Gc;function Wc(i,e,r=Zt.PINO_CUSTOM_CONTEXT_KEY){let t=Gc(i,r);return t.trim()?`${t}/${e}`:e}Le.formatChildLoggerContext=Wc;function Qp(i,e,r=Zt.PINO_CUSTOM_CONTEXT_KEY){let t=Wc(i,e,r),s=i.child({context:t});return $c(s,t,r)}Le.generateChildLogger=Qp});var Nn=M(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.pino=void 0;var An=(qe(),Ne(Me)),Zp=An.__importDefault(Ai());Object.defineProperty(er,"pino",{enumerable:!0,get:function(){return Zp.default}});An.__exportStar(Rn(),er);An.__exportStar(Jc(),er)});var Xc=M(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.BrowserRandomSource=void 0;var Yc=65536,Cn=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let r=new Uint8Array(e);for(let t=0;t<r.length;t+=Yc)this._crypto.getRandomValues(r.subarray(t,t+Math.min(r.length-t,Yc)));return r}};rs.BrowserRandomSource=Cn});var Be=M(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});function rg(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Pn.wipe=rg});var Qc={};ve(Qc,{default:()=>ig});var ig,Zc=Tr(()=>{ig={}});var eu=M((_v,is)=>{var It=(Zc(),Ne(Qc));if(It&&It.default){is.exports=It.default;for(let i in It)is.exports[i]=It[i]}else It&&(is.exports=It)});var tu=M(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.NodeRandomSource=void 0;var sg=Be(),Ln=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof za<"u"){let e=eu();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");let t=new Uint8Array(e);for(let s=0;s<t.length;s++)t[s]=r[s];return(0,sg.wipe)(r),t}};ss.NodeRandomSource=Ln});var ru=M(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.SystemRandomSource=void 0;var ng=Xc(),og=tu(),Un=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new ng.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new og.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}};ns.SystemRandomSource=Un});var iu=M(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});function ag(i,e){var r=i>>>16&65535,t=i&65535,s=e>>>16&65535,n=e&65535;return t*n+(r*n+t*s<<16>>>0)|0}je.mul=Math.imul||ag;function cg(i,e){return i+e|0}je.add=cg;function ug(i,e){return i-e|0}je.sub=ug;function lg(i,e){return i<<e|i>>>32-e}je.rotl=lg;function hg(i,e){return i<<32-e|i>>>e}je.rotr=hg;function fg(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i}je.isInteger=Number.isInteger||fg;je.MAX_SAFE_INTEGER=9007199254740991;je.isSafeInteger=function(i){return je.isInteger(i)&&i>=-je.MAX_SAFE_INTEGER&&i<=je.MAX_SAFE_INTEGER}});var rr=M(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});var su=iu();function dg(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}ee.readInt16BE=dg;function pg(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}ee.readUint16BE=pg;function gg(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}ee.readInt16LE=gg;function mg(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}ee.readUint16LE=mg;function nu(i,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=i>>>8,e[r+1]=i>>>0,e}ee.writeUint16BE=nu;ee.writeInt16BE=nu;function ou(i,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=i>>>0,e[r+1]=i>>>8,e}ee.writeUint16LE=ou;ee.writeInt16LE=ou;function Fn(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}ee.readInt32BE=Fn;function Mn(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}ee.readUint32BE=Mn;function qn(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}ee.readInt32LE=qn;function jn(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}ee.readUint32LE=jn;function os(i,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=i>>>24,e[r+1]=i>>>16,e[r+2]=i>>>8,e[r+3]=i>>>0,e}ee.writeUint32BE=os;ee.writeInt32BE=os;function as(i,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=i>>>0,e[r+1]=i>>>8,e[r+2]=i>>>16,e[r+3]=i>>>24,e}ee.writeUint32LE=as;ee.writeInt32LE=as;function yg(i,e){e===void 0&&(e=0);var r=Fn(i,e),t=Fn(i,e+4);return r*4294967296+t-(t>>31)*4294967296}ee.readInt64BE=yg;function bg(i,e){e===void 0&&(e=0);var r=Mn(i,e),t=Mn(i,e+4);return r*4294967296+t}ee.readUint64BE=bg;function wg(i,e){e===void 0&&(e=0);var r=qn(i,e),t=qn(i,e+4);return t*4294967296+r-(r>>31)*4294967296}ee.readInt64LE=wg;function _g(i,e){e===void 0&&(e=0);var r=jn(i,e),t=jn(i,e+4);return t*4294967296+r}ee.readUint64LE=_g;function au(i,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),os(i/4294967296>>>0,e,r),os(i>>>0,e,r+4),e}ee.writeUint64BE=au;ee.writeInt64BE=au;function cu(i,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),as(i>>>0,e,r),as(i/4294967296>>>0,e,r+4),e}ee.writeUint64LE=cu;ee.writeInt64LE=cu;function Eg(i,e,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var t=0,s=1,n=i/8+r-1;n>=r;n--)t+=e[n]*s,s*=256;return t}ee.readUintBE=Eg;function vg(i,e,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var t=0,s=1,n=r;n<r+i/8;n++)t+=e[n]*s,s*=256;return t}ee.readUintLE=vg;function xg(i,e,r,t){if(r===void 0&&(r=new Uint8Array(i/8)),t===void 0&&(t=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!su.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var s=1,n=i/8+t-1;n>=t;n--)r[n]=e/s&255,s*=256;return r}ee.writeUintBE=xg;function Sg(i,e,r,t){if(r===void 0&&(r=new Uint8Array(i/8)),t===void 0&&(t=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!su.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var s=1,n=t;n<t+i/8;n++)r[n]=e/s&255,s*=256;return r}ee.writeUintLE=Sg;function Dg(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(e)}ee.readFloat32BE=Dg;function Ig(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(e,!0)}ee.readFloat32LE=Ig;function Og(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(e)}ee.readFloat64BE=Og;function Tg(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(e,!0)}ee.readFloat64LE=Tg;function Rg(i,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat32(r,i),e}ee.writeFloat32BE=Rg;function Ag(i,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat32(r,i,!0),e}ee.writeFloat32LE=Ag;function Ng(i,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat64(r,i),e}ee.writeFloat64BE=Ng;function Cg(i,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat64(r,i,!0),e}ee.writeFloat64LE=Cg});var Kr=M(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.randomStringForEntropy=Ie.randomString=Ie.randomUint32=Ie.randomBytes=Ie.defaultRandomSource=void 0;var Pg=ru(),Lg=rr(),uu=Be();Ie.defaultRandomSource=new Pg.SystemRandomSource;function kn(i,e=Ie.defaultRandomSource){return e.randomBytes(i)}Ie.randomBytes=kn;function Ug(i=Ie.defaultRandomSource){let e=kn(4,i),r=(0,Lg.readUint32LE)(e);return(0,uu.wipe)(e),r}Ie.randomUint32=Ug;var lu="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function hu(i,e=lu,r=Ie.defaultRandomSource){if(e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");let t="",s=e.length,n=256-256%s;for(;i>0;){let o=kn(Math.ceil(i*256/n),r);for(let a=0;a<o.length&&i>0;a++){let c=o[a];c<n&&(t+=e.charAt(c%s),i--)}(0,uu.wipe)(o)}return t}Ie.randomString=hu;function Fg(i,e=lu,r=Ie.defaultRandomSource){let t=Math.ceil(i/(Math.log(e.length)/Math.LN2));return hu(t,e,r)}Ie.randomStringForEntropy=Fg});var pu=M(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});var sr=rr(),ir=Be();et.DIGEST_LENGTH=64;et.BLOCK_SIZE=128;var du=function(){function i(){this.digestLength=et.DIGEST_LENGTH,this.blockSize=et.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){ir.wipe(this._buffer),ir.wipe(this._tempHi),ir.wipe(this._tempLo),this.reset()},i.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var t=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<et.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=e[t++],r--;this._bufferLength===this.blockSize&&(Bn(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(t=Bn(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,t,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[t++],r--;return this},i.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,t=this._bufferLength,s=r/536870912|0,n=r<<3,o=r%128<112?128:256;this._buffer[t]=128;for(var a=t+1;a<o-8;a++)this._buffer[a]=0;sr.writeUint32BE(s,this._buffer,o-8),sr.writeUint32BE(n,this._buffer,o-4),Bn(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/8;a++)sr.writeUint32BE(this._stateHi[a],e,a*8),sr.writeUint32BE(this._stateLo[a],e,a*8+4);return this},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(e){ir.wipe(e.stateHi),ir.wipe(e.stateLo),e.buffer&&ir.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},i}();et.SHA512=du;var fu=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function Bn(i,e,r,t,s,n,o){for(var a=r[0],c=r[1],u=r[2],h=r[3],l=r[4],m=r[5],p=r[6],f=r[7],y=t[0],b=t[1],_=t[2],S=t[3],E=t[4],w=t[5],D=t[6],T=t[7],d,g,R,A,I,v,x,O;o>=128;){for(var L=0;L<16;L++){var U=8*L+n;i[L]=sr.readUint32BE(s,U),e[L]=sr.readUint32BE(s,U+4)}for(var L=0;L<80;L++){var N=a,$=c,re=u,j=h,F=l,k=m,B=p,q=f,K=y,V=b,z=_,J=S,Y=E,X=w,Q=D,Z=T;if(d=f,g=T,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=(l>>>14|E<<32-14)^(l>>>18|E<<32-18)^(E>>>41-32|l<<32-(41-32)),g=(E>>>14|l<<32-14)^(E>>>18|l<<32-18)^(l>>>41-32|E<<32-(41-32)),I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,d=l&m^~l&p,g=E&w^~E&D,I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,d=fu[L*2],g=fu[L*2+1],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,d=i[L%16],g=e[L%16],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,R=x&65535|O<<16,A=I&65535|v<<16,d=R,g=A,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=(a>>>28|y<<32-28)^(y>>>34-32|a<<32-(34-32))^(y>>>39-32|a<<32-(39-32)),g=(y>>>28|a<<32-28)^(a>>>34-32|y<<32-(34-32))^(a>>>39-32|y<<32-(39-32)),I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,d=a&c^a&u^c&u,g=y&b^y&_^b&_,I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,q=x&65535|O<<16,Z=I&65535|v<<16,d=j,g=J,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=R,g=A,I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,j=x&65535|O<<16,J=I&65535|v<<16,c=N,u=$,h=re,l=j,m=F,p=k,f=B,a=q,b=K,_=V,S=z,E=J,w=Y,D=X,T=Q,y=Z,L%16===15)for(var U=0;U<16;U++)d=i[U],g=e[U],I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=i[(U+9)%16],g=e[(U+9)%16],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,R=i[(U+1)%16],A=e[(U+1)%16],d=(R>>>1|A<<32-1)^(R>>>8|A<<32-8)^R>>>7,g=(A>>>1|R<<32-1)^(A>>>8|R<<32-8)^(A>>>7|R<<32-7),I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,R=i[(U+14)%16],A=e[(U+14)%16],d=(R>>>19|A<<32-19)^(A>>>61-32|R<<32-(61-32))^R>>>6,g=(A>>>19|R<<32-19)^(R>>>61-32|A<<32-(61-32))^(A>>>6|R<<32-6),I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,i[U]=x&65535|O<<16,e[U]=I&65535|v<<16}d=a,g=y,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[0],g=t[0],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[0]=a=x&65535|O<<16,t[0]=y=I&65535|v<<16,d=c,g=b,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[1],g=t[1],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[1]=c=x&65535|O<<16,t[1]=b=I&65535|v<<16,d=u,g=_,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[2],g=t[2],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[2]=u=x&65535|O<<16,t[2]=_=I&65535|v<<16,d=h,g=S,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[3],g=t[3],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[3]=h=x&65535|O<<16,t[3]=S=I&65535|v<<16,d=l,g=E,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[4],g=t[4],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[4]=l=x&65535|O<<16,t[4]=E=I&65535|v<<16,d=m,g=w,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[5],g=t[5],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[5]=m=x&65535|O<<16,t[5]=w=I&65535|v<<16,d=p,g=D,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[6],g=t[6],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[6]=p=x&65535|O<<16,t[6]=D=I&65535|v<<16,d=f,g=T,I=g&65535,v=g>>>16,x=d&65535,O=d>>>16,d=r[7],g=t[7],I+=g&65535,v+=g>>>16,x+=d&65535,O+=d>>>16,v+=I>>>16,x+=v>>>16,O+=x>>>16,r[7]=f=x&65535|O<<16,t[7]=T=I&65535|v<<16,n+=128,o-=128}return n}function Mg(i){var e=new du;e.update(i);var r=e.digest();return e.clean(),r}et.hash=Mg});var Tu=M(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.convertSecretKeyToX25519=ne.convertPublicKeyToX25519=ne.verify=ne.sign=ne.extractPublicKeyFromSecretKey=ne.generateKeyPair=ne.generateKeyPairFromSeed=ne.SEED_LENGTH=ne.SECRET_KEY_LENGTH=ne.PUBLIC_KEY_LENGTH=ne.SIGNATURE_LENGTH=void 0;var qg=Kr(),Vr=pu(),wu=Be();ne.SIGNATURE_LENGTH=64;ne.PUBLIC_KEY_LENGTH=32;ne.SECRET_KEY_LENGTH=64;ne.SEED_LENGTH=32;function H(i){let e=new Float64Array(16);if(i)for(let r=0;r<i.length;r++)e[r]=i[r];return e}var jg=new Uint8Array(32);jg[0]=9;var Vn=H(),nr=H([1]),kg=H([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Bg=H([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),gu=H([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),mu=H([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Hg=H([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ht(i,e){for(let r=0;r<16;r++)i[r]=e[r]|0}function Hn(i){let e=1;for(let r=0;r<16;r++){let t=i[r]+e+65535;e=Math.floor(t/65536),i[r]=t-e*65536}i[0]+=e-1+37*(e-1)}function _u(i,e,r){let t=~(r-1);for(let s=0;s<16;s++){let n=t&(i[s]^e[s]);i[s]^=n,e[s]^=n}}function zr(i,e){let r=H(),t=H();for(let s=0;s<16;s++)t[s]=e[s];Hn(t),Hn(t),Hn(t);for(let s=0;s<2;s++){r[0]=t[0]-65517;for(let o=1;o<15;o++)r[o]=t[o]-65535-(r[o-1]>>16&1),r[o-1]&=65535;r[15]=t[15]-32767-(r[14]>>16&1);let n=r[15]>>16&1;r[14]&=65535,_u(t,r,1-n)}for(let s=0;s<16;s++)i[2*s]=t[s]&255,i[2*s+1]=t[s]>>8}function Eu(i,e){let r=0;for(let t=0;t<32;t++)r|=i[t]^e[t];return(1&r-1>>>8)-1}function yu(i,e){let r=new Uint8Array(32),t=new Uint8Array(32);return zr(r,i),zr(t,e),Eu(r,t)}function vu(i){let e=new Uint8Array(32);return zr(e,i),e[0]&1}function Kg(i,e){for(let r=0;r<16;r++)i[r]=e[2*r]+(e[2*r+1]<<8);i[15]&=32767}function Ot(i,e,r){for(let t=0;t<16;t++)i[t]=e[t]+r[t]}function Rt(i,e,r){for(let t=0;t<16;t++)i[t]=e[t]-r[t]}function ae(i,e,r){let t,s,n=0,o=0,a=0,c=0,u=0,h=0,l=0,m=0,p=0,f=0,y=0,b=0,_=0,S=0,E=0,w=0,D=0,T=0,d=0,g=0,R=0,A=0,I=0,v=0,x=0,O=0,L=0,U=0,N=0,$=0,re=0,j=r[0],F=r[1],k=r[2],B=r[3],q=r[4],K=r[5],V=r[6],z=r[7],J=r[8],Y=r[9],X=r[10],Q=r[11],Z=r[12],te=r[13],ie=r[14],se=r[15];t=e[0],n+=t*j,o+=t*F,a+=t*k,c+=t*B,u+=t*q,h+=t*K,l+=t*V,m+=t*z,p+=t*J,f+=t*Y,y+=t*X,b+=t*Q,_+=t*Z,S+=t*te,E+=t*ie,w+=t*se,t=e[1],o+=t*j,a+=t*F,c+=t*k,u+=t*B,h+=t*q,l+=t*K,m+=t*V,p+=t*z,f+=t*J,y+=t*Y,b+=t*X,_+=t*Q,S+=t*Z,E+=t*te,w+=t*ie,D+=t*se,t=e[2],a+=t*j,c+=t*F,u+=t*k,h+=t*B,l+=t*q,m+=t*K,p+=t*V,f+=t*z,y+=t*J,b+=t*Y,_+=t*X,S+=t*Q,E+=t*Z,w+=t*te,D+=t*ie,T+=t*se,t=e[3],c+=t*j,u+=t*F,h+=t*k,l+=t*B,m+=t*q,p+=t*K,f+=t*V,y+=t*z,b+=t*J,_+=t*Y,S+=t*X,E+=t*Q,w+=t*Z,D+=t*te,T+=t*ie,d+=t*se,t=e[4],u+=t*j,h+=t*F,l+=t*k,m+=t*B,p+=t*q,f+=t*K,y+=t*V,b+=t*z,_+=t*J,S+=t*Y,E+=t*X,w+=t*Q,D+=t*Z,T+=t*te,d+=t*ie,g+=t*se,t=e[5],h+=t*j,l+=t*F,m+=t*k,p+=t*B,f+=t*q,y+=t*K,b+=t*V,_+=t*z,S+=t*J,E+=t*Y,w+=t*X,D+=t*Q,T+=t*Z,d+=t*te,g+=t*ie,R+=t*se,t=e[6],l+=t*j,m+=t*F,p+=t*k,f+=t*B,y+=t*q,b+=t*K,_+=t*V,S+=t*z,E+=t*J,w+=t*Y,D+=t*X,T+=t*Q,d+=t*Z,g+=t*te,R+=t*ie,A+=t*se,t=e[7],m+=t*j,p+=t*F,f+=t*k,y+=t*B,b+=t*q,_+=t*K,S+=t*V,E+=t*z,w+=t*J,D+=t*Y,T+=t*X,d+=t*Q,g+=t*Z,R+=t*te,A+=t*ie,I+=t*se,t=e[8],p+=t*j,f+=t*F,y+=t*k,b+=t*B,_+=t*q,S+=t*K,E+=t*V,w+=t*z,D+=t*J,T+=t*Y,d+=t*X,g+=t*Q,R+=t*Z,A+=t*te,I+=t*ie,v+=t*se,t=e[9],f+=t*j,y+=t*F,b+=t*k,_+=t*B,S+=t*q,E+=t*K,w+=t*V,D+=t*z,T+=t*J,d+=t*Y,g+=t*X,R+=t*Q,A+=t*Z,I+=t*te,v+=t*ie,x+=t*se,t=e[10],y+=t*j,b+=t*F,_+=t*k,S+=t*B,E+=t*q,w+=t*K,D+=t*V,T+=t*z,d+=t*J,g+=t*Y,R+=t*X,A+=t*Q,I+=t*Z,v+=t*te,x+=t*ie,O+=t*se,t=e[11],b+=t*j,_+=t*F,S+=t*k,E+=t*B,w+=t*q,D+=t*K,T+=t*V,d+=t*z,g+=t*J,R+=t*Y,A+=t*X,I+=t*Q,v+=t*Z,x+=t*te,O+=t*ie,L+=t*se,t=e[12],_+=t*j,S+=t*F,E+=t*k,w+=t*B,D+=t*q,T+=t*K,d+=t*V,g+=t*z,R+=t*J,A+=t*Y,I+=t*X,v+=t*Q,x+=t*Z,O+=t*te,L+=t*ie,U+=t*se,t=e[13],S+=t*j,E+=t*F,w+=t*k,D+=t*B,T+=t*q,d+=t*K,g+=t*V,R+=t*z,A+=t*J,I+=t*Y,v+=t*X,x+=t*Q,O+=t*Z,L+=t*te,U+=t*ie,N+=t*se,t=e[14],E+=t*j,w+=t*F,D+=t*k,T+=t*B,d+=t*q,g+=t*K,R+=t*V,A+=t*z,I+=t*J,v+=t*Y,x+=t*X,O+=t*Q,L+=t*Z,U+=t*te,N+=t*ie,$+=t*se,t=e[15],w+=t*j,D+=t*F,T+=t*k,d+=t*B,g+=t*q,R+=t*K,A+=t*V,I+=t*z,v+=t*J,x+=t*Y,O+=t*X,L+=t*Q,U+=t*Z,N+=t*te,$+=t*ie,re+=t*se,n+=38*D,o+=38*T,a+=38*d,c+=38*g,u+=38*R,h+=38*A,l+=38*I,m+=38*v,p+=38*x,f+=38*O,y+=38*L,b+=38*U,_+=38*N,S+=38*$,E+=38*re,s=1,t=n+s+65535,s=Math.floor(t/65536),n=t-s*65536,t=o+s+65535,s=Math.floor(t/65536),o=t-s*65536,t=a+s+65535,s=Math.floor(t/65536),a=t-s*65536,t=c+s+65535,s=Math.floor(t/65536),c=t-s*65536,t=u+s+65535,s=Math.floor(t/65536),u=t-s*65536,t=h+s+65535,s=Math.floor(t/65536),h=t-s*65536,t=l+s+65535,s=Math.floor(t/65536),l=t-s*65536,t=m+s+65535,s=Math.floor(t/65536),m=t-s*65536,t=p+s+65535,s=Math.floor(t/65536),p=t-s*65536,t=f+s+65535,s=Math.floor(t/65536),f=t-s*65536,t=y+s+65535,s=Math.floor(t/65536),y=t-s*65536,t=b+s+65535,s=Math.floor(t/65536),b=t-s*65536,t=_+s+65535,s=Math.floor(t/65536),_=t-s*65536,t=S+s+65535,s=Math.floor(t/65536),S=t-s*65536,t=E+s+65535,s=Math.floor(t/65536),E=t-s*65536,t=w+s+65535,s=Math.floor(t/65536),w=t-s*65536,n+=s-1+37*(s-1),s=1,t=n+s+65535,s=Math.floor(t/65536),n=t-s*65536,t=o+s+65535,s=Math.floor(t/65536),o=t-s*65536,t=a+s+65535,s=Math.floor(t/65536),a=t-s*65536,t=c+s+65535,s=Math.floor(t/65536),c=t-s*65536,t=u+s+65535,s=Math.floor(t/65536),u=t-s*65536,t=h+s+65535,s=Math.floor(t/65536),h=t-s*65536,t=l+s+65535,s=Math.floor(t/65536),l=t-s*65536,t=m+s+65535,s=Math.floor(t/65536),m=t-s*65536,t=p+s+65535,s=Math.floor(t/65536),p=t-s*65536,t=f+s+65535,s=Math.floor(t/65536),f=t-s*65536,t=y+s+65535,s=Math.floor(t/65536),y=t-s*65536,t=b+s+65535,s=Math.floor(t/65536),b=t-s*65536,t=_+s+65535,s=Math.floor(t/65536),_=t-s*65536,t=S+s+65535,s=Math.floor(t/65536),S=t-s*65536,t=E+s+65535,s=Math.floor(t/65536),E=t-s*65536,t=w+s+65535,s=Math.floor(t/65536),w=t-s*65536,n+=s-1+37*(s-1),i[0]=n,i[1]=o,i[2]=a,i[3]=c,i[4]=u,i[5]=h,i[6]=l,i[7]=m,i[8]=p,i[9]=f,i[10]=y,i[11]=b,i[12]=_,i[13]=S,i[14]=E,i[15]=w}function Tt(i,e){ae(i,e,e)}function xu(i,e){let r=H(),t;for(t=0;t<16;t++)r[t]=e[t];for(t=253;t>=0;t--)Tt(r,r),t!==2&&t!==4&&ae(r,r,e);for(t=0;t<16;t++)i[t]=r[t]}function Vg(i,e){let r=H(),t;for(t=0;t<16;t++)r[t]=e[t];for(t=250;t>=0;t--)Tt(r,r),t!==1&&ae(r,r,e);for(t=0;t<16;t++)i[t]=r[t]}function zn(i,e){let r=H(),t=H(),s=H(),n=H(),o=H(),a=H(),c=H(),u=H(),h=H();Rt(r,i[1],i[0]),Rt(h,e[1],e[0]),ae(r,r,h),Ot(t,i[0],i[1]),Ot(h,e[0],e[1]),ae(t,t,h),ae(s,i[3],e[3]),ae(s,s,Bg),ae(n,i[2],e[2]),Ot(n,n,n),Rt(o,t,r),Rt(a,n,s),Ot(c,n,s),Ot(u,t,r),ae(i[0],o,a),ae(i[1],u,c),ae(i[2],c,a),ae(i[3],o,u)}function bu(i,e,r){for(let t=0;t<4;t++)_u(i[t],e[t],r)}function Gn(i,e){let r=H(),t=H(),s=H();xu(s,e[2]),ae(r,e[0],s),ae(t,e[1],s),zr(i,t),i[31]^=vu(r)<<7}function Su(i,e,r){ht(i[0],Vn),ht(i[1],nr),ht(i[2],nr),ht(i[3],Vn);for(let t=255;t>=0;--t){let s=r[t/8|0]>>(t&7)&1;bu(i,e,s),zn(e,i),zn(i,i),bu(i,e,s)}}function Wn(i,e){let r=[H(),H(),H(),H()];ht(r[0],gu),ht(r[1],mu),ht(r[2],nr),ae(r[3],gu,mu),Su(i,r,e)}function Du(i){if(i.length!==ne.SEED_LENGTH)throw new Error(`ed25519: seed must be ${ne.SEED_LENGTH} bytes`);let e=(0,Vr.hash)(i);e[0]&=248,e[31]&=127,e[31]|=64;let r=new Uint8Array(32),t=[H(),H(),H(),H()];Wn(t,e),Gn(r,t);let s=new Uint8Array(64);return s.set(i),s.set(r,32),{publicKey:r,secretKey:s}}ne.generateKeyPairFromSeed=Du;function zg(i){let e=(0,qg.randomBytes)(32,i),r=Du(e);return(0,wu.wipe)(e),r}ne.generateKeyPair=zg;function $g(i){if(i.length!==ne.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${ne.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(i.subarray(32))}ne.extractPublicKeyFromSecretKey=$g;var Kn=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Iu(i,e){let r,t,s,n;for(t=63;t>=32;--t){for(r=0,s=t-32,n=t-12;s<n;++s)e[s]+=r-16*e[t]*Kn[s-(t-32)],r=Math.floor((e[s]+128)/256),e[s]-=r*256;e[s]+=r,e[t]=0}for(r=0,s=0;s<32;s++)e[s]+=r-(e[31]>>4)*Kn[s],r=e[s]>>8,e[s]&=255;for(s=0;s<32;s++)e[s]-=r*Kn[s];for(t=0;t<32;t++)e[t+1]+=e[t]>>8,i[t]=e[t]&255}function $n(i){let e=new Float64Array(64);for(let r=0;r<64;r++)e[r]=i[r];for(let r=0;r<64;r++)i[r]=0;Iu(i,e)}function Gg(i,e){let r=new Float64Array(64),t=[H(),H(),H(),H()],s=(0,Vr.hash)(i.subarray(0,32));s[0]&=248,s[31]&=127,s[31]|=64;let n=new Uint8Array(64);n.set(s.subarray(32),32);let o=new Vr.SHA512;o.update(n.subarray(32)),o.update(e);let a=o.digest();o.clean(),$n(a),Wn(t,a),Gn(n,t),o.reset(),o.update(n.subarray(0,32)),o.update(i.subarray(32)),o.update(e);let c=o.digest();$n(c);for(let u=0;u<32;u++)r[u]=a[u];for(let u=0;u<32;u++)for(let h=0;h<32;h++)r[u+h]+=c[u]*s[h];return Iu(n.subarray(32),r),n}ne.sign=Gg;function Ou(i,e){let r=H(),t=H(),s=H(),n=H(),o=H(),a=H(),c=H();return ht(i[2],nr),Kg(i[1],e),Tt(s,i[1]),ae(n,s,kg),Rt(s,s,i[2]),Ot(n,i[2],n),Tt(o,n),Tt(a,o),ae(c,a,o),ae(r,c,s),ae(r,r,n),Vg(r,r),ae(r,r,s),ae(r,r,n),ae(r,r,n),ae(i[0],r,n),Tt(t,i[0]),ae(t,t,n),yu(t,s)&&ae(i[0],i[0],Hg),Tt(t,i[0]),ae(t,t,n),yu(t,s)?-1:(vu(i[0])===e[31]>>7&&Rt(i[0],Vn,i[0]),ae(i[3],i[0],i[1]),0)}function Wg(i,e,r){let t=new Uint8Array(32),s=[H(),H(),H(),H()],n=[H(),H(),H(),H()];if(r.length!==ne.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${ne.SIGNATURE_LENGTH} bytes`);if(Ou(n,i))return!1;let o=new Vr.SHA512;o.update(r.subarray(0,32)),o.update(i),o.update(e);let a=o.digest();return $n(a),Su(s,n,a),Wn(n,r.subarray(32)),zn(s,n),Gn(t,s),!Eu(r,t)}ne.verify=Wg;function Jg(i){let e=[H(),H(),H(),H()];if(Ou(e,i))throw new Error("Ed25519: invalid public key");let r=H(),t=H(),s=e[1];Ot(r,nr,s),Rt(t,nr,s),xu(t,t),ae(r,r,t);let n=new Uint8Array(32);return zr(n,r),n}ne.convertPublicKeyToX25519=Jg;function Yg(i){let e=(0,Vr.hash)(i.subarray(0,32));e[0]&=248,e[31]&=127,e[31]|=64;let r=new Uint8Array(e.subarray(0,32));return(0,wu.wipe)(e),r}ne.convertSecretKeyToX25519=Yg});var ll=M(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});var Oe=rr(),Eo=Be(),ly=20;function hy(i,e,r){for(var t=1634760805,s=857760878,n=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],u=r[11]<<24|r[10]<<16|r[9]<<8|r[8],h=r[15]<<24|r[14]<<16|r[13]<<8|r[12],l=r[19]<<24|r[18]<<16|r[17]<<8|r[16],m=r[23]<<24|r[22]<<16|r[21]<<8|r[20],p=r[27]<<24|r[26]<<16|r[25]<<8|r[24],f=r[31]<<24|r[30]<<16|r[29]<<8|r[28],y=e[3]<<24|e[2]<<16|e[1]<<8|e[0],b=e[7]<<24|e[6]<<16|e[5]<<8|e[4],_=e[11]<<24|e[10]<<16|e[9]<<8|e[8],S=e[15]<<24|e[14]<<16|e[13]<<8|e[12],E=t,w=s,D=n,T=o,d=a,g=c,R=u,A=h,I=l,v=m,x=p,O=f,L=y,U=b,N=_,$=S,re=0;re<ly;re+=2)E=E+d|0,L^=E,L=L>>>32-16|L<<16,I=I+L|0,d^=I,d=d>>>32-12|d<<12,w=w+g|0,U^=w,U=U>>>32-16|U<<16,v=v+U|0,g^=v,g=g>>>32-12|g<<12,D=D+R|0,N^=D,N=N>>>32-16|N<<16,x=x+N|0,R^=x,R=R>>>32-12|R<<12,T=T+A|0,$^=T,$=$>>>32-16|$<<16,O=O+$|0,A^=O,A=A>>>32-12|A<<12,D=D+R|0,N^=D,N=N>>>32-8|N<<8,x=x+N|0,R^=x,R=R>>>32-7|R<<7,T=T+A|0,$^=T,$=$>>>32-8|$<<8,O=O+$|0,A^=O,A=A>>>32-7|A<<7,w=w+g|0,U^=w,U=U>>>32-8|U<<8,v=v+U|0,g^=v,g=g>>>32-7|g<<7,E=E+d|0,L^=E,L=L>>>32-8|L<<8,I=I+L|0,d^=I,d=d>>>32-7|d<<7,E=E+g|0,$^=E,$=$>>>32-16|$<<16,x=x+$|0,g^=x,g=g>>>32-12|g<<12,w=w+R|0,L^=w,L=L>>>32-16|L<<16,O=O+L|0,R^=O,R=R>>>32-12|R<<12,D=D+A|0,U^=D,U=U>>>32-16|U<<16,I=I+U|0,A^=I,A=A>>>32-12|A<<12,T=T+d|0,N^=T,N=N>>>32-16|N<<16,v=v+N|0,d^=v,d=d>>>32-12|d<<12,D=D+A|0,U^=D,U=U>>>32-8|U<<8,I=I+U|0,A^=I,A=A>>>32-7|A<<7,T=T+d|0,N^=T,N=N>>>32-8|N<<8,v=v+N|0,d^=v,d=d>>>32-7|d<<7,w=w+R|0,L^=w,L=L>>>32-8|L<<8,O=O+L|0,R^=O,R=R>>>32-7|R<<7,E=E+g|0,$^=E,$=$>>>32-8|$<<8,x=x+$|0,g^=x,g=g>>>32-7|g<<7;Oe.writeUint32LE(E+t|0,i,0),Oe.writeUint32LE(w+s|0,i,4),Oe.writeUint32LE(D+n|0,i,8),Oe.writeUint32LE(T+o|0,i,12),Oe.writeUint32LE(d+a|0,i,16),Oe.writeUint32LE(g+c|0,i,20),Oe.writeUint32LE(R+u|0,i,24),Oe.writeUint32LE(A+h|0,i,28),Oe.writeUint32LE(I+l|0,i,32),Oe.writeUint32LE(v+m|0,i,36),Oe.writeUint32LE(x+p|0,i,40),Oe.writeUint32LE(O+f|0,i,44),Oe.writeUint32LE(L+y|0,i,48),Oe.writeUint32LE(U+b|0,i,52),Oe.writeUint32LE(N+_|0,i,56),Oe.writeUint32LE($+S|0,i,60)}function ul(i,e,r,t,s){if(s===void 0&&(s=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(t.length<r.length)throw new Error("ChaCha: destination is shorter than source");var n,o;if(s===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");n=new Uint8Array(16),o=n.length-e.length,n.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");n=e,o=s}for(var a=new Uint8Array(64),c=0;c<r.length;c+=64){hy(a,n,i);for(var u=c;u<c+64&&u<r.length;u++)t[u]=r[u]^a[u-c];dy(n,0,o)}return Eo.wipe(a),s===0&&Eo.wipe(n),t}ps.streamXOR=ul;function fy(i,e,r,t){return t===void 0&&(t=0),Eo.wipe(r),ul(i,e,r,r,t)}ps.stream=fy;function dy(i,e,r){for(var t=1;r--;)t=t+(i[e]&255)|0,i[e]=t&255,t>>>=8,e++;if(t>0)throw new Error("ChaCha: counter overflow")}});var gs=M(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});function py(i,e,r){return~(i-1)&e|i-1&r}fr.select=py;function gy(i,e){return(i|0)-(e|0)-1>>>31&1}fr.lessOrEqual=gy;function hl(i,e){if(i.length!==e.length)return 0;for(var r=0,t=0;t<i.length;t++)r|=i[t]^e[t];return 1&r-1>>>8}fr.compare=hl;function my(i,e){return i.length===0||e.length===0?!1:hl(i,e)!==0}fr.equal=my});var dl=M(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});var yy=gs(),ms=Be();rt.DIGEST_LENGTH=16;var fl=function(){function i(e){this.digestLength=rt.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var t=e[2]|e[3]<<8;this._r[1]=(r>>>13|t<<3)&8191;var s=e[4]|e[5]<<8;this._r[2]=(t>>>10|s<<6)&7939;var n=e[6]|e[7]<<8;this._r[3]=(s>>>7|n<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(n>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return i.prototype._blocks=function(e,r,t){for(var s=this._fin?0:2048,n=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],h=this._h[5],l=this._h[6],m=this._h[7],p=this._h[8],f=this._h[9],y=this._r[0],b=this._r[1],_=this._r[2],S=this._r[3],E=this._r[4],w=this._r[5],D=this._r[6],T=this._r[7],d=this._r[8],g=this._r[9];t>=16;){var R=e[r+0]|e[r+1]<<8;n+=R&8191;var A=e[r+2]|e[r+3]<<8;o+=(R>>>13|A<<3)&8191;var I=e[r+4]|e[r+5]<<8;a+=(A>>>10|I<<6)&8191;var v=e[r+6]|e[r+7]<<8;c+=(I>>>7|v<<9)&8191;var x=e[r+8]|e[r+9]<<8;u+=(v>>>4|x<<12)&8191,h+=x>>>1&8191;var O=e[r+10]|e[r+11]<<8;l+=(x>>>14|O<<2)&8191;var L=e[r+12]|e[r+13]<<8;m+=(O>>>11|L<<5)&8191;var U=e[r+14]|e[r+15]<<8;p+=(L>>>8|U<<8)&8191,f+=U>>>5|s;var N=0,$=N;$+=n*y,$+=o*(5*g),$+=a*(5*d),$+=c*(5*T),$+=u*(5*D),N=$>>>13,$&=8191,$+=h*(5*w),$+=l*(5*E),$+=m*(5*S),$+=p*(5*_),$+=f*(5*b),N+=$>>>13,$&=8191;var re=N;re+=n*b,re+=o*y,re+=a*(5*g),re+=c*(5*d),re+=u*(5*T),N=re>>>13,re&=8191,re+=h*(5*D),re+=l*(5*w),re+=m*(5*E),re+=p*(5*S),re+=f*(5*_),N+=re>>>13,re&=8191;var j=N;j+=n*_,j+=o*b,j+=a*y,j+=c*(5*g),j+=u*(5*d),N=j>>>13,j&=8191,j+=h*(5*T),j+=l*(5*D),j+=m*(5*w),j+=p*(5*E),j+=f*(5*S),N+=j>>>13,j&=8191;var F=N;F+=n*S,F+=o*_,F+=a*b,F+=c*y,F+=u*(5*g),N=F>>>13,F&=8191,F+=h*(5*d),F+=l*(5*T),F+=m*(5*D),F+=p*(5*w),F+=f*(5*E),N+=F>>>13,F&=8191;var k=N;k+=n*E,k+=o*S,k+=a*_,k+=c*b,k+=u*y,N=k>>>13,k&=8191,k+=h*(5*g),k+=l*(5*d),k+=m*(5*T),k+=p*(5*D),k+=f*(5*w),N+=k>>>13,k&=8191;var B=N;B+=n*w,B+=o*E,B+=a*S,B+=c*_,B+=u*b,N=B>>>13,B&=8191,B+=h*y,B+=l*(5*g),B+=m*(5*d),B+=p*(5*T),B+=f*(5*D),N+=B>>>13,B&=8191;var q=N;q+=n*D,q+=o*w,q+=a*E,q+=c*S,q+=u*_,N=q>>>13,q&=8191,q+=h*b,q+=l*y,q+=m*(5*g),q+=p*(5*d),q+=f*(5*T),N+=q>>>13,q&=8191;var K=N;K+=n*T,K+=o*D,K+=a*w,K+=c*E,K+=u*S,N=K>>>13,K&=8191,K+=h*_,K+=l*b,K+=m*y,K+=p*(5*g),K+=f*(5*d),N+=K>>>13,K&=8191;var V=N;V+=n*d,V+=o*T,V+=a*D,V+=c*w,V+=u*E,N=V>>>13,V&=8191,V+=h*S,V+=l*_,V+=m*b,V+=p*y,V+=f*(5*g),N+=V>>>13,V&=8191;var z=N;z+=n*g,z+=o*d,z+=a*T,z+=c*D,z+=u*w,N=z>>>13,z&=8191,z+=h*E,z+=l*S,z+=m*_,z+=p*b,z+=f*y,N+=z>>>13,z&=8191,N=(N<<2)+N|0,N=N+$|0,$=N&8191,N=N>>>13,re+=N,n=$,o=re,a=j,c=F,u=k,h=B,l=q,m=K,p=V,f=z,r+=16,t-=16}this._h[0]=n,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=h,this._h[6]=l,this._h[7]=m,this._h[8]=p,this._h[9]=f},i.prototype.finish=function(e,r){r===void 0&&(r=0);var t=new Uint16Array(10),s,n,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(s=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=s,s=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=s*5,s=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=s,s=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=s,t[0]=this._h[0]+5,s=t[0]>>>13,t[0]&=8191,a=1;a<10;a++)t[a]=this._h[a]+s,s=t[a]>>>13,t[a]&=8191;for(t[9]-=1<<13,n=(s^1)-1,a=0;a<10;a++)t[a]&=n;for(n=~n,a=0;a<10;a++)this._h[a]=this._h[a]&n|t[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},i.prototype.update=function(e){var r=0,t=e.length,s;if(this._leftover){s=16-this._leftover,s>t&&(s=t);for(var n=0;n<s;n++)this._buffer[this._leftover+n]=e[r+n];if(t-=s,r+=s,this._leftover+=s,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(t>=16&&(s=t-t%16,this._blocks(e,r,s),r+=s,t-=s),t){for(var n=0;n<t;n++)this._buffer[this._leftover+n]=e[r+n];this._leftover+=t}return this},i.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},i.prototype.clean=function(){return ms.wipe(this._buffer),ms.wipe(this._r),ms.wipe(this._h),ms.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},i}();rt.Poly1305=fl;function by(i,e){var r=new fl(i);r.update(e);var t=r.digest();return r.clean(),t}rt.oneTimeAuth=by;function wy(i,e){return i.length!==rt.DIGEST_LENGTH||e.length!==rt.DIGEST_LENGTH?!1:yy.equal(i,e)}rt.equal=wy});var ml=M(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});var ys=ll(),_y=dl(),Qr=Be(),pl=rr(),Ey=gs();it.KEY_LENGTH=32;it.NONCE_LENGTH=12;it.TAG_LENGTH=16;var gl=new Uint8Array(16),vy=function(){function i(e){if(this.nonceLength=it.NONCE_LENGTH,this.tagLength=it.TAG_LENGTH,e.length!==it.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return i.prototype.seal=function(e,r,t,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var n=new Uint8Array(16);n.set(e,n.length-e.length);var o=new Uint8Array(32);ys.stream(this._key,n,o,4);var a=r.length+this.tagLength,c;if(s){if(s.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=s}else c=new Uint8Array(a);return ys.streamXOR(this._key,n,r,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),t),Qr.wipe(n),c},i.prototype.open=function(e,r,t,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var n=new Uint8Array(16);n.set(e,n.length-e.length);var o=new Uint8Array(32);ys.stream(this._key,n,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,r.subarray(0,r.length-this.tagLength),t),!Ey.equal(a,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,u;if(s){if(s.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=s}else u=new Uint8Array(c);return ys.streamXOR(this._key,n,r.subarray(0,r.length-this.tagLength),u,4),Qr.wipe(n),u},i.prototype.clean=function(){return Qr.wipe(this._key),this},i.prototype._authenticate=function(e,r,t,s){var n=new _y.Poly1305(r);s&&(n.update(s),s.length%16>0&&n.update(gl.subarray(s.length%16))),n.update(t),t.length%16>0&&n.update(gl.subarray(t.length%16));var o=new Uint8Array(8);s&&pl.writeUint64LE(s.length,o),n.update(o),pl.writeUint64LE(t.length,o),n.update(o);for(var a=n.digest(),c=0;c<a.length;c++)e[c]=a[c];n.clean(),Qr.wipe(a),Qr.wipe(o)},i}();it.ChaCha20Poly1305=vy});var yl=M(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});function xy(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}vo.isSerializableHash=xy});var wl=M(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});var We=yl(),Sy=gs(),Dy=Be(),bl=function(){function i(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var t=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(t).clean():t.set(r);for(var s=0;s<t.length;s++)t[s]^=54;this._inner.update(t);for(var s=0;s<t.length;s++)t[s]^=106;this._outer.update(t),We.isSerializableHash(this._inner)&&We.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Dy.wipe(t)}return i.prototype.reset=function(){if(!We.isSerializableHash(this._inner)||!We.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){We.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),We.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!We.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!We.isSerializableHash(this._inner)||!We.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!We.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Zr.HMAC=bl;function Iy(i,e,r){var t=new bl(i,e);t.update(r);var s=t.digest();return t.clean(),s}Zr.hmac=Iy;Zr.equal=Sy.equal});var vl=M(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});var _l=wl(),El=Be(),Oy=function(){function i(e,r,t,s){t===void 0&&(t=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=s;var n=_l.hmac(this._hash,t,r);this._hmac=new _l.HMAC(e,n),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var r=new Uint8Array(e),t=0;t<r.length;t++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[t]=this._buffer[this._bufpos++];return r},i.prototype.clean=function(){this._hmac.clean(),El.wipe(this._buffer),El.wipe(this._counter),this._bufpos=0},i}();xo.HKDF=Oy});var Sl=M(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});var ws=rr(),bs=Be();dt.DIGEST_LENGTH=32;dt.BLOCK_SIZE=64;var xl=function(){function i(){this.digestLength=dt.DIGEST_LENGTH,this.blockSize=dt.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){bs.wipe(this._buffer),bs.wipe(this._temp),this.reset()},i.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var t=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=e[t++],r--;this._bufferLength===this.blockSize&&(So(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(t=So(this._temp,this._state,e,t,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[t++],r--;return this},i.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,t=this._bufferLength,s=r/536870912|0,n=r<<3,o=r%64<56?64:128;this._buffer[t]=128;for(var a=t+1;a<o-8;a++)this._buffer[a]=0;ws.writeUint32BE(s,this._buffer,o-8),ws.writeUint32BE(n,this._buffer,o-4),So(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)ws.writeUint32BE(this._state[a],e,a*4);return this},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(e){bs.wipe(e.state),e.buffer&&bs.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},i}();dt.SHA256=xl;var Ty=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function So(i,e,r,t,s){for(;s>=64;){for(var n=e[0],o=e[1],a=e[2],c=e[3],u=e[4],h=e[5],l=e[6],m=e[7],p=0;p<16;p++){var f=t+p*4;i[p]=ws.readUint32BE(r,f)}for(var p=16;p<64;p++){var y=i[p-2],b=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=i[p-15];var _=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;i[p]=(b+i[p-7]|0)+(_+i[p-16]|0)}for(var p=0;p<64;p++){var b=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&h^~u&l)|0)+(m+(Ty[p]+i[p]|0)|0)|0,_=((n>>>2|n<<32-2)^(n>>>13|n<<32-13)^(n>>>22|n<<32-22))+(n&o^n&a^o&a)|0;m=l,l=h,h=u,u=c+b|0,c=a,a=o,o=n,n=b+_|0}e[0]+=n,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=h,e[6]+=l,e[7]+=m,t+=64,s-=64}return t}function Ry(i){var e=new xl;e.update(i);var r=e.digest();return e.clean(),r}dt.hash=Ry});var Tl=M(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.sharedKey=pe.generateKeyPair=pe.generateKeyPairFromSeed=pe.scalarMultBase=pe.scalarMult=pe.SHARED_KEY_LENGTH=pe.SECRET_KEY_LENGTH=pe.PUBLIC_KEY_LENGTH=void 0;var Ay=Kr(),Ny=Be();pe.PUBLIC_KEY_LENGTH=32;pe.SECRET_KEY_LENGTH=32;pe.SHARED_KEY_LENGTH=32;function Je(i){let e=new Float64Array(16);if(i)for(let r=0;r<i.length;r++)e[r]=i[r];return e}var Dl=new Uint8Array(32);Dl[0]=9;var Cy=Je([56129,1]);function Do(i){let e=1;for(let r=0;r<16;r++){let t=i[r]+e+65535;e=Math.floor(t/65536),i[r]=t-e*65536}i[0]+=e-1+37*(e-1)}function ei(i,e,r){let t=~(r-1);for(let s=0;s<16;s++){let n=t&(i[s]^e[s]);i[s]^=n,e[s]^=n}}function Py(i,e){let r=Je(),t=Je();for(let s=0;s<16;s++)t[s]=e[s];Do(t),Do(t),Do(t);for(let s=0;s<2;s++){r[0]=t[0]-65517;for(let o=1;o<15;o++)r[o]=t[o]-65535-(r[o-1]>>16&1),r[o-1]&=65535;r[15]=t[15]-32767-(r[14]>>16&1);let n=r[15]>>16&1;r[14]&=65535,ei(t,r,1-n)}for(let s=0;s<16;s++)i[2*s]=t[s]&255,i[2*s+1]=t[s]>>8}function Ly(i,e){for(let r=0;r<16;r++)i[r]=e[2*r]+(e[2*r+1]<<8);i[15]&=32767}function _s(i,e,r){for(let t=0;t<16;t++)i[t]=e[t]+r[t]}function Es(i,e,r){for(let t=0;t<16;t++)i[t]=e[t]-r[t]}function st(i,e,r){let t,s,n=0,o=0,a=0,c=0,u=0,h=0,l=0,m=0,p=0,f=0,y=0,b=0,_=0,S=0,E=0,w=0,D=0,T=0,d=0,g=0,R=0,A=0,I=0,v=0,x=0,O=0,L=0,U=0,N=0,$=0,re=0,j=r[0],F=r[1],k=r[2],B=r[3],q=r[4],K=r[5],V=r[6],z=r[7],J=r[8],Y=r[9],X=r[10],Q=r[11],Z=r[12],te=r[13],ie=r[14],se=r[15];t=e[0],n+=t*j,o+=t*F,a+=t*k,c+=t*B,u+=t*q,h+=t*K,l+=t*V,m+=t*z,p+=t*J,f+=t*Y,y+=t*X,b+=t*Q,_+=t*Z,S+=t*te,E+=t*ie,w+=t*se,t=e[1],o+=t*j,a+=t*F,c+=t*k,u+=t*B,h+=t*q,l+=t*K,m+=t*V,p+=t*z,f+=t*J,y+=t*Y,b+=t*X,_+=t*Q,S+=t*Z,E+=t*te,w+=t*ie,D+=t*se,t=e[2],a+=t*j,c+=t*F,u+=t*k,h+=t*B,l+=t*q,m+=t*K,p+=t*V,f+=t*z,y+=t*J,b+=t*Y,_+=t*X,S+=t*Q,E+=t*Z,w+=t*te,D+=t*ie,T+=t*se,t=e[3],c+=t*j,u+=t*F,h+=t*k,l+=t*B,m+=t*q,p+=t*K,f+=t*V,y+=t*z,b+=t*J,_+=t*Y,S+=t*X,E+=t*Q,w+=t*Z,D+=t*te,T+=t*ie,d+=t*se,t=e[4],u+=t*j,h+=t*F,l+=t*k,m+=t*B,p+=t*q,f+=t*K,y+=t*V,b+=t*z,_+=t*J,S+=t*Y,E+=t*X,w+=t*Q,D+=t*Z,T+=t*te,d+=t*ie,g+=t*se,t=e[5],h+=t*j,l+=t*F,m+=t*k,p+=t*B,f+=t*q,y+=t*K,b+=t*V,_+=t*z,S+=t*J,E+=t*Y,w+=t*X,D+=t*Q,T+=t*Z,d+=t*te,g+=t*ie,R+=t*se,t=e[6],l+=t*j,m+=t*F,p+=t*k,f+=t*B,y+=t*q,b+=t*K,_+=t*V,S+=t*z,E+=t*J,w+=t*Y,D+=t*X,T+=t*Q,d+=t*Z,g+=t*te,R+=t*ie,A+=t*se,t=e[7],m+=t*j,p+=t*F,f+=t*k,y+=t*B,b+=t*q,_+=t*K,S+=t*V,E+=t*z,w+=t*J,D+=t*Y,T+=t*X,d+=t*Q,g+=t*Z,R+=t*te,A+=t*ie,I+=t*se,t=e[8],p+=t*j,f+=t*F,y+=t*k,b+=t*B,_+=t*q,S+=t*K,E+=t*V,w+=t*z,D+=t*J,T+=t*Y,d+=t*X,g+=t*Q,R+=t*Z,A+=t*te,I+=t*ie,v+=t*se,t=e[9],f+=t*j,y+=t*F,b+=t*k,_+=t*B,S+=t*q,E+=t*K,w+=t*V,D+=t*z,T+=t*J,d+=t*Y,g+=t*X,R+=t*Q,A+=t*Z,I+=t*te,v+=t*ie,x+=t*se,t=e[10],y+=t*j,b+=t*F,_+=t*k,S+=t*B,E+=t*q,w+=t*K,D+=t*V,T+=t*z,d+=t*J,g+=t*Y,R+=t*X,A+=t*Q,I+=t*Z,v+=t*te,x+=t*ie,O+=t*se,t=e[11],b+=t*j,_+=t*F,S+=t*k,E+=t*B,w+=t*q,D+=t*K,T+=t*V,d+=t*z,g+=t*J,R+=t*Y,A+=t*X,I+=t*Q,v+=t*Z,x+=t*te,O+=t*ie,L+=t*se,t=e[12],_+=t*j,S+=t*F,E+=t*k,w+=t*B,D+=t*q,T+=t*K,d+=t*V,g+=t*z,R+=t*J,A+=t*Y,I+=t*X,v+=t*Q,x+=t*Z,O+=t*te,L+=t*ie,U+=t*se,t=e[13],S+=t*j,E+=t*F,w+=t*k,D+=t*B,T+=t*q,d+=t*K,g+=t*V,R+=t*z,A+=t*J,I+=t*Y,v+=t*X,x+=t*Q,O+=t*Z,L+=t*te,U+=t*ie,N+=t*se,t=e[14],E+=t*j,w+=t*F,D+=t*k,T+=t*B,d+=t*q,g+=t*K,R+=t*V,A+=t*z,I+=t*J,v+=t*Y,x+=t*X,O+=t*Q,L+=t*Z,U+=t*te,N+=t*ie,$+=t*se,t=e[15],w+=t*j,D+=t*F,T+=t*k,d+=t*B,g+=t*q,R+=t*K,A+=t*V,I+=t*z,v+=t*J,x+=t*Y,O+=t*X,L+=t*Q,U+=t*Z,N+=t*te,$+=t*ie,re+=t*se,n+=38*D,o+=38*T,a+=38*d,c+=38*g,u+=38*R,h+=38*A,l+=38*I,m+=38*v,p+=38*x,f+=38*O,y+=38*L,b+=38*U,_+=38*N,S+=38*$,E+=38*re,s=1,t=n+s+65535,s=Math.floor(t/65536),n=t-s*65536,t=o+s+65535,s=Math.floor(t/65536),o=t-s*65536,t=a+s+65535,s=Math.floor(t/65536),a=t-s*65536,t=c+s+65535,s=Math.floor(t/65536),c=t-s*65536,t=u+s+65535,s=Math.floor(t/65536),u=t-s*65536,t=h+s+65535,s=Math.floor(t/65536),h=t-s*65536,t=l+s+65535,s=Math.floor(t/65536),l=t-s*65536,t=m+s+65535,s=Math.floor(t/65536),m=t-s*65536,t=p+s+65535,s=Math.floor(t/65536),p=t-s*65536,t=f+s+65535,s=Math.floor(t/65536),f=t-s*65536,t=y+s+65535,s=Math.floor(t/65536),y=t-s*65536,t=b+s+65535,s=Math.floor(t/65536),b=t-s*65536,t=_+s+65535,s=Math.floor(t/65536),_=t-s*65536,t=S+s+65535,s=Math.floor(t/65536),S=t-s*65536,t=E+s+65535,s=Math.floor(t/65536),E=t-s*65536,t=w+s+65535,s=Math.floor(t/65536),w=t-s*65536,n+=s-1+37*(s-1),s=1,t=n+s+65535,s=Math.floor(t/65536),n=t-s*65536,t=o+s+65535,s=Math.floor(t/65536),o=t-s*65536,t=a+s+65535,s=Math.floor(t/65536),a=t-s*65536,t=c+s+65535,s=Math.floor(t/65536),c=t-s*65536,t=u+s+65535,s=Math.floor(t/65536),u=t-s*65536,t=h+s+65535,s=Math.floor(t/65536),h=t-s*65536,t=l+s+65535,s=Math.floor(t/65536),l=t-s*65536,t=m+s+65535,s=Math.floor(t/65536),m=t-s*65536,t=p+s+65535,s=Math.floor(t/65536),p=t-s*65536,t=f+s+65535,s=Math.floor(t/65536),f=t-s*65536,t=y+s+65535,s=Math.floor(t/65536),y=t-s*65536,t=b+s+65535,s=Math.floor(t/65536),b=t-s*65536,t=_+s+65535,s=Math.floor(t/65536),_=t-s*65536,t=S+s+65535,s=Math.floor(t/65536),S=t-s*65536,t=E+s+65535,s=Math.floor(t/65536),E=t-s*65536,t=w+s+65535,s=Math.floor(t/65536),w=t-s*65536,n+=s-1+37*(s-1),i[0]=n,i[1]=o,i[2]=a,i[3]=c,i[4]=u,i[5]=h,i[6]=l,i[7]=m,i[8]=p,i[9]=f,i[10]=y,i[11]=b,i[12]=_,i[13]=S,i[14]=E,i[15]=w}function ti(i,e){st(i,e,e)}function Uy(i,e){let r=Je();for(let t=0;t<16;t++)r[t]=e[t];for(let t=253;t>=0;t--)ti(r,r),t!==2&&t!==4&&st(r,r,e);for(let t=0;t<16;t++)i[t]=r[t]}function Io(i,e){let r=new Uint8Array(32),t=new Float64Array(80),s=Je(),n=Je(),o=Je(),a=Je(),c=Je(),u=Je();for(let p=0;p<31;p++)r[p]=i[p];r[31]=i[31]&127|64,r[0]&=248,Ly(t,e);for(let p=0;p<16;p++)n[p]=t[p];s[0]=a[0]=1;for(let p=254;p>=0;--p){let f=r[p>>>3]>>>(p&7)&1;ei(s,n,f),ei(o,a,f),_s(c,s,o),Es(s,s,o),_s(o,n,a),Es(n,n,a),ti(a,c),ti(u,s),st(s,o,s),st(o,n,c),_s(c,s,o),Es(s,s,o),ti(n,s),Es(o,a,u),st(s,o,Cy),_s(s,s,a),st(o,o,s),st(s,a,u),st(a,n,t),ti(n,c),ei(s,n,f),ei(o,a,f)}for(let p=0;p<16;p++)t[p+16]=s[p],t[p+32]=o[p],t[p+48]=n[p],t[p+64]=a[p];let h=t.subarray(32),l=t.subarray(16);Uy(h,h),st(l,l,h);let m=new Uint8Array(32);return Py(m,l),m}pe.scalarMult=Io;function Il(i){return Io(i,Dl)}pe.scalarMultBase=Il;function Ol(i){if(i.length!==pe.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${pe.SECRET_KEY_LENGTH} bytes`);let e=new Uint8Array(i);return{publicKey:Il(e),secretKey:e}}pe.generateKeyPairFromSeed=Ol;function Fy(i){let e=(0,Ay.randomBytes)(32,i),r=Ol(e);return(0,Ny.wipe)(e),r}pe.generateKeyPair=Fy;function My(i,e,r=!1){if(i.length!==pe.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==pe.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let t=Io(i,e);if(r){let s=0;for(let n=0;n<t.length;n++)s|=t[n];if(s===0)throw new Error("X25519: invalid shared key")}return t}pe.sharedKey=My});var Oo=M(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.getLocalStorage=le.getLocalStorageOrThrow=le.getCrypto=le.getCryptoOrThrow=le.getLocation=le.getLocationOrThrow=le.getNavigator=le.getNavigatorOrThrow=le.getDocument=le.getDocumentOrThrow=le.getFromWindowOrThrow=le.getFromWindow=void 0;function Ct(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}le.getFromWindow=Ct;function dr(i){let e=Ct(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}le.getFromWindowOrThrow=dr;function Yy(){return dr("document")}le.getDocumentOrThrow=Yy;function Xy(){return Ct("document")}le.getDocument=Xy;function Qy(){return dr("navigator")}le.getNavigatorOrThrow=Qy;function Zy(){return Ct("navigator")}le.getNavigator=Zy;function e0(){return dr("location")}le.getLocationOrThrow=e0;function t0(){return Ct("location")}le.getLocation=t0;function r0(){return dr("crypto")}le.getCryptoOrThrow=r0;function i0(){return Ct("crypto")}le.getCrypto=i0;function s0(){return dr("localStorage")}le.getLocalStorageOrThrow=s0;function n0(){return Ct("localStorage")}le.getLocalStorage=n0});var Ul=M(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.getWindowMetadata=void 0;var Ll=Oo();function o0(){let i,e;try{i=Ll.getDocumentOrThrow(),e=Ll.getLocationOrThrow()}catch{return null}function r(){let l=i.getElementsByTagName("link"),m=[];for(let p=0;p<l.length;p++){let f=l[p],y=f.getAttribute("rel");if(y&&y.toLowerCase().indexOf("icon")>-1){let b=f.getAttribute("href");if(b)if(b.toLowerCase().indexOf("https:")===-1&&b.toLowerCase().indexOf("http:")===-1&&b.indexOf("//")!==0){let _=e.protocol+"//"+e.host;if(b.indexOf("/")===0)_+=b;else{let S=e.pathname.split("/");S.pop();let E=S.join("/");_+=E+"/"+b}m.push(_)}else if(b.indexOf("//")===0){let _=e.protocol+b;m.push(_)}else m.push(b)}}return m}function t(...l){let m=i.getElementsByTagName("meta");for(let p=0;p<m.length;p++){let f=m[p],y=["itemprop","property","name"].map(b=>f.getAttribute(b)).filter(b=>b?l.includes(b):!1);if(y.length&&y){let b=f.getAttribute("content");if(b)return b}}return""}function s(){let l=t("name","og:site_name","og:title","twitter:title");return l||(l=i.title),l}function n(){return t("description","og:description","twitter:description","keywords")}let o=s(),a=n(),c=e.origin,u=r();return{description:a,url:c,icons:u,name:o}}vs.getWindowMetadata=o0});var Ml=M((fS,Fl)=>{"use strict";Fl.exports=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)});var Hl=M((dS,Bl)=>{"use strict";var kl="%[a-f0-9]{2}",ql=new RegExp("("+kl+")|([^%]+?)","gi"),jl=new RegExp("("+kl+")+","gi");function To(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var r=i.slice(0,e),t=i.slice(e);return Array.prototype.concat.call([],To(r),To(t))}function a0(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(ql)||[],r=1;r<e.length;r++)i=To(e,r).join(""),e=i.match(ql)||[];return i}}function c0(i){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=jl.exec(i);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var t=a0(r[0]);t!==r[0]&&(e[r[0]]=t)}r=jl.exec(i)}e["%C2"]="\uFFFD";for(var s=Object.keys(e),n=0;n<s.length;n++){var o=s[n];i=i.replace(new RegExp(o,"g"),e[o])}return i}Bl.exports=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return c0(i)}}});var Vl=M((pS,Kl)=>{"use strict";Kl.exports=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];let r=i.indexOf(e);return r===-1?[i]:[i.slice(0,r),i.slice(r+e.length)]}});var $l=M((gS,zl)=>{"use strict";zl.exports=function(i,e){for(var r={},t=Object.keys(i),s=Array.isArray(e),n=0;n<t.length;n++){var o=t[n],a=i[o];(s?e.indexOf(o)!==-1:e(o,a,i))&&(r[o]=a)}return r}});var eh=M(Ue=>{"use strict";var u0=Ml(),l0=Hl(),Wl=Vl(),h0=$l(),f0=i=>i==null,Ro=Symbol("encodeFragmentIdentifier");function d0(i){switch(i.arrayFormat){case"index":return e=>(r,t)=>{let s=r.length;return t===void 0||i.skipNull&&t===null||i.skipEmptyString&&t===""?r:t===null?[...r,[me(e,i),"[",s,"]"].join("")]:[...r,[me(e,i),"[",me(s,i),"]=",me(t,i)].join("")]};case"bracket":return e=>(r,t)=>t===void 0||i.skipNull&&t===null||i.skipEmptyString&&t===""?r:t===null?[...r,[me(e,i),"[]"].join("")]:[...r,[me(e,i),"[]=",me(t,i)].join("")];case"colon-list-separator":return e=>(r,t)=>t===void 0||i.skipNull&&t===null||i.skipEmptyString&&t===""?r:t===null?[...r,[me(e,i),":list="].join("")]:[...r,[me(e,i),":list=",me(t,i)].join("")];case"comma":case"separator":case"bracket-separator":{let e=i.arrayFormat==="bracket-separator"?"[]=":"=";return r=>(t,s)=>s===void 0||i.skipNull&&s===null||i.skipEmptyString&&s===""?t:(s=s===null?"":s,t.length===0?[[me(r,i),e,me(s,i)].join("")]:[[t,me(s,i)].join(i.arrayFormatSeparator)])}default:return e=>(r,t)=>t===void 0||i.skipNull&&t===null||i.skipEmptyString&&t===""?r:t===null?[...r,me(e,i)]:[...r,[me(e,i),"=",me(t,i)].join("")]}}function p0(i){let e;switch(i.arrayFormat){case"index":return(r,t,s)=>{if(e=/\[(\d*)\]$/.exec(r),r=r.replace(/\[\d*\]$/,""),!e){s[r]=t;return}s[r]===void 0&&(s[r]={}),s[r][e[1]]=t};case"bracket":return(r,t,s)=>{if(e=/(\[\])$/.exec(r),r=r.replace(/\[\]$/,""),!e){s[r]=t;return}if(s[r]===void 0){s[r]=[t];return}s[r]=[].concat(s[r],t)};case"colon-list-separator":return(r,t,s)=>{if(e=/(:list)$/.exec(r),r=r.replace(/:list$/,""),!e){s[r]=t;return}if(s[r]===void 0){s[r]=[t];return}s[r]=[].concat(s[r],t)};case"comma":case"separator":return(r,t,s)=>{let n=typeof t=="string"&&t.includes(i.arrayFormatSeparator),o=typeof t=="string"&&!n&&nt(t,i).includes(i.arrayFormatSeparator);t=o?nt(t,i):t;let a=n||o?t.split(i.arrayFormatSeparator).map(c=>nt(c,i)):t===null?t:nt(t,i);s[r]=a};case"bracket-separator":return(r,t,s)=>{let n=/(\[\])$/.test(r);if(r=r.replace(/\[\]$/,""),!n){s[r]=t&&nt(t,i);return}let o=t===null?[]:t.split(i.arrayFormatSeparator).map(a=>nt(a,i));if(s[r]===void 0){s[r]=o;return}s[r]=[].concat(s[r],o)};default:return(r,t,s)=>{if(s[r]===void 0){s[r]=t;return}s[r]=[].concat(s[r],t)}}}function Jl(i){if(typeof i!="string"||i.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function me(i,e){return e.encode?e.strict?u0(i):encodeURIComponent(i):i}function nt(i,e){return e.decode?l0(i):i}function Yl(i){return Array.isArray(i)?i.sort():typeof i=="object"?Yl(Object.keys(i)).sort((e,r)=>Number(e)-Number(r)).map(e=>i[e]):i}function Xl(i){let e=i.indexOf("#");return e!==-1&&(i=i.slice(0,e)),i}function g0(i){let e="",r=i.indexOf("#");return r!==-1&&(e=i.slice(r)),e}function Ql(i){i=Xl(i);let e=i.indexOf("?");return e===-1?"":i.slice(e+1)}function Gl(i,e){return e.parseNumbers&&!Number.isNaN(Number(i))&&typeof i=="string"&&i.trim()!==""?i=Number(i):e.parseBooleans&&i!==null&&(i.toLowerCase()==="true"||i.toLowerCase()==="false")&&(i=i.toLowerCase()==="true"),i}function Zl(i,e){e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e),Jl(e.arrayFormatSeparator);let r=p0(e),t=Object.create(null);if(typeof i!="string"||(i=i.trim().replace(/^[?#&]/,""),!i))return t;for(let s of i.split("&")){if(s==="")continue;let[n,o]=Wl(e.decode?s.replace(/\+/g," "):s,"=");o=o===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?o:nt(o,e),r(nt(n,e),o,t)}for(let s of Object.keys(t)){let n=t[s];if(typeof n=="object"&&n!==null)for(let o of Object.keys(n))n[o]=Gl(n[o],e);else t[s]=Gl(n,e)}return e.sort===!1?t:(e.sort===!0?Object.keys(t).sort():Object.keys(t).sort(e.sort)).reduce((s,n)=>{let o=t[n];return Boolean(o)&&typeof o=="object"&&!Array.isArray(o)?s[n]=Yl(o):s[n]=o,s},Object.create(null))}Ue.extract=Ql;Ue.parse=Zl;Ue.stringify=(i,e)=>{if(!i)return"";e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e),Jl(e.arrayFormatSeparator);let r=o=>e.skipNull&&f0(i[o])||e.skipEmptyString&&i[o]==="",t=d0(e),s={};for(let o of Object.keys(i))r(o)||(s[o]=i[o]);let n=Object.keys(s);return e.sort!==!1&&n.sort(e.sort),n.map(o=>{let a=i[o];return a===void 0?"":a===null?me(o,e):Array.isArray(a)?a.length===0&&e.arrayFormat==="bracket-separator"?me(o,e)+"[]":a.reduce(t(o),[]).join("&"):me(o,e)+"="+me(a,e)}).filter(o=>o.length>0).join("&")};Ue.parseUrl=(i,e)=>{e=Object.assign({decode:!0},e);let[r,t]=Wl(i,"#");return Object.assign({url:r.split("?")[0]||"",query:Zl(Ql(i),e)},e&&e.parseFragmentIdentifier&&t?{fragmentIdentifier:nt(t,e)}:{})};Ue.stringifyUrl=(i,e)=>{e=Object.assign({encode:!0,strict:!0,[Ro]:!0},e);let r=Xl(i.url).split("?")[0]||"",t=Ue.extract(i.url),s=Ue.parse(t,{sort:!1}),n=Object.assign(s,i.query),o=Ue.stringify(n,e);o&&(o=`?${o}`);let a=g0(i.url);return i.fragmentIdentifier&&(a=`#${e[Ro]?me(i.fragmentIdentifier,e):i.fragmentIdentifier}`),`${r}${o}${a}`};Ue.pick=(i,e,r)=>{r=Object.assign({parseFragmentIdentifier:!0,[Ro]:!1},r);let{url:t,query:s,fragmentIdentifier:n}=Ue.parseUrl(i,r);return Ue.stringifyUrl({url:t,query:h0(s,e),fragmentIdentifier:n},r)};Ue.exclude=(i,e,r)=>{let t=Array.isArray(e)?s=>!e.includes(s):(s,n)=>!e(s,n);return Ue.pick(i,t,r)}});var Qh=M(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.isBrowserCryptoAvailable=mt.getSubtleCrypto=mt.getBrowerCrypto=void 0;function Go(){return globalThis?.crypto||globalThis?.msCrypto||{}}mt.getBrowerCrypto=Go;function Xh(){let i=Go();return i.subtle||i.webkitSubtle}mt.getSubtleCrypto=Xh;function Z0(){return!!Go()&&!!Xh()}mt.isBrowserCryptoAvailable=Z0});var tf=M(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.isBrowser=yt.isNode=yt.isReactNative=void 0;function Zh(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}yt.isReactNative=Zh;function ef(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}yt.isNode=ef;function eb(){return!Zh()&&!ef()}yt.isBrowser=eb});var Wo=M(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});var rf=(qe(),Ne(Me));rf.__exportStar(Qh(),Cs);rf.__exportStar(tf(),Cs)});var uf=M((T3,cf)=>{"use strict";cf.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var fa=M((fi,xr)=>{var fb=200,ha="__lodash_hash_undefined__",zs=1,Sf=2,Df=9007199254740991,qs="[object Arguments]",sa="[object Array]",db="[object AsyncFunction]",If="[object Boolean]",Of="[object Date]",Tf="[object Error]",Rf="[object Function]",pb="[object GeneratorFunction]",js="[object Map]",Af="[object Number]",gb="[object Null]",vr="[object Object]",df="[object Promise]",mb="[object Proxy]",Nf="[object RegExp]",ks="[object Set]",Cf="[object String]",yb="[object Symbol]",bb="[object Undefined]",na="[object WeakMap]",Pf="[object ArrayBuffer]",Bs="[object DataView]",wb="[object Float32Array]",_b="[object Float64Array]",Eb="[object Int8Array]",vb="[object Int16Array]",xb="[object Int32Array]",Sb="[object Uint8Array]",Db="[object Uint8ClampedArray]",Ib="[object Uint16Array]",Ob="[object Uint32Array]",Tb=/[\\^$.*+?()[\]{}|]/g,Rb=/^\[object .+?Constructor\]$/,Ab=/^(?:0|[1-9]\d*)$/,he={};he[wb]=he[_b]=he[Eb]=he[vb]=he[xb]=he[Sb]=he[Db]=he[Ib]=he[Ob]=!0;he[qs]=he[sa]=he[Pf]=he[If]=he[Bs]=he[Of]=he[Tf]=he[Rf]=he[js]=he[Af]=he[vr]=he[Nf]=he[ks]=he[Cf]=he[na]=!1;var Lf=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Nb=typeof self=="object"&&self&&self.Object===Object&&self,ct=Lf||Nb||Function("return this")(),Uf=typeof fi=="object"&&fi&&!fi.nodeType&&fi,pf=Uf&&typeof xr=="object"&&xr&&!xr.nodeType&&xr,Ff=pf&&pf.exports===Uf,ta=Ff&&Lf.process,gf=function(){try{return ta&&ta.binding&&ta.binding("util")}catch{}}(),mf=gf&&gf.isTypedArray;function Cb(i,e){for(var r=-1,t=i==null?0:i.length,s=0,n=[];++r<t;){var o=i[r];e(o,r,i)&&(n[s++]=o)}return n}function Pb(i,e){for(var r=-1,t=e.length,s=i.length;++r<t;)i[s+r]=e[r];return i}function Lb(i,e){for(var r=-1,t=i==null?0:i.length;++r<t;)if(e(i[r],r,i))return!0;return!1}function Ub(i,e){for(var r=-1,t=Array(i);++r<i;)t[r]=e(r);return t}function Fb(i){return function(e){return i(e)}}function Mb(i,e){return i.has(e)}function qb(i,e){return i?.[e]}function jb(i){var e=-1,r=Array(i.size);return i.forEach(function(t,s){r[++e]=[s,t]}),r}function kb(i,e){return function(r){return i(e(r))}}function Bb(i){var e=-1,r=Array(i.size);return i.forEach(function(t){r[++e]=t}),r}var Hb=Array.prototype,Kb=Function.prototype,$s=Object.prototype,ra=ct["__core-js_shared__"],Mf=Kb.toString,Xe=$s.hasOwnProperty,yf=function(){var i=/[^.]+$/.exec(ra&&ra.keys&&ra.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),qf=$s.toString,Vb=RegExp("^"+Mf.call(Xe).replace(Tb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bf=Ff?ct.Buffer:void 0,Hs=ct.Symbol,wf=ct.Uint8Array,jf=$s.propertyIsEnumerable,zb=Hb.splice,Mt=Hs?Hs.toStringTag:void 0,_f=Object.getOwnPropertySymbols,$b=bf?bf.isBuffer:void 0,Gb=kb(Object.keys,Object),oa=Sr(ct,"DataView"),di=Sr(ct,"Map"),aa=Sr(ct,"Promise"),ca=Sr(ct,"Set"),ua=Sr(ct,"WeakMap"),pi=Sr(Object,"create"),Wb=kt(oa),Jb=kt(di),Yb=kt(aa),Xb=kt(ca),Qb=kt(ua),Ef=Hs?Hs.prototype:void 0,ia=Ef?Ef.valueOf:void 0;function qt(i){var e=-1,r=i==null?0:i.length;for(this.clear();++e<r;){var t=i[e];this.set(t[0],t[1])}}function Zb(){this.__data__=pi?pi(null):{},this.size=0}function ew(i){var e=this.has(i)&&delete this.__data__[i];return this.size-=e?1:0,e}function tw(i){var e=this.__data__;if(pi){var r=e[i];return r===ha?void 0:r}return Xe.call(e,i)?e[i]:void 0}function rw(i){var e=this.__data__;return pi?e[i]!==void 0:Xe.call(e,i)}function iw(i,e){var r=this.__data__;return this.size+=this.has(i)?0:1,r[i]=pi&&e===void 0?ha:e,this}qt.prototype.clear=Zb;qt.prototype.delete=ew;qt.prototype.get=tw;qt.prototype.has=rw;qt.prototype.set=iw;function ut(i){var e=-1,r=i==null?0:i.length;for(this.clear();++e<r;){var t=i[e];this.set(t[0],t[1])}}function sw(){this.__data__=[],this.size=0}function nw(i){var e=this.__data__,r=Gs(e,i);if(r<0)return!1;var t=e.length-1;return r==t?e.pop():zb.call(e,r,1),--this.size,!0}function ow(i){var e=this.__data__,r=Gs(e,i);return r<0?void 0:e[r][1]}function aw(i){return Gs(this.__data__,i)>-1}function cw(i,e){var r=this.__data__,t=Gs(r,i);return t<0?(++this.size,r.push([i,e])):r[t][1]=e,this}ut.prototype.clear=sw;ut.prototype.delete=nw;ut.prototype.get=ow;ut.prototype.has=aw;ut.prototype.set=cw;function jt(i){var e=-1,r=i==null?0:i.length;for(this.clear();++e<r;){var t=i[e];this.set(t[0],t[1])}}function uw(){this.size=0,this.__data__={hash:new qt,map:new(di||ut),string:new qt}}function lw(i){var e=Ws(this,i).delete(i);return this.size-=e?1:0,e}function hw(i){return Ws(this,i).get(i)}function fw(i){return Ws(this,i).has(i)}function dw(i,e){var r=Ws(this,i),t=r.size;return r.set(i,e),this.size+=r.size==t?0:1,this}jt.prototype.clear=uw;jt.prototype.delete=lw;jt.prototype.get=hw;jt.prototype.has=fw;jt.prototype.set=dw;function Ks(i){var e=-1,r=i==null?0:i.length;for(this.__data__=new jt;++e<r;)this.add(i[e])}function pw(i){return this.__data__.set(i,ha),this}function gw(i){return this.__data__.has(i)}Ks.prototype.add=Ks.prototype.push=pw;Ks.prototype.has=gw;function _t(i){var e=this.__data__=new ut(i);this.size=e.size}function mw(){this.__data__=new ut,this.size=0}function yw(i){var e=this.__data__,r=e.delete(i);return this.size=e.size,r}function bw(i){return this.__data__.get(i)}function ww(i){return this.__data__.has(i)}function _w(i,e){var r=this.__data__;if(r instanceof ut){var t=r.__data__;if(!di||t.length<fb-1)return t.push([i,e]),this.size=++r.size,this;r=this.__data__=new jt(t)}return r.set(i,e),this.size=r.size,this}_t.prototype.clear=mw;_t.prototype.delete=yw;_t.prototype.get=bw;_t.prototype.has=ww;_t.prototype.set=_w;function Ew(i,e){var r=Vs(i),t=!r&&Fw(i),s=!r&&!t&&la(i),n=!r&&!t&&!s&&$f(i),o=r||t||s||n,a=o?Ub(i.length,String):[],c=a.length;for(var u in i)(e||Xe.call(i,u))&&!(o&&(u=="length"||s&&(u=="offset"||u=="parent")||n&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Nw(u,c)))&&a.push(u);return a}function Gs(i,e){for(var r=i.length;r--;)if(Hf(i[r][0],e))return r;return-1}function vw(i,e,r){var t=e(i);return Vs(i)?t:Pb(t,r(i))}function mi(i){return i==null?i===void 0?bb:gb:Mt&&Mt in Object(i)?Rw(i):Uw(i)}function vf(i){return gi(i)&&mi(i)==qs}function kf(i,e,r,t,s){return i===e?!0:i==null||e==null||!gi(i)&&!gi(e)?i!==i&&e!==e:xw(i,e,r,t,kf,s)}function xw(i,e,r,t,s,n){var o=Vs(i),a=Vs(e),c=o?sa:wt(i),u=a?sa:wt(e);c=c==qs?vr:c,u=u==qs?vr:u;var h=c==vr,l=u==vr,m=c==u;if(m&&la(i)){if(!la(e))return!1;o=!0,h=!1}if(m&&!h)return n||(n=new _t),o||$f(i)?Bf(i,e,r,t,s,n):Ow(i,e,c,r,t,s,n);if(!(r&zs)){var p=h&&Xe.call(i,"__wrapped__"),f=l&&Xe.call(e,"__wrapped__");if(p||f){var y=p?i.value():i,b=f?e.value():e;return n||(n=new _t),s(y,b,r,t,n)}}return m?(n||(n=new _t),Tw(i,e,r,t,s,n)):!1}function Sw(i){if(!zf(i)||Pw(i))return!1;var e=Kf(i)?Vb:Rb;return e.test(kt(i))}function Dw(i){return gi(i)&&Vf(i.length)&&!!he[mi(i)]}function Iw(i){if(!Lw(i))return Gb(i);var e=[];for(var r in Object(i))Xe.call(i,r)&&r!="constructor"&&e.push(r);return e}function Bf(i,e,r,t,s,n){var o=r&zs,a=i.length,c=e.length;if(a!=c&&!(o&&c>a))return!1;var u=n.get(i);if(u&&n.get(e))return u==e;var h=-1,l=!0,m=r&Sf?new Ks:void 0;for(n.set(i,e),n.set(e,i);++h<a;){var p=i[h],f=e[h];if(t)var y=o?t(f,p,h,e,i,n):t(p,f,h,i,e,n);if(y!==void 0){if(y)continue;l=!1;break}if(m){if(!Lb(e,function(b,_){if(!Mb(m,_)&&(p===b||s(p,b,r,t,n)))return m.push(_)})){l=!1;break}}else if(!(p===f||s(p,f,r,t,n))){l=!1;break}}return n.delete(i),n.delete(e),l}function Ow(i,e,r,t,s,n,o){switch(r){case Bs:if(i.byteLength!=e.byteLength||i.byteOffset!=e.byteOffset)return!1;i=i.buffer,e=e.buffer;case Pf:return!(i.byteLength!=e.byteLength||!n(new wf(i),new wf(e)));case If:case Of:case Af:return Hf(+i,+e);case Tf:return i.name==e.name&&i.message==e.message;case Nf:case Cf:return i==e+"";case js:var a=jb;case ks:var c=t&zs;if(a||(a=Bb),i.size!=e.size&&!c)return!1;var u=o.get(i);if(u)return u==e;t|=Sf,o.set(i,e);var h=Bf(a(i),a(e),t,s,n,o);return o.delete(i),h;case yb:if(ia)return ia.call(i)==ia.call(e)}return!1}function Tw(i,e,r,t,s,n){var o=r&zs,a=xf(i),c=a.length,u=xf(e),h=u.length;if(c!=h&&!o)return!1;for(var l=c;l--;){var m=a[l];if(!(o?m in e:Xe.call(e,m)))return!1}var p=n.get(i);if(p&&n.get(e))return p==e;var f=!0;n.set(i,e),n.set(e,i);for(var y=o;++l<c;){m=a[l];var b=i[m],_=e[m];if(t)var S=o?t(_,b,m,e,i,n):t(b,_,m,i,e,n);if(!(S===void 0?b===_||s(b,_,r,t,n):S)){f=!1;break}y||(y=m=="constructor")}if(f&&!y){var E=i.constructor,w=e.constructor;E!=w&&"constructor"in i&&"constructor"in e&&!(typeof E=="function"&&E instanceof E&&typeof w=="function"&&w instanceof w)&&(f=!1)}return n.delete(i),n.delete(e),f}function xf(i){return vw(i,jw,Aw)}function Ws(i,e){var r=i.__data__;return Cw(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Sr(i,e){var r=qb(i,e);return Sw(r)?r:void 0}function Rw(i){var e=Xe.call(i,Mt),r=i[Mt];try{i[Mt]=void 0;var t=!0}catch{}var s=qf.call(i);return t&&(e?i[Mt]=r:delete i[Mt]),s}var Aw=_f?function(i){return i==null?[]:(i=Object(i),Cb(_f(i),function(e){return jf.call(i,e)}))}:kw,wt=mi;(oa&&wt(new oa(new ArrayBuffer(1)))!=Bs||di&&wt(new di)!=js||aa&&wt(aa.resolve())!=df||ca&&wt(new ca)!=ks||ua&&wt(new ua)!=na)&&(wt=function(i){var e=mi(i),r=e==vr?i.constructor:void 0,t=r?kt(r):"";if(t)switch(t){case Wb:return Bs;case Jb:return js;case Yb:return df;case Xb:return ks;case Qb:return na}return e});function Nw(i,e){return e=e??Df,!!e&&(typeof i=="number"||Ab.test(i))&&i>-1&&i%1==0&&i<e}function Cw(i){var e=typeof i;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?i!=="__proto__":i===null}function Pw(i){return!!yf&&yf in i}function Lw(i){var e=i&&i.constructor,r=typeof e=="function"&&e.prototype||$s;return i===r}function Uw(i){return qf.call(i)}function kt(i){if(i!=null){try{return Mf.call(i)}catch{}try{return i+""}catch{}}return""}function Hf(i,e){return i===e||i!==i&&e!==e}var Fw=vf(function(){return arguments}())?vf:function(i){return gi(i)&&Xe.call(i,"callee")&&!jf.call(i,"callee")},Vs=Array.isArray;function Mw(i){return i!=null&&Vf(i.length)&&!Kf(i)}var la=$b||Bw;function qw(i,e){return kf(i,e)}function Kf(i){if(!zf(i))return!1;var e=mi(i);return e==Rf||e==pb||e==db||e==mb}function Vf(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=Df}function zf(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}function gi(i){return i!=null&&typeof i=="object"}var $f=mf?Fb(mf):Dw;function jw(i){return Mw(i)?Ew(i):Iw(i)}function kw(){return[]}function Bw(){return!1}xr.exports=qw});var Pd=M(Or=>{"use strict";var i1=Or&&Or.__extends||function(){var i=function(e,r){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var n in s)s.hasOwnProperty(n)&&(t[n]=s[n])},i(e,r)};return function(e,r){i(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}}();Object.defineProperty(Or,"__esModule",{value:!0});Or.QRCode=void 0;var s1=fa(),n1=kd(),Va=$a(),o1=jd(),a1=function(i){i1(e,i);function e(r){var t=i.call(this,r)||this;return t.canvas=Va.createRef(),t}return e.utf16to8=function(r){var t="",s,n,o=r.length;for(s=0;s<o;s++)n=r.charCodeAt(s),n>=1&&n<=127?t+=r.charAt(s):n>2047?(t+=String.fromCharCode(224|n>>12&15),t+=String.fromCharCode(128|n>>6&63),t+=String.fromCharCode(128|n>>0&63)):(t+=String.fromCharCode(192|n>>6&31),t+=String.fromCharCode(128|n>>0&63));return t},e.prototype.drawRoundedSquare=function(r,t,s,n,o,a,c,u){u.lineWidth=r,u.fillStyle=o,u.strokeStyle=o,s+=r/2,t+=r/2,n-=r,Array.isArray(a)||(a=[a,a,a,a]),a=a.map(function(f){return f=Math.min(f,n/2),f<0?0:f});var h=a[0]||0,l=a[1]||0,m=a[2]||0,p=a[3]||0;u.beginPath(),u.moveTo(t+h,s),u.lineTo(t+n-l,s),l&&u.quadraticCurveTo(t+n,s,t+n,s+l),u.lineTo(t+n,s+n-m),m&&u.quadraticCurveTo(t+n,s+n,t+n-m,s+n),u.lineTo(t+p,s+n),p&&u.quadraticCurveTo(t,s+n,t,s+n-p),u.lineTo(t,s+h),h&&u.quadraticCurveTo(t,s,t+h,s),u.closePath(),u.stroke(),c&&u.fill()},e.prototype.drawPositioningPattern=function(r,t,s,n,o,a,c){c===void 0&&(c=[0,0,0,0]);var u=Math.ceil(t),h,l;typeof c!="number"&&!Array.isArray(c)?(h=c.outer||0,l=c.inner||0):(h=c,l=h);var m,p;typeof a!="string"?(m=a.outer,p=a.inner):(m=a,p=a);var f=n*t+s,y=o*t+s,b=t*7;this.drawRoundedSquare(u,y,f,b,m,h,!1,r),b=t*3,f+=t*2,y+=t*2,this.drawRoundedSquare(u,y,f,b,p,l,!0,r)},e.prototype.isInPositioninZone=function(r,t,s){return s.some(function(n){return t>=n.row&&t<=n.row+7&&r>=n.col&&r<=n.col+7})},e.prototype.transformPixelLengthIntoNumberOfCells=function(r,t){return r/t},e.prototype.isCoordinateInImage=function(r,t,s,n,o,a,c,u){if(u){var h=2,l=this.transformPixelLengthIntoNumberOfCells(o,c),m=this.transformPixelLengthIntoNumberOfCells(a,c),p=this.transformPixelLengthIntoNumberOfCells(s,c)-1,f=this.transformPixelLengthIntoNumberOfCells(n,c)-1;return t>=l-h&&t<=l+p+h&&r>=m-h&&r<=m+f+h}else return!1},e.prototype.shouldComponentUpdate=function(r){return!s1(this.props,r)},e.prototype.componentDidMount=function(){this.update()},e.prototype.componentDidUpdate=function(){this.update()},e.prototype.update=function(){var r=this.props,t=r.value,s=r.ecLevel,n=r.enableCORS,o=r.bgColor,a=r.fgColor,c=r.logoImage,u=r.logoOpacity,h=r.logoOnLoad,l=r.removeQrCodeBehindLogo,m=r.qrStyle,p=r.eyeRadius,f=r.eyeColor,y=r.logoPaddingStyle,b=+this.props.size,_=+this.props.quietZone,S=this.props.logoWidth?+this.props.logoWidth:0,E=this.props.logoHeight?+this.props.logoHeight:0,w=this.props.logoPadding?+this.props.logoPadding:0,D=n1(0,s);D.addData(e.utf16to8(t)),D.make();var T=o1.findDOMNode(this.canvas.current),d=T.getContext("2d"),g=b+2*_,R=D.getModuleCount(),A=b/R,I=window.devicePixelRatio||1;T.height=T.width=g*I,d.scale(I,I),d.fillStyle=o,d.fillRect(0,0,g,g);var v=_,x=[{row:0,col:0},{row:0,col:R-7},{row:R-7,col:0}];if(d.strokeStyle=a,m==="dots"){d.fillStyle=a;for(var O=A/2,L=0;L<R;L++)for(var U=0;U<R;U++)D.isDark(L,U)&&!this.isInPositioninZone(L,U,x)&&(d.beginPath(),d.arc(Math.round(U*A)+O+v,Math.round(L*A)+O+v,O/100*75,0,2*Math.PI,!1),d.closePath(),d.fill())}else for(var L=0;L<R;L++)for(var U=0;U<R;U++)if(D.isDark(L,U)&&!this.isInPositioninZone(L,U,x)){d.fillStyle=a;var N=Math.ceil((U+1)*A)-Math.floor(U*A),$=Math.ceil((L+1)*A)-Math.floor(L*A);d.fillRect(Math.round(U*A)+v,Math.round(L*A)+v,N,$)}for(var re=0;re<3;re++){var j=x[re],L=j.row,U=j.col,F=p,k=void 0;Array.isArray(F)&&(F=F[re]),typeof F=="number"&&(F=[F,F,F,F]),f?Array.isArray(f)?k=f[re]:k=f:k=a,this.drawPositioningPattern(d,A,v,L,U,k,F)}if(c){var B=new Image;n&&(B.crossOrigin="Anonymous"),B.onload=function(){d.save();var q=S||b*.2,K=E||q,V=(b-q)/2,z=(b-K)/2;if(l||w){d.beginPath(),d.strokeStyle=o,d.fillStyle=o;var J=q+2*w,Y=K+2*w,X=V+v-w,Q=z+v-w;if(y==="circle"){var Z=X+J/2,te=Q+Y/2;d.ellipse(Z,te,J/2,Y/2,0,0,2*Math.PI),d.stroke(),d.fill()}else d.fillRect(X,Q,J,Y)}d.globalAlpha=u,d.drawImage(B,V+v,z+v,q,K),d.restore(),h&&h()},B.src=c}},e.prototype.render=function(){var r,t=+this.props.size+2*+this.props.quietZone;return Va.createElement("canvas",{id:(r=this.props.id)!==null&&r!==void 0?r:"react-qrcode-logo",height:t,width:t,style:{height:t+"px",width:t+"px"},ref:this.canvas})},e.defaultProps={value:"https://reactjs.org/",ecLevel:"M",enableCORS:!1,size:150,quietZone:10,bgColor:"#FFFFFF",fgColor:"#000000",logoOpacity:1,qrStyle:"squares",eyeRadius:[0,0,0],logoPaddingStyle:"square"},e}(Va.Component);Or.QRCode=a1});var vt=oe($a());var Fd=oe(Zs());function Nr(){let i=new Uint32Array(4);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(i);else for(let e=0;e<i.length;e++)i[e]=Math.floor(Math.random()*4294967295);return Array.from(i).map(e=>e.toString(36)).join("")}var Bd={public_key:{title:"View public key",description:"Requests account public key. It's a simple way of authentication for Stellar-based applications. The response ensures that a user owns the corresponding secret key.",implicitFlow:!1,params:{token:{description:"Verification token generated by the application (should be unique or random).",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST a signed token and public key.",type:"string",required:!1},require_existing:{description:"Allow existing Albedo accounts only.",type:"boolean",required:!1}},returns:{pubkey:{description:"User-selected public key.",type:"string"},signed_message:{description:"HEX-encoded authentication message derived from the public key and verification token.",type:"string"},signature:{description:"HEX-encoded ED25519 signature of the authentication message that can be further used to verify user's keypair ownership.",type:"string"}}},sign_message:{title:"Sign text message",description:"Requests arbitrary message signing. Can be used to implement identity/ownership verification.",implicitFlow:!0,params:{message:{description:"Text message to sign.",type:"string",required:!0},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST a signed message.",type:"string",required:!1}},returns:{pubkey:{description:"User-selected public key.",type:"string"},original_message:{description:"Text message to sign from request.",type:"string"},signed_message:{description:"HEX-encoded message derived from the public key and original message.",type:"string"},message_signature:{description:"HEX-encoded ED25519 signature of the signed message.",type:"string"}}},tx:{title:"Sign transaction",description:"Requests a signature for the transaction. Returns the signed transaction envelope that can be submitted to the network or used for multi-sig coordination.",implicitFlow:!0,params:{xdr:{description:"XDR-encoded transaction envelope to sign.",type:"string",required:!0},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon.",type:"string",required:!1},description:{description:"Optional human-friendly short transaction description provided by developers.",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{xdr:{description:"XDR-encoded transaction envelope from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},pay:{title:"Make payment",description:"Requests a payment from a user. Works with any Stellar asset, supports transaction memo.",implicitFlow:!0,params:{amount:{description:"Requested payment amount.",type:"string",required:!0},destination:{description:"Payment destination address.",type:"string",required:!0},asset_code:{description:"Asset code (skip for XLM).",type:"string",required:!1},asset_issuer:{description:"Asset issuer (skip for XLM).",type:"string",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",type:"string",required:!1},memo_type:{description:"Transaction memo type.",type:"string",required:!1},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon. ",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{amount:{description:"Payment amount from request.",type:"string"},destination:{description:"Payment destination address from request.",type:"string"},asset_code:{description:"Asset code from request.",type:"string"},asset_issuer:{description:"Asset issuer from request.",type:"string"},memo:{description:"Transaction memo from request.",type:"string"},memo_type:{description:"Transaction memo type from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},trust:{title:"Establish trustline",description:"Requests permission to create a trustline to a given Stellar asset. Gradually simplifies the process of creating trustlines for anchors, ICOs, and airdrops.",implicitFlow:!0,params:{asset_code:{description:"Trustline asset code.",type:"string",required:!0},asset_issuer:{description:"Trustline asset issuer address.",type:"string",required:!0},limit:{description:"Trust limit.",type:"string",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",type:"string",required:!1},memo_type:{description:"Transaction memo type.",type:"string",required:!1},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon. ",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{asset_code:{description:"Trustline asset code from request.",type:"string"},asset_issuer:{description:"Trustline asset issuer address from request.",type:"string"},limit:{description:"Trust limit from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},exchange:{title:"Swap tokens",description:"Requests permission to buy tokens on Stellar DEX at market price.",implicitFlow:!1,params:{amount:{description:"The amount of asset to buy.",type:"string",required:!0},max_price:{description:"Maximum price the user willing to pay.",type:"string",required:!0},sell_asset_code:{description:"Asset code of the asset to sell.",type:"string",required:!1},sell_asset_issuer:{description:"Issuer account of the asset to sell.",type:"string",required:!1},buy_asset_code:{description:"Asset code of the asset to buy.",type:"string",required:!1},buy_asset_issuer:{description:"Issuer account of the asset to buy.",type:"string",required:!1},memo:{description:"Transaction memo (required for exchanges and some anchors).",type:"string",required:!1},memo_type:{description:"Transaction memo type.",type:"string",required:!1},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1},callback:{description:"Optional URL callback where Albedo will POST the signed transaction XDR instead of submitting it to Horizon.",type:"string",required:!1},submit:{description:"If set, the signed transaction will be submitted to the Horizon server instead of returning it to the application.",type:"boolean",required:!1}},returns:{amount:{description:"The amount of asset to buy from request.",type:"string"},max_price:{description:"Maximum price the user willing to pay from request.",type:"string"},sell_asset_code:{description:"Asset code of the asset to sell from request.",type:"string"},sell_asset_issuer:{description:"Issuer account of the asset to sell from request.",type:"string"},buy_asset_code:{description:"Asset code of the asset to buy from request.",type:"string"},buy_asset_issuer:{description:"Issuer account of the asset to buy from request.",type:"string"},tx_hash:{description:"HEX-encoded transaction hash.",type:"string"},signed_envelope_xdr:{description:"XDR-encoded transaction envelope with new signatures.",type:"string"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"},result:{description:"Optional response from Horizon if the transaction has been submitted automatically.",type:"object"}}},implicit_flow:{title:"Implicit permissions",description:'Requests temporary access token for one or more intents that can be used to execute actions without explicit confirmation from the user. In order to be executed implicitly, an implicit flow permissions for a given intent should be granted and "pubkey" parameter set.',implicitFlow:!1,params:{intents:{description:"Requested implicit flow intents.",type:"string|string[]",required:!0},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1}},returns:{granted:{description:"Whether a user granted permissions or not.",type:"boolean"},intents:{description:"Requested implicit flow intents.",type:"string[]"},grants:{description:"Implicit flow intents that have been granted.",type:"string[]"},session:{description:"Unique implicit session id.",type:"string"},valid_until:{description:"Session expiration timestamp.",type:"number"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"}}},manage_account:{title:"Open account settings",description:"Opens account settings window for a given account.",implicitFlow:!1,params:{pubkey:{description:"Specific public key requested by the application.",type:"string",required:!0},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1}},returns:{pubkey:{description:"Public key from intent request.",type:"string"}}},batch:{title:"Intents batch",description:"Requests execution of several tx intents bundled together. This intent is atomic \u2013 a user confirms or rejects all bundled requests at once, with the same account and the same Stellar network.",implicitFlow:!0,params:{intents:{description:"Requested tx intents that should be executed together.",type:"object[]",required:!0},pubkey:{description:"Specific public key requested by the application.",type:"string",required:!1},network:{description:"Stellar network identifier or private network passphrase.",type:"string",required:!1}},returns:{intents:{description:"Requested tx intents.",type:"object[]"},results:{description:"Array of results for each requested intent.",type:"object[]"},pubkey:{description:"User-selected public key.",type:"string"},network:{description:"Stellar network identifier.",type:"string"}}}},xi=Bd;var Hd={unhandledError:{message:"Unhandled error occurred. If this error persists, please contact Albedo support.",code:-1},externalError:{message:"External error occurred.",code:-2},invalidIntentRequest:{message:"Intent request is invalid.",code:-3},actionRejectedByUser:{message:"Action request was rejected by the user.",code:-4},horizonError:{message:"Transaction failed when submitted to Stellar network.",code:-5},callbackError:{message:"Callback redirect failed.",code:-6}},Ht=Hd;function Za(i,e=!1){this.windowHandler=i,this.ephemeral=!!e,this.isLoaded=!1,this.pendingRequests={},this.preprocessRequestParams=null,this.onLoaded=new Promise((r,t)=>this.onLoadedCallback=r).then(()=>this),this.messageHandler=this.messageHandler.bind(this),window.addEventListener("message",this.messageHandler,!1)}Za.prototype={isLoaded:!1,protocolVersion:3,markLoaded(){let{onLoadedCallback:i}=this;i&&(this.onLoadedCallback=null,this.isLoaded=!0,i())},messageHandler({data:i}){if(i.albedo)return this.matchProtocolVersion(i.albedo.protocol),this.markLoaded();if(i.albedoIntentResult){let{__reqid:e,...r}=i.albedoIntentResult,t=this.pendingRequests[e];t&&(delete this.pendingRequests[e],t(r),this.ephemeral&&(window.removeEventListener("message",this.messageHandler,!1),this.windowHandler.close()))}},transportCloseHandler(){for(let i in this.pendingRequests)if(this.pendingRequests.hasOwnProperty(i)){let e=this.pendingRequests[i];delete this.pendingRequests[i],e(Ht.actionRejectedByUser)}},postMessage(i){let e=Nr();return new Promise((r,t)=>{this.onLoaded.then(()=>{this.pendingRequests[e]=Kd.bind(this,r,t),i=Object.assign({__reqid:e,__albedo_intent_version:this.protocolVersion},i),this.preprocessRequestParams&&(i=this.preprocessRequestParams(i)),this.windowHandler.postMessage(i,"*")})})},matchProtocolVersion(i){let e=i-this.protocolVersion;if(e===0)return;let r=`@albedo-link/intent module protocol version (${this.protocolVersion}) is incompatible with current Albedo protocol version ${i}.`;if(e>0)console.warn(r+" Please update @albedo-link/intent module to avoid possible connection problems.");else if(e<0)throw this.windowHandler.close(),new Error(r)}};function Kd(i,e,r){r.error?e(r):i(r)}var en=Za;function ec(i){let e=`${i}/confirm`,r=480,t=600,s=window.screenLeft!==void 0?window.screenLeft:window.screenX,n=window.screenTop!==void 0?window.screenTop:window.screenY,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=o/2-r/2+s,u=a/2-t/2+n,h=window.open(e,"auth.albedo.link",`height=${t},width=${r},top=${u},left=${c},menubar=0,toolbar=0,location=0,status=0,personalbar=0,scrollbars=0,dependent=1`);return new en(h,!0).onLoaded}var tn=null;function rn(i){if(!tn){let e=document.createElement("iframe");e.style.border="none",Object.assign(e,{width:"0",height:"0",frameBorder:"0",referrerPolicy:"origin",src:`${i}`}),document.body.appendChild(e),tn=new en(e.contentWindow)}return tn.onLoaded}function tc({session:i,pubkey:e,grants:r,valid_until:t}){this.key=i,this.pubkey=e,this.grants=r.slice(),this.validUntil=t,Object.freeze(this),Object.freeze(this.grants)}tc.prototype={key:"",pubkey:"",grants:[],validUntil:0,get isExpired(){return this.validUntil-2e3<new Date().getTime()},toJSON(){return{session:this.key,pubkey:this.pubkey,grants:this.grants.slice(),valid_until:this.validUntil}}};var sn=tc;var Cr="albedo_session_",nn={};function Si(){return window.sessionStorage}var on=!0;function rc(i){let e=new sn(i);on?Si().setItem(Cr+e.pubkey,JSON.stringify(e)):nn[e.pubkey]=e}function ic(i){let e;if(!on)e=nn[i];else{let r=Si().getItem(Cr+i);r&&(e=new sn(JSON.parse(r)))}return e?e.isExpired?(an(i),null):e:null}function Di(i,e){let r=ic(e);return!r||!r.grants.includes(i)?null:r}function sc(){let i=Si();return Object.keys(i).filter(e=>e.indexOf(Cr)===0).map(e=>ic(e.substr(Cr.length))).filter(e=>!!e)}function an(i){on?Si().removeItem(Cr+i):delete nn[i]}function Pr(i){return Object.assign(new Error,Ht.invalidIntentRequest,{ext:i})}function nc(i,e){try{let{intent:r}=i;if(!r)throw Pr('Parameter "intent" is required.');let t=xi[r];if(!t)throw Pr(`Unknown intent: "${r}".`);let s=$d(t,i);return Vd(s,e).then(n=>zd(s,n))}catch(r){let{code:t=-1,message:s,ext:n}=r,o={message:s,code:t};return n&&(o.ext=n),Promise.reject(o)}}function Vd(i,e){if(i.pubkey){let r=Di(i.intent,i.pubkey);if(r)return i.session=r.key,rn(e)}return setTimeout(()=>{i.intent==="implicit_flow"&&rn(e)},200),ec(e)}function zd(i,e){return e.postMessage(i).then(r=>(r.intent==="implicit_flow"&&r.granted&&rc(r),r))}function $d(i,e){if(typeof e!="object")throw Pr("Intent parameters expected.");let{intent:r,pubkey:t}=e,s={intent:r};if(t&&!/^G[0-9A-Z]{55}$/.test(t))throw Pr('Invalid "pubkey" parameter. Stellar account public key expected.');for(let n in i.params){let o=i.params[n],a=e[n];if(a)s[n]=a;else if(o.required)throw Pr(`Parameter "${n}" is required for intent "${r}".`)}return s}function Gd(i=null){i===null&&(i=window.location.search),i[0]==="?"&&(i=i.substr(1));let e={};for(let r of i.split("&")){let[t,s]=r.split("=").map(n=>decodeURIComponent(n));e[t]=s}return e}function oc(i){typeof document>"u"||!document.addEventListener||document.addEventListener("click",function(r){if(r.target.tagName!=="A"||(r.target.href||"").indexOf("web+stellar:")!==0)return;r.preventDefault(),r.stopImmediatePropagation();let{pathname:t,search:s}=new URL(r.target.href);if(!["tx","pay"].includes(t)){alert(`Invalid operation requested: ${t}. It's likely an external application error. Please contact support team of ${window.location.origin}.`);return}let n=Gd(s);i.request(t,n)},!1)}if(typeof window=="object"&&typeof window.fetch!="function")throw new Error("Browser FetchAPI is not available. For legacy browsers support use polyfills such as whatwg-fetch.");function ac(){}ac.prototype={frontendUrl:"https://albedo.link",intentInterface:xi,intentErrors:Ht,request(i,e){return nc(Object.assign(e||{},{intent:i}),this.frontendUrl)},implicitFlow(i){return this.request("implicit_flow",i)},publicKey(i){return i=Object.assign({},i),i.token||(i.token=Nr()),this.request("public_key",i)},tx(i){return this.request("tx",i)},batch(i){return this.request("batch",i)},pay(i){return this.request("pay",i)},trust(i){return this.request("trust",i)},exchange(i){return this.request("exchange",i)},signMessage(i){return i=Object.assign({},i,{message:Wd(i.message)}),this.request("sign_message",i)},manageAccount(i){return this.request("manage_account",i)},generateRandomToken(){return Nr()},isImplicitSessionAllowed(i,e){return!!Di(i,e)},listImplicitSessions(){return sc()},forgetImplicitSession(i){an(i)}};function Wd(i){switch(typeof i){case"string":return i;case"undefined":return""}return JSON.stringify(i)}var Ii=new ac;Ii.default=Ii;oc(Ii);var cn=Ii;var Oi=oe(Zs()),Kt=class{name;network;constructor(e,r){this.name=e,this.network=r}async getPublicKey(){let{name:e}=this;try{if(e==="albedo")return await this.getAlbedoKey();if(e==="rabet")return await this.getRabetKey();if(e==="freighter")return await this.getFreighterKey();if(e==="wallet_connect")return await this.getFreighterKey()}catch(r){console.log(r)}}async signTransaction(e,r=!1){let{name:t}=this;try{if(t==="albedo")return await this.signAlbedo(e,r);if(t==="rabet")return await this.signRabet(e,r);if(t==="freighter")return await this.signFreighter(e,r);if(t==="wallet_connect")return await this.signFreighter(e,r)}catch(s){console.log(s)}}async submitTx(e){let{network:r}=this,t=encodeURIComponent(e);return await(await fetch("https://horizon-testnet.stellar.org/transactions/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:`tx=${t}`})).json()}async signAlbedo(e,r){let{network:t}=this,{signed_envelope_xdr:s}=await cn.tx({xdr:e,network:t,submit:!1});return r?{horizonResult:await this.submitTx(s)}:{xdr:e,signed_envelope_xdr:s}}async signFreighter(e,r){let{network:t}=this,s=await(0,Oi.signTransaction)(e,{network:t});return r?{horizonResult:await this.submitTx(s)}:{xdr:e,signed_envelope_xdr:s}}async signRabet(e,r){let{network:t}=this,s=window;if(s.rabet){let{xdr:n}=await s.rabet.sign(e,t);return r?{horizonResult:await this.submitTx(n)}:{xdr:e,signed_envelope_xdr:n}}}async signXBull(){}async getAlbedoKey(){return await cn.publicKey({})}async getXBullKey(){}async getRabetKey(){let e=window;if(e.rabet)return e.rabet.connect()}async getFreighterKey(){return async()=>{try{return await(0,Oi.getPublicKey)()}catch(e){console.log(e)}}}};var Od=oe(Ai());xt();var Pa=oe(Ai()),ld=oe(Ic()),Dr=oe(Vc()),ce=oe(Nn());_n();xt();var $i=class extends $e{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}};var Gi=class extends $e{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}},Wi=class{constructor(e,r){this.logger=e,this.core=r}},Ji=class extends $e{constructor(e,r){super(),this.relayer=e,this.logger=r}},Yi=class extends $e{constructor(e){super()}},Xi=class{constructor(e,r,t,s){this.core=e,this.logger=r,this.name=t}};var Qi=class extends $e{constructor(e,r){super(),this.relayer=e,this.logger=r}};var Zi=class extends $e{constructor(e,r){super(),this.core=e,this.logger=r}};var es=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}};var ts=class{constructor(e){this.client=e}};var eg=i=>JSON.stringify(i,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),tg=i=>{let e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=i.replace(e,'$1"$2n"$3');return JSON.parse(r,(t,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Hr(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return tg(i)}catch{return i}}function tr(i){return typeof i=="string"?i:eg(i)||""}var Xr=oe(Tu()),ol=oe(Kr()),al=oe(Dt());var Ru="EdDSA",Au="JWT",Jn=".",Yn="base64url",Nu="utf8",Cu="utf8",Pu=":",Lu="did",Uu="key",Xn="base58btc",Fu="z",Mu="K36";function At(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function $r(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?At(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function or(i,e){e||(e=i.reduce((s,n)=>s+n.length,0));let r=$r(e),t=0;for(let s of i)r.set(s,t),t+=s.length;return At(r)}var ro={};ve(ro,{identity:()=>rm});function Xg(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),t=0;t<r.length;t++)r[t]=255;for(var s=0;s<i.length;s++){var n=i.charAt(s),o=n.charCodeAt(0);if(r[o]!==255)throw new TypeError(n+" is ambiguous");r[o]=s}var a=i.length,c=i.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var y=0,b=0,_=0,S=f.length;_!==S&&f[_]===0;)_++,y++;for(var E=(S-_)*h+1>>>0,w=new Uint8Array(E);_!==S;){for(var D=f[_],T=0,d=E-1;(D!==0||T<b)&&d!==-1;d--,T++)D+=256*w[d]>>>0,w[d]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");b=T,_++}for(var g=E-b;g!==E&&w[g]===0;)g++;for(var R=c.repeat(y);g<E;++g)R+=i.charAt(w[g]);return R}function m(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var y=0;if(f[y]!==" "){for(var b=0,_=0;f[y]===c;)b++,y++;for(var S=(f.length-y)*u+1>>>0,E=new Uint8Array(S);f[y];){var w=r[f.charCodeAt(y)];if(w===255)return;for(var D=0,T=S-1;(w!==0||D<_)&&T!==-1;T--,D++)w+=a*E[T]>>>0,E[T]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");_=D,y++}if(f[y]!==" "){for(var d=S-_;d!==S&&E[d]===0;)d++;for(var g=new Uint8Array(b+(S-d)),R=b;d!==S;)g[R++]=E[d++];return g}}}function p(f){var y=m(f);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:m,decode:p}}var Qg=Xg,Zg=Qg,qu=Zg;var Mv=new Uint8Array(0);var ju=(i,e)=>{if(i===e)return!0;if(i.byteLength!==e.byteLength)return!1;for(let r=0;r<i.byteLength;r++)if(i[r]!==e[r])return!1;return!0},tt=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")};var ku=i=>new TextEncoder().encode(i),Bu=i=>new TextDecoder().decode(i);var Qn=class{constructor(e,r,t){this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Zn=class{constructor(e,r,t){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=t}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ku(this,e)}},eo=class{constructor(e){this.decoders=e}or(e){return Ku(this,e)}decode(e){let r=e[0],t=this.decoders[r];if(t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ku=(i,e)=>new eo({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}}),to=class{constructor(e,r,t,s){this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=s,this.encoder=new Qn(e,r,t),this.decoder=new Zn(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ar=({name:i,prefix:e,encode:r,decode:t})=>new to(i,e,r,t),ft=({prefix:i,name:e,alphabet:r})=>{let{encode:t,decode:s}=qu(r,e);return ar({prefix:i,name:e,encode:t,decode:n=>tt(s(n))})},em=(i,e,r,t)=>{let s={};for(let h=0;h<e.length;++h)s[e[h]]=h;let n=i.length;for(;i[n-1]==="=";)--n;let o=new Uint8Array(n*r/8|0),a=0,c=0,u=0;for(let h=0;h<n;++h){let l=s[i[h]];if(l===void 0)throw new SyntaxError(`Non-${t} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},tm=(i,e,r)=>{let t=e[e.length-1]==="=",s=(1<<r)-1,n="",o=0,a=0;for(let c=0;c<i.length;++c)for(a=a<<8|i[c],o+=8;o>r;)o-=r,n+=e[s&a>>o];if(o&&(n+=e[s&a<<r-o]),t)for(;n.length*r&7;)n+="=";return n},de=({name:i,prefix:e,bitsPerChar:r,alphabet:t})=>ar({prefix:e,name:i,encode(s){return tm(s,t,r)},decode(s){return em(s,t,r,i)}});var rm=ar({prefix:"\0",name:"identity",encode:i=>Bu(i),decode:i=>ku(i)});var io={};ve(io,{base2:()=>im});var im=de({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var so={};ve(so,{base8:()=>sm});var sm=de({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var no={};ve(no,{base10:()=>nm});var nm=ft({prefix:"9",name:"base10",alphabet:"0123456789"});var oo={};ve(oo,{base16:()=>om,base16upper:()=>am});var om=de({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),am=de({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ao={};ve(ao,{base32:()=>cr,base32hex:()=>hm,base32hexpad:()=>dm,base32hexpadupper:()=>pm,base32hexupper:()=>fm,base32pad:()=>um,base32padupper:()=>lm,base32upper:()=>cm,base32z:()=>gm});var cr=de({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cm=de({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),um=de({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lm=de({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hm=de({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),fm=de({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dm=de({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pm=de({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gm=de({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var co={};ve(co,{base36:()=>mm,base36upper:()=>ym});var mm=ft({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ym=ft({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var uo={};ve(uo,{base58btc:()=>Ge,base58flickr:()=>bm});var Ge=ft({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),bm=ft({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var lo={};ve(lo,{base64:()=>wm,base64pad:()=>_m,base64url:()=>Em,base64urlpad:()=>vm});var wm=de({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_m=de({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Em=de({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vm=de({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ho={};ve(ho,{base256emoji:()=>Om});var Vu=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),xm=Vu.reduce((i,e,r)=>(i[r]=e,i),[]),Sm=Vu.reduce((i,e,r)=>(i[e.codePointAt(0)]=r,i),[]);function Dm(i){return i.reduce((e,r)=>(e+=xm[r],e),"")}function Im(i){let e=[];for(let r of i){let t=Sm[r.codePointAt(0)];if(t===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}var Om=ar({prefix:"\u{1F680}",name:"base256emoji",encode:Dm,decode:Im});var mo={};ve(mo,{sha256:()=>$m,sha512:()=>Gm});var Tm=Gu,zu=128,Rm=127,Am=~Rm,Nm=Math.pow(2,31);function Gu(i,e,r){e=e||[],r=r||0;for(var t=r;i>=Nm;)e[r++]=i&255|zu,i/=128;for(;i&Am;)e[r++]=i&255|zu,i>>>=7;return e[r]=i|0,Gu.bytes=r-t+1,e}var Cm=fo,Pm=128,$u=127;function fo(i,t){var r=0,t=t||0,s=0,n=t,o,a=i.length;do{if(n>=a)throw fo.bytes=0,new RangeError("Could not decode varint");o=i[n++],r+=s<28?(o&$u)<<s:(o&$u)*Math.pow(2,s),s+=7}while(o>=Pm);return fo.bytes=n-t,r}var Lm=Math.pow(2,7),Um=Math.pow(2,14),Fm=Math.pow(2,21),Mm=Math.pow(2,28),qm=Math.pow(2,35),jm=Math.pow(2,42),km=Math.pow(2,49),Bm=Math.pow(2,56),Hm=Math.pow(2,63),Km=function(i){return i<Lm?1:i<Um?2:i<Fm?3:i<Mm?4:i<qm?5:i<jm?6:i<km?7:i<Bm?8:i<Hm?9:10},Vm={encode:Tm,decode:Cm,encodingLength:Km},zm=Vm,Gr=zm;var Wr=(i,e=0)=>[Gr.decode(i,e),Gr.decode.bytes],ur=(i,e,r=0)=>(Gr.encode(i,e,r),e),lr=i=>Gr.encodingLength(i);var Nt=(i,e)=>{let r=e.byteLength,t=lr(i),s=t+lr(r),n=new Uint8Array(s+r);return ur(i,n,0),ur(r,n,t),n.set(e,s),new hr(i,r,e,n)},Wu=i=>{let e=tt(i),[r,t]=Wr(e),[s,n]=Wr(e.subarray(t)),o=e.subarray(t+n);if(o.byteLength!==s)throw new Error("Incorrect length");return new hr(r,s,o,e)},Ju=(i,e)=>i===e?!0:i.code===e.code&&i.size===e.size&&ju(i.bytes,e.bytes),hr=class{constructor(e,r,t,s){this.code=e,this.size=r,this.digest=t,this.bytes=s}};var go=({name:i,code:e,encode:r})=>new po(i,e,r),po=class{constructor(e,r,t){this.name=e,this.code=r,this.encode=t}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Nt(this.code,r):r.then(t=>Nt(this.code,t))}else throw Error("Unknown type, must be binary type")}};var Xu=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),$m=go({name:"sha2-256",code:18,encode:Xu("SHA-256")}),Gm=go({name:"sha2-512",code:19,encode:Xu("SHA-512")});var yo={};ve(yo,{identity:()=>Ym});var Qu=0,Wm="identity",Zu=tt,Jm=i=>Nt(Qu,Zu(i)),Ym={code:Qu,name:Wm,encode:Zu,digest:Jm};var sx=new TextEncoder,nx=new TextDecoder;var we=class{constructor(e,r,t,s){this.code=r,this.version=e,this.multihash=t,this.bytes=s,this.byteOffset=s.byteOffset,this.byteLength=s.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ls,byteLength:ls,code:us,version:us,multihash:us,bytes:us,_baseCache:ls,asCID:ls})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Yr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==ry)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return we.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,t=Nt(e,r);return we.createV1(this.code,t)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ju(this.multihash,e.multihash)}toString(e){let{bytes:r,version:t,_baseCache:s}=this;switch(t){case 0:return ey(r,s,e||Ge.encoder);default:return ty(r,s,e||cr.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return sy(/^0\.0/,ny),!!(e&&(e[tl]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof we)return e;if(e!=null&&e.asCID===e){let{version:r,code:t,multihash:s,bytes:n}=e;return new we(r,t,s,n||el(r,t,s.bytes))}else if(e!=null&&e[tl]===!0){let{version:r,multihash:t,code:s}=e,n=Wu(t);return we.create(r,s,n)}else return null}static create(e,r,t){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Yr)throw new Error(`Version 0 CID must use dag-pb (code: ${Yr}) block encoding`);return new we(e,r,t,t.bytes)}case 1:{let s=el(e,r,t.bytes);return new we(e,r,t,s)}default:throw new Error("Invalid version")}}static createV0(e){return we.create(0,Yr,e)}static createV1(e,r){return we.create(1,e,r)}static decode(e){let[r,t]=we.decodeFirst(e);if(t.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=we.inspectBytes(e),t=r.size-r.multihashSize,s=tt(e.subarray(t,t+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let n=s.subarray(r.multihashSize-r.digestSize),o=new hr(r.multihashCode,r.digestSize,n,s);return[r.version===0?we.createV0(o):we.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,t=()=>{let[l,m]=Wr(e.subarray(r));return r+=m,l},s=t(),n=Yr;if(s===18?(s=0,r=0):s===1&&(n=t()),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=t(),c=t(),u=r+c,h=u-o;return{version:s,codec:n,multihashCode:a,digestSize:c,multihashSize:h,size:u}}static parse(e,r){let[t,s]=Zm(e,r),n=we.decode(s);return n._baseCache.set(t,e),n}},Zm=(i,e)=>{switch(i[0]){case"Q":{let r=e||Ge;return[Ge.prefix,r.decode(`${Ge.prefix}${i}`)]}case Ge.prefix:{let r=e||Ge;return[Ge.prefix,r.decode(i)]}case cr.prefix:{let r=e||cr;return[cr.prefix,r.decode(i)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[i[0],e.decode(i)]}}},ey=(i,e,r)=>{let{prefix:t}=r;if(t!==Ge.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=e.get(t);if(s==null){let n=r.encode(i).slice(1);return e.set(t,n),n}else return s},ty=(i,e,r)=>{let{prefix:t}=r,s=e.get(t);if(s==null){let n=r.encode(i);return e.set(t,n),n}else return s},Yr=112,ry=18,el=(i,e,r)=>{let t=lr(i),s=t+lr(e),n=new Uint8Array(s+r.byteLength);return ur(i,n,0),ur(e,n,t),n.set(r,s),n},tl=Symbol.for("@ipld/js-cid/CID"),us={writable:!1,configurable:!1,enumerable:!0},ls={writable:!1,enumerable:!1,configurable:!1},iy="0.0.0-dev",sy=(i,e)=>{if(i.test(iy))console.warn(e);else throw new Error(e)},ny=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var bo={...ro,...io,...so,...no,...oo,...ao,...co,...uo,...lo,...ho},dx={...mo,...yo};function il(i,e,r,t){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:r},decoder:{decode:t}}}var rl=il("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),wo=il("ascii","a",i=>{let e="a";for(let r=0;r<i.length;r++)e+=String.fromCharCode(i[r]);return e},i=>{i=i.substring(1);let e=$r(i.length);for(let r=0;r<i.length;r++)e[r]=i.charCodeAt(r);return e}),oy={utf8:rl,"utf-8":rl,hex:bo.base16,latin1:wo,ascii:wo,binary:wo,...bo},hs=oy;function _e(i,e="utf8"){let r=hs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):r.encoder.encode(i).substring(1)}function xe(i,e="utf8"){let r=hs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?At(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}function fs(i){return _e(xe(tr(i),Nu),Yn)}function ds(i){let e=xe(Mu,Xn),r=Fu+_e(or([e,i]),Xn);return[Lu,Uu,r].join(Pu)}function ay(i){return _e(i,Yn)}function sl(i){return xe([fs(i.header),fs(i.payload)].join(Jn),Cu)}function nl(i){return[fs(i.header),fs(i.payload),ay(i.signature)].join(Jn)}function _o(i=(0,ol.randomBytes)(32)){return Xr.generateKeyPairFromSeed(i)}async function cl(i,e,r,t,s=(0,al.fromMiliseconds)(Date.now())){let n={alg:Ru,typ:Au},o=ds(t.publicKey),a=s+r,c={iss:o,sub:i,aud:e,iat:s,exp:a},u=sl({header:n,payload:c}),h=Xr.sign(t.secretKey,u);return nl({header:n,payload:c,signature:h})}var Co=oe(ml()),lh=oe(vl()),Po=oe(Kr()),ii=oe(Sl()),xs=oe(Tl());var Rl=function(i,e,r){if(r||arguments.length===2)for(var t=0,s=e.length,n;t<s;t++)(n||!(t in e))&&(n||(n=Array.prototype.slice.call(e,0,t)),n[t]=e[t]);return i.concat(n||Array.prototype.slice.call(e))},qy=function(){function i(e,r,t){this.name=e,this.version=r,this.os=t,this.type="browser"}return i}();var jy=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return i}();var ky=function(){function i(e,r,t,s){this.name=e,this.version=r,this.os=t,this.bot=s,this.type="bot-device"}return i}();var By=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}();var Hy=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}();var Ky=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Vy=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Al=3,zy=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Ky]],Nl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Pl(i){return i?Cl(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Hy:typeof navigator<"u"?Cl(navigator.userAgent):Wy()}function $y(i){return i!==""&&zy.reduce(function(e,r){var t=r[0],s=r[1];if(e)return e;var n=s.exec(i);return!!n&&[t,n]},!1)}function Cl(i){var e=$y(i);if(!e)return null;var r=e[0],t=e[1];if(r==="searchbot")return new By;var s=t[1]&&t[1].split(".").join("_").split("_").slice(0,3);s?s.length<Al&&(s=Rl(Rl([],s,!0),Jy(Al-s.length),!0)):s=[];var n=s.join("."),o=Gy(i),a=Vy.exec(i);return a&&a[1]?new ky(r,n,o,a[1]):new qy(r,n,o)}function Gy(i){for(var e=0,r=Nl.length;e<r;e++){var t=Nl[e],s=t[0],n=t[1],o=n.exec(i);if(o)return s}return null}function Wy(){var i=typeof process<"u"&&process.version;return i?new jy(process.version.slice(1)):null}function Jy(i){for(var e=[],r=0;r<i;r++)e.push("0");return e}var ot=oe(Dt()),Lt=oe(Oo()),hh=oe(Ul()),pr=oe(eh());var th={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function fh(i,e){return i.includes(":")?[i]:e.chains||[]}var dh="base10",Te="base16",Ao="base64pad",Lo="utf8",ph=0,at=1,m0=0,rh=1,No=12,Uo=32;function gh(){let i=xs.generateKeyPair();return{privateKey:_e(i.secretKey,Te),publicKey:_e(i.publicKey,Te)}}function Ss(){let i=(0,Po.randomBytes)(Uo);return _e(i,Te)}function mh(i,e){let r=xs.sharedKey(xe(i,Te),xe(e,Te)),t=new lh.HKDF(ii.SHA256,r).expand(Uo);return _e(t,Te)}function yh(i){let e=(0,ii.hash)(xe(i,Te));return _e(e,Te)}function si(i){let e=(0,ii.hash)(xe(i,Lo));return _e(e,Te)}function y0(i){return xe(`${i}`,dh)}function gr(i){return Number(_e(i,dh))}function bh(i){let e=y0(typeof i.type<"u"?i.type:ph);if(gr(e)===at&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");let r=typeof i.senderPublicKey<"u"?xe(i.senderPublicKey,Te):void 0,t=typeof i.iv<"u"?xe(i.iv,Te):(0,Po.randomBytes)(No),s=new Co.ChaCha20Poly1305(xe(i.symKey,Te)).seal(t,xe(i.message,Lo));return b0({type:e,sealed:s,iv:t,senderPublicKey:r})}function wh(i){let e=new Co.ChaCha20Poly1305(xe(i.symKey,Te)),{sealed:r,iv:t}=ni(i.encoded),s=e.open(t,r);if(s===null)throw new Error("Failed to decrypt");return _e(s,Lo)}function b0(i){if(gr(i.type)===at){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return _e(or([i.type,i.senderPublicKey,i.iv,i.sealed]),Ao)}return _e(or([i.type,i.iv,i.sealed]),Ao)}function ni(i){let e=xe(i,Ao),r=e.slice(m0,rh),t=rh;if(gr(r)===at){let a=t+Uo,c=a+No,u=e.slice(t,a),h=e.slice(a,c),l=e.slice(c);return{type:r,sealed:l,iv:h,senderPublicKey:u}}let s=t+No,n=e.slice(t,s),o=e.slice(s);return{type:r,sealed:o,iv:n}}function _h(i,e){let r=ni(i);return Fo({type:gr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?_e(r.senderPublicKey,Te):void 0,receiverPublicKey:e?.receiverPublicKey})}function Fo(i){let e=i?.type||ph;if(e===at){if(typeof i?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof i?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i?.senderPublicKey,receiverPublicKey:i?.receiverPublicKey}}function Mo(i){return i.type===at&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var w0=Object.defineProperty,ih=Object.getOwnPropertySymbols,_0=Object.prototype.hasOwnProperty,E0=Object.prototype.propertyIsEnumerable,sh=(i,e,r)=>e in i?w0(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,nh=(i,e)=>{for(var r in e||(e={}))_0.call(e,r)&&sh(i,r,e[r]);if(ih)for(var r of ih(e))E0.call(e,r)&&sh(i,r,e[r]);return i},v0="ReactNative",ri={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};var x0="js";function Eh(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function S0(){return!(0,Lt.getDocument)()&&!!(0,Lt.getNavigator)()&&navigator.product===v0}function D0(){return!Eh()&&!!(0,Lt.getNavigator)()}function I0(){return S0()?ri.reactNative:Eh()?ri.node:D0()?ri.browser:ri.unknown}function O0(i,e){let r=pr.parse(i);return r=nh(nh({},r),e),i=pr.stringify(r),i}function vh(){return(0,hh.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function T0(){let i=Pl();if(i===null)return"unknown";let e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function R0(){var i;let e=I0();return e===ri.browser?[e,((i=(0,Lt.getLocation)())==null?void 0:i.host)||"unknown"].join(":"):e}function A0(i,e,r){let t=T0(),s=R0();return[[i,e].join("-"),[x0,r].join("-"),t,s].join("/")}function xh({protocol:i,version:e,relayUrl:r,sdkVersion:t,auth:s,projectId:n,useOnCloseEvent:o}){let a=r.split("?"),c=A0(i,e,t),u={auth:s,ua:c,projectId:n,useOnCloseEvent:o||void 0},h=O0(a[1]||"",u);return a[0]+"?"+h}function Pt(i,e){return i.filter(r=>e.includes(r)).length===i.length}function qo(i){return Object.fromEntries(i.entries())}function jo(i){return new Map(Object.entries(i))}function pt(i=ot.FIVE_MINUTES,e){let r=(0,ot.toMiliseconds)(i||ot.FIVE_MINUTES),t,s,n;return{resolve:o=>{n&&t&&(clearTimeout(n),t(o))},reject:o=>{n&&s&&(clearTimeout(n),s(o))},done:()=>new Promise((o,a)=>{n=setTimeout(()=>{a(new Error(e))},r),t=o,s=a})}}function oi(i,e,r){return new Promise(async(t,s)=>{let n=setTimeout(()=>s(new Error(r)),e);try{let o=await i;t(o)}catch(o){s(o)}clearTimeout(n)})}function Sh(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function Dh(i){return Sh("topic",i)}function Ih(i){return Sh("id",i)}function Ds(i){let[e,r]=i.split(":"),t={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")t.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))t.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return t}function He(i,e){return(0,ot.fromMiliseconds)((e||Date.now())+(0,ot.toMiliseconds)(i))}function Ye(i){return Date.now()>=(0,ot.toMiliseconds)(i)}function ge(i,e){return`${i}${e?`:${e}`:""}`}var N0="irn";function Is(i){return i?.relay||{protocol:N0}}function ai(i){let e=th[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var C0=Object.defineProperty,oh=Object.getOwnPropertySymbols,P0=Object.prototype.hasOwnProperty,L0=Object.prototype.propertyIsEnumerable,ah=(i,e,r)=>e in i?C0(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,U0=(i,e)=>{for(var r in e||(e={}))P0.call(e,r)&&ah(i,r,e[r]);if(oh)for(var r of oh(e))L0.call(e,r)&&ah(i,r,e[r]);return i};function F0(i,e="-"){let r={},t="relay"+e;return Object.keys(i).forEach(s=>{if(s.startsWith(t)){let n=s.replace(t,""),o=i[s];r[n]=o}}),r}function Oh(i){let e=i.indexOf(":"),r=i.indexOf("?")!==-1?i.indexOf("?"):void 0,t=i.substring(0,e),s=i.substring(e+1,r).split("@"),n=typeof r<"u"?i.substring(r):"",o=pr.parse(n);return{protocol:t,topic:s[0],version:parseInt(s[1],10),symKey:o.symKey,relay:F0(o)}}function M0(i,e="-"){let r="relay",t={};return Object.keys(i).forEach(s=>{let n=r+e+s;i[s]&&(t[n]=i[s])}),t}function Th(i){return`${i.protocol}:${i.topic}@${i.version}?`+pr.stringify(U0({symKey:i.symKey},M0(i.relay)))}function mr(i){let e=[];return i.forEach(r=>{let[t,s]=r.split(":");e.push(`${t}:${s}`)}),e}function q0(i){let e=[];return Object.values(i).forEach(r=>{e.push(...mr(r.accounts))}),e}function j0(i,e){let r=[];return Object.values(i).forEach(t=>{mr(t.accounts).includes(e)&&r.push(...t.methods)}),r}function k0(i,e){let r=[];return Object.values(i).forEach(t=>{mr(t.accounts).includes(e)&&r.push(...t.events)}),r}function Rh(i,e){let r=ci(i,e);if(r)throw new Error(r.message);let t={};for(let[s,n]of Object.entries(i))t[s]={methods:n.methods,events:n.events,chains:n.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return t}var B0={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},H0={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function C(i,e){let{message:r,code:t}=H0[i];return{message:e?`${r} ${e}`:r,code:t}}function ye(i,e){let{message:r,code:t}=B0[i];return{message:e?`${r} ${e}`:r,code:t}}function yr(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function br(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function Se(i){return typeof i>"u"}function be(i,e){return e&&Se(i)?!0:typeof i=="string"&&Boolean(i.trim().length)}function ko(i,e){return e&&Se(i)?!0:typeof i=="number"&&!isNaN(i)}function Ah(i,e){let{requiredNamespaces:r}=e,t=Object.keys(i.namespaces),s=Object.keys(r),n=!0;return Pt(s,t)?(t.forEach(o=>{let{accounts:a,methods:c,events:u}=i.namespaces[o],h=mr(a),l=r[o];(!Pt(fh(o,l),h)||!Pt(l.methods,c)||!Pt(l.events,u))&&(n=!1)}),n):!1}function Bo(i){return be(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function K0(i){if(be(i,!1)&&i.includes(":")){let e=i.split(":");if(e.length===3){let r=e[0]+":"+e[1];return!!e[2]&&Bo(r)}}return!1}function Nh(i){if(be(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function Ch(i){var e;return(e=i?.proposer)==null?void 0:e.publicKey}function Ph(i){return i?.topic}function Lh(i,e){let r=null;return be(i?.publicKey,!1)||(r=C("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function ch(i){let e=!0;return yr(i)?i.length&&(e=i.every(r=>be(r,!1))):e=!1,e}function V0(i,e,r){let t=null;return yr(e)?e.forEach(s=>{t||(!Bo(s)||!s.includes(i))&&(t=ye("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):t=ye("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),t}function z0(i,e){let r=null;return Object.entries(i).forEach(([t,s])=>{if(r)return;let n=V0(t,fh(t,s),`${e} requiredNamespace`);n&&(r=n)}),r}function $0(i,e){let r=null;return yr(i)?i.forEach(t=>{r||K0(t)||(r=ye("UNSUPPORTED_ACCOUNTS",`${e}, account ${t} should be a string and conform to "namespace:chainId:address" format`))}):r=ye("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function G0(i,e){let r=null;return Object.values(i).forEach(t=>{if(r)return;let s=$0(t?.accounts,`${e} namespace`);s&&(r=s)}),r}function W0(i,e){let r=null;return ch(i?.methods)?ch(i?.events)||(r=ye("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=ye("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Uh(i,e){let r=null;return Object.values(i).forEach(t=>{if(r)return;let s=W0(t,`${e}, namespace`);s&&(r=s)}),r}function Fh(i,e,r){let t=null;if(i&&br(i)){let s=Uh(i,e);s&&(t=s);let n=z0(i,e);n&&(t=n)}else t=C("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return t}function ci(i,e){let r=null;if(i&&br(i)){let t=Uh(i,e);t&&(r=t);let s=G0(i,e);s&&(r=s)}else r=C("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Ho(i){return be(i.protocol,!0)}function Mh(i,e){let r=!1;return e&&!i?r=!0:i&&yr(i)&&i.length&&i.forEach(t=>{r=Ho(t)}),r}function qh(i){return typeof i=="number"}function Re(i){return typeof i<"u"&&typeof i!==null}function jh(i){return!(!i||typeof i!="object"||!i.code||!ko(i.code,!1)||!i.message||!be(i.message,!1))}function kh(i){return!(Se(i)||!be(i.method,!1))}function Bh(i){return!(Se(i)||Se(i.result)&&Se(i.error)||!ko(i.id,!1)||!be(i.jsonrpc,!1))}function Hh(i){return!(Se(i)||!be(i.name,!1))}function Ko(i,e){return!(!Bo(e)||!q0(i).includes(e))}function Kh(i,e,r){return be(r,!1)?j0(i,e).includes(r):!1}function Vh(i,e,r){return be(r,!1)?k0(i,e).includes(r):!1}function Vo(i,e,r){let t=null,s=J0(i),n=Y0(e),o=Object.keys(s),a=Object.keys(n),c=uh(Object.keys(i)),u=uh(Object.keys(e)),h=c.filter(l=>!u.includes(l));return h.length&&(t=C("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${h.toString()}
      Received: ${Object.keys(e).toString()}`)),Pt(o,a)||(t=C("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(l=>{if(!l.includes(":")||t)return;let m=mr(e[l].accounts);m.includes(l)||(t=C("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${l}
        Required: ${l}
        Approved: ${m.toString()}`))}),o.forEach(l=>{t||(Pt(s[l].methods,n[l].methods)?Pt(s[l].events,n[l].events)||(t=C("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${l}`)):t=C("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${l}`))}),t}function J0(i){let e={};return Object.keys(i).forEach(r=>{var t;r.includes(":")?e[r]=i[r]:(t=i[r].chains)==null||t.forEach(s=>{e[s]={methods:i[r].methods,events:i[r].events}})}),e}function uh(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Y0(i){let e={};return Object.keys(i).forEach(r=>{r.includes(":")?e[r]=i[r]:mr(i[r].accounts)?.forEach(s=>{e[s]={accounts:i[r].accounts.filter(n=>n.includes(`${s}:`)),methods:i[r].methods,events:i[r].events}})}),e}function zh(i,e){return ko(i,!1)&&i<=e.max&&i>=e.min}var fe=oe(Dt());xt();var Ae={};ve(Ae,{DEFAULT_ERROR:()=>li,IBaseJsonRpcProvider:()=>Us,IEvents:()=>_r,IJsonRpcConnection:()=>Xo,IJsonRpcProvider:()=>hi,INTERNAL_ERROR:()=>Os,INVALID_PARAMS:()=>Jh,INVALID_REQUEST:()=>Gh,METHOD_NOT_FOUND:()=>Wh,PARSE_ERROR:()=>$h,RESERVED_ERROR_CODES:()=>zo,SERVER_ERROR:()=>ui,SERVER_ERROR_CODE_RANGE:()=>Ts,STANDARD_ERROR_MAP:()=>gt,formatErrorMessage:()=>of,formatJsonRpcError:()=>Ut,formatJsonRpcRequest:()=>bt,formatJsonRpcResult:()=>wr,getBigIntRpcId:()=>Yo,getError:()=>As,getErrorByCode:()=>Ns,isHttpUrl:()=>ab,isJsonRpcError:()=>Pe,isJsonRpcPayload:()=>Zo,isJsonRpcRequest:()=>Er,isJsonRpcResponse:()=>Ft,isJsonRpcResult:()=>Ke,isJsonRpcValidationInvalid:()=>cb,isLocalhostUrl:()=>Qo,isNodeJs:()=>nf,isReservedErrorCode:()=>Rs,isServerErrorCode:()=>X0,isValidDefaultRoute:()=>Ps,isValidErrorCode:()=>Yh,isValidLeadingWildcardRoute:()=>rb,isValidRoute:()=>tb,isValidTrailingWildcardRoute:()=>ib,isValidWildcardRoute:()=>Ls,isWsUrl:()=>Fs,parseConnectionError:()=>$o,payloadId:()=>Jo,validateJsonRpcError:()=>Q0});var $h="PARSE_ERROR",Gh="INVALID_REQUEST",Wh="METHOD_NOT_FOUND",Jh="INVALID_PARAMS",Os="INTERNAL_ERROR",ui="SERVER_ERROR",zo=[-32700,-32600,-32601,-32602,-32603],Ts=[-32e3,-32099],gt={[$h]:{code:-32700,message:"Parse error"},[Gh]:{code:-32600,message:"Invalid Request"},[Wh]:{code:-32601,message:"Method not found"},[Jh]:{code:-32602,message:"Invalid params"},[Os]:{code:-32603,message:"Internal error"},[ui]:{code:-32e3,message:"Server error"}},li=ui;function X0(i){return i<=Ts[0]&&i>=Ts[1]}function Rs(i){return zo.includes(i)}function Yh(i){return typeof i=="number"}function As(i){return Object.keys(gt).includes(i)?gt[i]:gt[li]}function Ns(i){let e=Object.values(gt).find(r=>r.code===i);return e||gt[li]}function Q0(i){if(typeof i.error.code>"u")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof i.error.message>"u")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!Yh(i.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${i.error.code}`};if(Rs(i.error.code)){let e=Ns(i.error.code);if(e.message!==gt[li].message&&i.error.message===e.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${i.error.code}`}}return{valid:!0}}function $o(i,e,r){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):i}var Ce={};ve(Ce,{isNodeJs:()=>nf});var sf=oe(Wo());Fe(Ce,oe(Wo()));var nf=sf.isNode;Fe(Ae,Ce);function Jo(i=3){let e=Date.now()*Math.pow(10,i),r=Math.floor(Math.random()*Math.pow(10,i));return e+r}function Yo(i=6){return BigInt(Jo(i))}function bt(i,e,r){return{id:r||Jo(),jsonrpc:"2.0",method:i,params:e}}function wr(i,e){return{id:i,jsonrpc:"2.0",result:e}}function Ut(i,e,r){return{id:i,jsonrpc:"2.0",error:of(e,r)}}function of(i,e){return typeof i>"u"?As(Os):(typeof i=="string"&&(i=Object.assign(Object.assign({},As(ui)),{message:i})),typeof e<"u"&&(i.data=e),Rs(i.code)&&(i=Ns(i.code)),i)}function tb(i){return i.includes("*")?Ls(i):!/\W/g.test(i)}function Ps(i){return i==="*"}function Ls(i){return Ps(i)?!0:!(!i.includes("*")||i.split("*").length!==2||i.split("*").filter(e=>e.trim()==="").length!==1)}function rb(i){return!Ps(i)&&Ls(i)&&!i.split("*")[0].trim()}function ib(i){return!Ps(i)&&Ls(i)&&!i.split("*")[1].trim()}var _r=class{};var Xo=class extends _r{constructor(e){super()}},Us=class extends _r{constructor(){super()}},hi=class extends Us{constructor(e){super()}};var sb="^https?:",nb="^wss?:";function ob(i){let e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function af(i,e){let r=ob(i);return typeof r>"u"?!1:new RegExp(e).test(r)}function ab(i){return af(i,sb)}function Fs(i){return af(i,nb)}function Qo(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function Zo(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Er(i){return Zo(i)&&"method"in i}function Ft(i){return Zo(i)&&(Ke(i)||Pe(i))}function Ke(i){return"result"in i}function Pe(i){return"error"in i}function cb(i){return"error"in i&&i.valid===!1}var Ms=class extends hi{constructor(e){super(e),this.events=new W,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(bt(e.method,e.params||[],Yo().toString()),r)}async requestStrict(e,r){return new Promise(async(t,s)=>{if(!this.connection.connected)try{await this.open()}catch(n){s(n)}this.events.on(`${e.id}`,n=>{Pe(n)?s(n.error):t(n.result)});try{await this.connection.send(e,r)}catch(n){s(n)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ft(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};xt();var lf=10,ub=()=>typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:uf(),lb=()=>typeof window<"u",hb=ub(),ea=class{constructor(e){if(this.url=e,this.events=new W,this.registering=!1,!Fs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(tr(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Fs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){let r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((t,s)=>{this.events.once("register_error",n=>{this.resetMaxListeners(),s(n)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));t(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,t)=>{let s=(0,Ae.isReactNative)()?void 0:{rejectUnauthorized:!Qo(e)},n=new hb(e,[],s);lb()?n.onerror=o=>{let a=o;t(this.emitError(a.error))}:n.on("error",o=>{t(this.emitError(o))}),n.onopen=()=>{this.onOpen(n),r(n)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;let r=typeof e.data=="string"?Hr(e.data):e.data;this.events.emit("payload",r)}onError(e,r){let t=this.parseError(r),s=t.message||t.toString(),n=Ut(e,s);this.events.emit("payload",n)}parseError(e,r=this.url){return $o(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>lf&&this.events.setMaxListeners(lf)}emitError(e){let r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}},hf=ea;var ff=hf;var hd=oe(fa());function Hw(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),t=0;t<r.length;t++)r[t]=255;for(var s=0;s<i.length;s++){var n=i.charAt(s),o=n.charCodeAt(0);if(r[o]!==255)throw new TypeError(n+" is ambiguous");r[o]=s}var a=i.length,c=i.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var y=0,b=0,_=0,S=f.length;_!==S&&f[_]===0;)_++,y++;for(var E=(S-_)*h+1>>>0,w=new Uint8Array(E);_!==S;){for(var D=f[_],T=0,d=E-1;(D!==0||T<b)&&d!==-1;d--,T++)D+=256*w[d]>>>0,w[d]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");b=T,_++}for(var g=E-b;g!==E&&w[g]===0;)g++;for(var R=c.repeat(y);g<E;++g)R+=i.charAt(w[g]);return R}function m(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var y=0;if(f[y]!==" "){for(var b=0,_=0;f[y]===c;)b++,y++;for(var S=(f.length-y)*u+1>>>0,E=new Uint8Array(S);f[y];){var w=r[f.charCodeAt(y)];if(w===255)return;for(var D=0,T=S-1;(w!==0||D<_)&&T!==-1;T--,D++)w+=a*E[T]>>>0,E[T]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");_=D,y++}if(f[y]!==" "){for(var d=S-_;d!==S&&E[d]===0;)d++;for(var g=new Uint8Array(b+(S-d)),R=b;d!==S;)g[R++]=E[d++];return g}}}function p(f){var y=m(f);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:m,decode:p}}var Kw=Hw,Vw=Kw,fd=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},zw=i=>new TextEncoder().encode(i),$w=i=>new TextDecoder().decode(i),ga=class{constructor(e,r,t){this.name=e,this.prefix=r,this.baseEncode=t}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ma=class{constructor(e,r,t){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=t}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return dd(this,e)}},ya=class{constructor(e){this.decoders=e}or(e){return dd(this,e)}decode(e){let r=e[0],t=this.decoders[r];if(t)return t.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},dd=(i,e)=>new ya({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}}),ba=class{constructor(e,r,t,s){this.name=e,this.prefix=r,this.baseEncode=t,this.baseDecode=s,this.encoder=new ga(e,r,t),this.decoder=new ma(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Ys=({name:i,prefix:e,encode:r,decode:t})=>new ba(i,e,r,t),_i=({prefix:i,name:e,alphabet:r})=>{let{encode:t,decode:s}=Vw(r,e);return Ys({prefix:i,name:e,encode:t,decode:n=>fd(s(n))})},Gw=(i,e,r,t)=>{let s={};for(let h=0;h<e.length;++h)s[e[h]]=h;let n=i.length;for(;i[n-1]==="=";)--n;let o=new Uint8Array(n*r/8|0),a=0,c=0,u=0;for(let h=0;h<n;++h){let l=s[i[h]];if(l===void 0)throw new SyntaxError(`Non-${t} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ww=(i,e,r)=>{let t=e[e.length-1]==="=",s=(1<<r)-1,n="",o=0,a=0;for(let c=0;c<i.length;++c)for(a=a<<8|i[c],o+=8;o>r;)o-=r,n+=e[s&a>>o];if(o&&(n+=e[s&a<<r-o]),t)for(;n.length*r&7;)n+="=";return n},De=({name:i,prefix:e,bitsPerChar:r,alphabet:t})=>Ys({prefix:e,name:i,encode(s){return Ww(s,t,r)},decode(s){return Gw(s,t,r,i)}}),Jw=Ys({prefix:"\0",name:"identity",encode:i=>$w(i),decode:i=>zw(i)}),Yw=Object.freeze({__proto__:null,identity:Jw}),Xw=De({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Qw=Object.freeze({__proto__:null,base2:Xw}),Zw=De({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),e_=Object.freeze({__proto__:null,base8:Zw}),t_=_i({prefix:"9",name:"base10",alphabet:"0123456789"}),r_=Object.freeze({__proto__:null,base10:t_}),i_=De({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),s_=De({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),n_=Object.freeze({__proto__:null,base16:i_,base16upper:s_}),o_=De({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),a_=De({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),c_=De({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),u_=De({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),l_=De({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),h_=De({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),f_=De({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),d_=De({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),p_=De({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),g_=Object.freeze({__proto__:null,base32:o_,base32upper:a_,base32pad:c_,base32padupper:u_,base32hex:l_,base32hexupper:h_,base32hexpad:f_,base32hexpadupper:d_,base32z:p_}),m_=_i({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),y_=_i({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),b_=Object.freeze({__proto__:null,base36:m_,base36upper:y_}),w_=_i({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),__=_i({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),E_=Object.freeze({__proto__:null,base58btc:w_,base58flickr:__}),v_=De({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),x_=De({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),S_=De({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),D_=De({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),I_=Object.freeze({__proto__:null,base64:v_,base64pad:x_,base64url:S_,base64urlpad:D_}),pd=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),O_=pd.reduce((i,e,r)=>(i[r]=e,i),[]),T_=pd.reduce((i,e,r)=>(i[e.codePointAt(0)]=r,i),[]);function R_(i){return i.reduce((e,r)=>(e+=O_[r],e),"")}function A_(i){let e=[];for(let r of i){let t=T_[r.codePointAt(0)];if(t===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}var N_=Ys({prefix:"\u{1F680}",name:"base256emoji",encode:R_,decode:A_}),C_=Object.freeze({__proto__:null,base256emoji:N_}),P_=gd,Gf=128,L_=127,U_=~L_,F_=Math.pow(2,31);function gd(i,e,r){e=e||[],r=r||0;for(var t=r;i>=F_;)e[r++]=i&255|Gf,i/=128;for(;i&U_;)e[r++]=i&255|Gf,i>>>=7;return e[r]=i|0,gd.bytes=r-t+1,e}var M_=wa,q_=128,Wf=127;function wa(i,t){var r=0,t=t||0,s=0,n=t,o,a=i.length;do{if(n>=a)throw wa.bytes=0,new RangeError("Could not decode varint");o=i[n++],r+=s<28?(o&Wf)<<s:(o&Wf)*Math.pow(2,s),s+=7}while(o>=q_);return wa.bytes=n-t,r}var j_=Math.pow(2,7),k_=Math.pow(2,14),B_=Math.pow(2,21),H_=Math.pow(2,28),K_=Math.pow(2,35),V_=Math.pow(2,42),z_=Math.pow(2,49),$_=Math.pow(2,56),G_=Math.pow(2,63),W_=function(i){return i<j_?1:i<k_?2:i<B_?3:i<H_?4:i<K_?5:i<V_?6:i<z_?7:i<$_?8:i<G_?9:10},J_={encode:P_,decode:M_,encodingLength:W_},md=J_,Jf=(i,e,r=0)=>(md.encode(i,e,r),e),Yf=i=>md.encodingLength(i),_a=(i,e)=>{let r=e.byteLength,t=Yf(i),s=t+Yf(r),n=new Uint8Array(s+r);return Jf(i,n,0),Jf(r,n,t),n.set(e,s),new Ea(i,r,e,n)},Ea=class{constructor(e,r,t,s){this.code=e,this.size=r,this.digest=t,this.bytes=s}},yd=({name:i,code:e,encode:r})=>new va(i,e,r),va=class{constructor(e,r,t){this.name=e,this.code=r,this.encode=t}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?_a(this.code,r):r.then(t=>_a(this.code,t))}else throw Error("Unknown type, must be binary type")}},bd=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),Y_=yd({name:"sha2-256",code:18,encode:bd("SHA-256")}),X_=yd({name:"sha2-512",code:19,encode:bd("SHA-512")}),Q_=Object.freeze({__proto__:null,sha256:Y_,sha512:X_}),wd=0,Z_="identity",_d=fd,eE=i=>_a(wd,_d(i)),tE={code:wd,name:Z_,encode:_d,digest:eE},rE=Object.freeze({__proto__:null,identity:tE});new TextEncoder,new TextDecoder;var Xf={...Yw,...Qw,...e_,...r_,...n_,...g_,...b_,...E_,...I_,...C_};({...Q_,...rE});function iE(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(i):new Uint8Array(i)}function Ed(i,e,r,t){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:r},decoder:{decode:t}}}var Qf=Ed("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),da=Ed("ascii","a",i=>{let e="a";for(let r=0;r<i.length;r++)e+=String.fromCharCode(i[r]);return e},i=>{i=i.substring(1);let e=iE(i.length);for(let r=0;r<i.length;r++)e[r]=i.charCodeAt(r);return e}),sE={utf8:Qf,"utf-8":Qf,hex:Xf.base16,latin1:da,ascii:da,binary:da,...Xf};function nE(i,e="utf8"){let r=sE[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i,"utf8"):r.decoder.decode(`${r.prefix}${i}`)}var vd="wc",oE=2,La="core",Et=`${vd}@${2}:${La}:`,aE={name:La,logger:"error"},cE={database:":memory:"},uE="crypto",Zf="client_ed25519_seed",lE=fe.ONE_DAY,hE="keychain",fE="0.3",dE="messages",pE="0.3",gE=fe.SIX_HOURS,mE="publisher",Ua="irn",yE="error",xd="wss://relay.walletconnect.com",bE="relayer",Ee={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},wE="_subscription",Js={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},_E=fe.ONE_SECOND;var EE="2.6.2",vE="0.3",Ze={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"};var xE="subscription",SE="0.3",DE=fe.FIVE_SECONDS*1e3,IE="pairing",OE="0.3";var yi={wc_pairingDelete:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:fe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:fe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:fe.ONE_DAY,prompt:!1,tag:0},res:{ttl:fe.ONE_DAY,prompt:!1,tag:0}}},Qe={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},TE="history",RE="0.3",AE="expirer",ke={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},NE="0.3";var xa=class{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=hE,this.version=fE,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){let t=await this.getKeyChain();typeof t<"u"&&(this.keychain=t),this.initialized=!0}},this.has=t=>(this.isInitialized(),this.keychain.has(t)),this.set=async(t,s)=>{this.isInitialized(),this.keychain.set(t,s),await this.persist()},this.get=t=>{this.isInitialized();let s=this.keychain.get(t);if(typeof s>"u"){let{message:n}=C("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return s},this.del=async t=>{this.isInitialized(),this.keychain.delete(t),await this.persist()},this.core=e,this.logger=(0,ce.generateChildLogger)(r,this.name)}get context(){return(0,ce.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,qo(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?jo(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}},Sa=class{constructor(e,r,t){this.core=e,this.logger=r,this.name=uE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();let s=await this.getClientSeed(),n=_o(s);return ds(n.publicKey)},this.generateKeyPair=()=>{this.isInitialized();let s=gh();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();let n=await this.getClientSeed(),o=_o(n),a=Ss();return await cl(a,s,lE,o)},this.generateSharedKey=(s,n,o)=>{this.isInitialized();let a=this.getPrivateKey(s),c=mh(a,n);return this.setSymKey(c,o)},this.setSymKey=async(s,n)=>{this.isInitialized();let o=n||yh(s);return await this.keychain.set(o,s),o},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,n,o)=>{this.isInitialized();let a=Fo(o),c=tr(n);if(Mo(a)){let m=a.senderPublicKey,p=a.receiverPublicKey;s=await this.generateSharedKey(m,p)}let u=this.getSymKey(s),{type:h,senderPublicKey:l}=a;return bh({type:h,symKey:u,message:c,senderPublicKey:l})},this.decode=async(s,n,o)=>{this.isInitialized();let a=_h(n,o);if(Mo(a)){let h=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(h,l)}let c=this.getSymKey(s),u=wh({symKey:c,encoded:n});return Hr(u)},this.getPayloadType=s=>{let n=ni(s);return gr(n.type)},this.getPayloadSenderPublicKey=s=>{let n=ni(s);return n.senderPublicKey?_e(n.senderPublicKey,Te):void 0},this.core=e,this.logger=(0,ce.generateChildLogger)(r,this.name),this.keychain=t||new xa(this.core,this.logger)}get context(){return(0,ce.getLoggerContext)(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Zf)}catch{e=Ss(),await this.keychain.set(Zf,e)}return nE(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}},Da=class extends Wi{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=dE,this.version=pE,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let t=await this.getRelayerMessages();typeof t<"u"&&(this.messages=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}finally{this.initialized=!0}}},this.set=async(t,s)=>{this.isInitialized();let n=si(s),o=this.messages.get(t);return typeof o>"u"&&(o={}),typeof o[n]<"u"||(o[n]=s,this.messages.set(t,o),await this.persist()),n},this.get=t=>{this.isInitialized();let s=this.messages.get(t);return typeof s>"u"&&(s={}),s},this.has=(t,s)=>{this.isInitialized();let n=this.get(t),o=si(s);return typeof n[o]<"u"},this.del=async t=>{this.isInitialized(),this.messages.delete(t),await this.persist()},this.logger=(0,ce.generateChildLogger)(e,this.name),this.core=r}get context(){return(0,ce.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,qo(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?jo(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}},Ia=class extends Ji{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new W,this.name=mE,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(t,s,n)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:s,opts:n}});try{let o=n?.ttl||gE,a=Is(n),c=n?.prompt||!1,u=n?.tag||0,h={topic:t,message:s,opts:{ttl:o,relay:a,prompt:c,tag:u}},l=si(s);this.queue.set(l,h);try{await await oi(this.rpcPublish(t,s,o,a,c,u),this.publishTimeout),this.relayer.events.emit(Ee.publish,h)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ee.connection_stalled);return}this.onPublish(l,h),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:s,opts:n}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(t,s)=>{this.events.on(t,s)},this.once=(t,s)=>{this.events.once(t,s)},this.off=(t,s)=>{this.events.off(t,s)},this.removeListener=(t,s)=>{this.events.removeListener(t,s)},this.relayer=e,this.logger=(0,ce.generateChildLogger)(r,this.name),this.registerEventListeners()}get context(){return(0,ce.getLoggerContext)(this.logger)}rpcPublish(e,r,t,s,n,o){var a,c,u,h;let l={method:ai(s.protocol).publish,params:{topic:e,message:r,ttl:t,prompt:n,tag:o}};return Se((a=l.params)==null?void 0:a.prompt)&&((c=l.params)==null||delete c.prompt),Se((u=l.params)==null?void 0:u.tag)&&((h=l.params)==null||delete h.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:l}),this.relayer.request(l)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{let{topic:r,message:t,opts:s}=e;await this.publish(r,t,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(Dr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}},Oa=class{constructor(){this.map=new Map,this.set=(e,r)=>{let t=this.get(e);this.exists(e,r)||this.map.set(e,[...t,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let t=this.get(e);if(!this.exists(e,r))return;let s=t.filter(n=>n!==r);if(!s.length){this.map.delete(e);return}this.map.set(e,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}},CE=Object.defineProperty,PE=Object.defineProperties,LE=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,UE=Object.prototype.hasOwnProperty,FE=Object.prototype.propertyIsEnumerable,td=(i,e,r)=>e in i?CE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,bi=(i,e)=>{for(var r in e||(e={}))UE.call(e,r)&&td(i,r,e[r]);if(ed)for(var r of ed(e))FE.call(e,r)&&td(i,r,e[r]);return i},pa=(i,e)=>PE(i,LE(e)),Ta=class extends Qi{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new Oa,this.events=new W,this.name=xE,this.version=SE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Et,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(t,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:s}});try{let n=Is(s),o={topic:t,relay:n};this.pending.set(t,o);let a=await this.rpcSubscribe(t,n);return this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:s}}),a}catch(n){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(n),n}},this.unsubscribe=async(t,s)=>{await this.restartToComplete(),this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(t,s.id,s):await this.unsubscribeByTopic(t,s)},this.isSubscribed=async t=>this.topics.includes(t)?!0:await new Promise((s,n)=>{let o=new fe.Watch;o.start(this.pendingSubscriptionWatchLabel);let a=setInterval(()=>{!this.pending.has(t)&&this.topics.includes(t)&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),s(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=DE&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),n(!1))},this.pollingInterval)}),this.on=(t,s)=>{this.events.on(t,s)},this.once=(t,s)=>{this.events.once(t,s)},this.off=(t,s)=>{this.events.off(t,s)},this.removeListener=(t,s)=>{this.events.removeListener(t,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=(0,ce.generateChildLogger)(r,this.name),this.clientId=""}get context(){return(0,ce.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let t=!1;try{t=this.getSubscription(e).topic===r}catch{}return t}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){let t=this.topicMap.get(e);await Promise.all(t.map(async s=>await this.unsubscribeById(e,s,r)))}async unsubscribeById(e,r,t){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:t}});try{let s=Is(t);await this.rpcUnsubscribe(e,r,s);let n=ye("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,n),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:t}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,r){let t={method:ai(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await oi(this.relayer.request(t),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ee.connection_stalled)}return si(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;let r=e[0].relay,t={method:ai(r.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{return await await oi(this.relayer.request(t),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ee.connection_stalled)}}rpcUnsubscribe(e,r,t){let s={method:ai(t.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,r){this.setSubscription(e,pa(bi({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,bi({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,t){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,t),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,bi({},r)),this.topicMap.set(r.topic,e),this.events.emit(Ze.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let r=this.subscriptions.get(e);if(!r){let{message:t}=C("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});let t=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(t.topic,e),this.events.emit(Ze.deleted,pa(bi({},t),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ze.sync)}async reset(){if(!this.cached.length)return;let e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){let t=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}this.events.emit(Ze.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:r}=C("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;let r=await this.rpcBatchSubscribe(e);yr(r)&&this.onBatchSubscribe(r.map((t,s)=>pa(bi({},e[s]),{id:t})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;let e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Dr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ee.connect,async()=>{await this.onConnect()}),this.relayer.on(Ee.disconnect,()=>{this.onDisconnect()}),this.events.on(Ze.created,async e=>{let r=Ze.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Ze.deleted,async e=>{let r=Ze.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{let r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}},ME=Object.defineProperty,rd=Object.getOwnPropertySymbols,qE=Object.prototype.hasOwnProperty,jE=Object.prototype.propertyIsEnumerable,id=(i,e,r)=>e in i?ME(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,kE=(i,e)=>{for(var r in e||(e={}))qE.call(e,r)&&id(i,r,e[r]);if(rd)for(var r of rd(e))jE.call(e,r)&&id(i,r,e[r]);return i},Ra=class extends Yi{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new W,this.name=bE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(t){throw this.logger.debug("Failed to Publish Request"),this.logger.error(t),t}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?(0,ce.generateChildLogger)(e.logger,this.name):(0,Pa.default)((0,ce.getDefaultLoggerOptions)({level:e.logger||yE})),this.messages=new Da(this.logger,e.core),this.subscriber=new Ta(this,this.logger),this.publisher=new Ia(this,this.logger),this.relayUrl=e?.relayUrl||xd,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return(0,ce.getLoggerContext)(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,t){this.isInitialized(),await this.publisher.publish(e,r,t),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let t="";return await Promise.all([new Promise(s=>{this.subscriber.once(Ze.created,n=>{n.topic===e&&s()})}),new Promise(async s=>{t=await this.subscriber.subscribe(e,r),s()})]),t}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ee.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Ze.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,t)=>{await oi(this.provider.connect(),5e3,"socket stalled").catch(s=>t(s)).then(()=>r()).finally(()=>this.removeListener(Ee.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ee.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);let t=r;if(!this.isConnectionStalled(t.message))throw r;this.events.emit(Ee.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,await this.transportClose(),await new Promise(r=>setTimeout(r,500)),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ms(new ff(xh({sdkVersion:EE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){let{topic:r,message:t}=e;await this.messages.set(r,t)}async shouldIgnoreMessageEvent(e){let{topic:r,message:t}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,t):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Er(e)){if(!e.method.endsWith(wE))return;let r=e.params,{topic:t,message:s,publishedAt:n}=r.data,o={topic:t,message:s,publishedAt:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(kE({type:"event",event:r.id},o)),this.events.emit(r.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ee.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){let r=wr(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Js.payload,e=>this.onProviderPayload(e)),this.provider.on(Js.connect,()=>{this.events.emit(Ee.connect)}),this.provider.on(Js.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Js.error,e=>{this.logger.error(e),this.events.emit(Ee.error,e)})}registerEventListeners(){this.events.on(Ee.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ee.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},(0,fe.toMiliseconds)(_E))}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{let r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}},BE=Object.defineProperty,sd=Object.getOwnPropertySymbols,HE=Object.prototype.hasOwnProperty,KE=Object.prototype.propertyIsEnumerable,nd=(i,e,r)=>e in i?BE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,od=(i,e)=>{for(var r in e||(e={}))HE.call(e,r)&&nd(i,r,e[r]);if(sd)for(var r of sd(e))KE.call(e,r)&&nd(i,r,e[r]);return i},Bt=class extends Xi{constructor(e,r,t,s=Et,n=void 0){super(e,r,t,s),this.core=e,this.logger=r,this.name=t,this.map=new Map,this.version=vE,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Se(o)?this.map.set(this.getKey(o),o):Ch(o)?this.map.set(o.id,o):Ph(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)},this.set=async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>(0,hd.default)(a[c],o[c]))):this.values),this.update=async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});let c=od(od({},this.getData(o)),a);this.map.set(o,c),await this.persist()},this.delete=async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),await this.persist())},this.logger=(0,ce.generateChildLogger)(r,this.name),this.storagePrefix=s,this.getKey=n}get context(){return(0,ce.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let r=this.map.get(e);if(!r){let{message:t}=C("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:r}=C("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}},Aa=class{constructor(e,r){this.core=e,this.logger=r,this.name=IE,this.version=OE,this.events=new $t,this.initialized=!1,this.storagePrefix=Et,this.ignoredPayloadTypes=[at],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:t})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...t])]},this.create=async()=>{this.isInitialized();let t=Ss(),s=await this.core.crypto.setSymKey(t),n=He(fe.FIVE_MINUTES),o={protocol:Ua},a={topic:s,expiry:n,relay:o,active:!1},c=Th({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:t,relay:o});return await this.pairings.set(s,a),await this.core.relayer.subscribe(s),this.core.expirer.set(s,n),{topic:s,uri:c}},this.pair=async t=>{this.isInitialized(),this.isValidPair(t);let{topic:s,symKey:n,relay:o}=Oh(t.uri);if(this.pairings.keys.includes(s))throw new Error(`Pairing already exists: ${s}`);if(this.core.crypto.hasKeys(s))throw new Error(`Keychain already exists: ${s}`);let a=He(fe.FIVE_MINUTES),c={topic:s,relay:o,expiry:a,active:!1};return await this.pairings.set(s,c),await this.core.crypto.setSymKey(n,s),await this.core.relayer.subscribe(s,{relay:o}),this.core.expirer.set(s,a),t.activatePairing&&await this.activate({topic:s}),c},this.activate=async({topic:t})=>{this.isInitialized();let s=He(fe.THIRTY_DAYS);await this.pairings.update(t,{active:!0,expiry:s}),this.core.expirer.set(t,s)},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);let{topic:s}=t;if(this.pairings.keys.includes(s)){let n=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=pt();this.events.once(ge("pairing_ping",n),({error:u})=>{u?c(u):a()}),await o()}},this.updateExpiry=async({topic:t,expiry:s})=>{this.isInitialized(),await this.pairings.update(t,{expiry:s})},this.updateMetadata=async({topic:t,metadata:s})=>{this.isInitialized(),await this.pairings.update(t,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);let{topic:s}=t;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",ye("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(t,s,n)=>{let o=bt(s,n),a=await this.core.crypto.encode(t,o),c=yi[s].req;return this.core.history.set(t,o),await this.core.relayer.publish(t,a,c),o.id},this.sendResult=async(t,s,n)=>{let o=wr(t,n),a=await this.core.crypto.encode(s,o),c=await this.core.history.get(s,t),u=yi[c.request.method].res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)},this.sendError=async(t,s,n)=>{let o=Ut(t,n),a=await this.core.crypto.encode(s,o),c=await this.core.history.get(s,t),u=yi[c.request.method]?yi[c.request.method].res:yi.unregistered_method.res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)},this.deletePairing=async(t,s)=>{await this.core.relayer.unsubscribe(t),await Promise.all([this.pairings.delete(t,ye("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(t),s?Promise.resolve():this.core.expirer.del(t)])},this.cleanup=async()=>{let t=this.pairings.getAll().filter(s=>Ye(s.expiry));await Promise.all(t.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=t=>{let{topic:s,payload:n}=t,o=n.method;if(this.pairings.keys.includes(s))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(s,n);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,n);default:return this.onUnknownRpcMethodRequest(s,n)}},this.onRelayEventResponse=async t=>{let{topic:s,payload:n}=t,o=(await this.core.history.get(s,n.id)).request.method;if(this.pairings.keys.includes(s))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,n);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(t,s)=>{let{id:n}=s;try{this.isValidPing({topic:t}),await this.sendResult(n,t,!0),this.events.emit("pairing_ping",{id:n,topic:t})}catch(o){await this.sendError(n,t,o),this.logger.error(o)}},this.onPairingPingResponse=(t,s)=>{let{id:n}=s;setTimeout(()=>{Ke(s)?this.events.emit(ge("pairing_ping",n),{}):Pe(s)&&this.events.emit(ge("pairing_ping",n),{error:s.error})},500)},this.onPairingDeleteRequest=async(t,s)=>{let{id:n}=s;try{this.isValidDisconnect({topic:t}),await this.deletePairing(t),this.events.emit("pairing_delete",{id:n,topic:t})}catch(o){await this.sendError(n,t,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(t,s)=>{let{id:n,method:o}=s;try{if(this.registeredMethods.includes(o))return;let a=ye("WC_METHOD_UNSUPPORTED",o);await this.sendError(n,t,a),this.logger.error(a)}catch(a){await this.sendError(n,t,a),this.logger.error(a)}},this.onUnknownRpcMethodResponse=t=>{this.registeredMethods.includes(t)||this.logger.error(ye("WC_METHOD_UNSUPPORTED",t))},this.isValidPair=t=>{if(!Re(t)){let{message:s}=C("MISSING_OR_INVALID",`pair() params: ${t}`);throw new Error(s)}if(!Nh(t.uri)){let{message:s}=C("MISSING_OR_INVALID",`pair() uri: ${t.uri}`);throw new Error(s)}},this.isValidPing=async t=>{if(!Re(t)){let{message:n}=C("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(n)}let{topic:s}=t;await this.isValidPairingTopic(s)},this.isValidDisconnect=async t=>{if(!Re(t)){let{message:n}=C("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(n)}let{topic:s}=t;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async t=>{if(!be(t,!1)){let{message:s}=C("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(s)}if(!this.pairings.keys.includes(t)){let{message:s}=C("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(s)}if(Ye(this.pairings.get(t).expiry)){await this.deletePairing(t);let{message:s}=C("EXPIRED",`pairing topic: ${t}`);throw new Error(s)}},this.core=e,this.logger=(0,ce.generateChildLogger)(r,this.name),this.pairings=new Bt(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,ce.getLoggerContext)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ee.message,async e=>{let{topic:r,message:t}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(t)))return;let s=await this.core.crypto.decode(r,t);Er(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):Ft(s)&&(await this.core.history.resolve(s),this.onRelayEventResponse({topic:r,payload:s}))})}registerExpirerEvents(){this.core.expirer.on(ke.expired,async e=>{let{topic:r}=Ds(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}},Na=class extends Gi{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new W,this.name=TE,this.version=RE,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(t=>this.records.set(t.id,t)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(t,s,n)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:t,request:s,chainId:n}),this.records.has(s.id))return;let o={id:s.id,topic:t,request:{method:s.method,params:s.params||null},chainId:n};this.records.set(o.id,o),this.events.emit(Qe.created,o)},this.resolve=async t=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:t}),!this.records.has(t.id))return;let s=await this.getRecord(t.id);typeof s.response>"u"&&(s.response=Pe(t)?{error:t.error}:{result:t.result},this.records.set(s.id,s),this.events.emit(Qe.updated,s))},this.get=async(t,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:t,id:s}),await this.getRecord(s)),this.delete=(t,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(n=>{if(n.topic===t){if(typeof s<"u"&&n.id!==s)return;this.records.delete(n.id),this.events.emit(Qe.deleted,n)}})},this.exists=async(t,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===t:!1),this.on=(t,s)=>{this.events.on(t,s)},this.once=(t,s)=>{this.events.once(t,s)},this.off=(t,s)=>{this.events.off(t,s)},this.removeListener=(t,s)=>{this.events.removeListener(t,s)},this.logger=(0,ce.generateChildLogger)(r,this.name)}get context(){return(0,ce.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;let t={topic:r.topic,request:bt(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(t)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let r=this.records.get(e);if(!r){let{message:t}=C("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qe.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:r}=C("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Qe.created,e=>{let r=Qe.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Qe.updated,e=>{let r=Qe.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Qe.deleted,e=>{let r=Qe.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}},Ca=class extends Zi{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new W,this.name=AE,this.version=NE,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(t=>this.expirations.set(t.target,t)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=t=>{try{let s=this.formatTarget(t);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(t,s)=>{this.isInitialized();let n=this.formatTarget(t),o={target:n,expiry:s};this.expirations.set(n,o),this.checkExpiry(n,o),this.events.emit(ke.created,{target:n,expiration:o})},this.get=t=>{this.isInitialized();let s=this.formatTarget(t);return this.getExpiration(s)},this.del=t=>{if(this.isInitialized(),this.has(t)){let s=this.formatTarget(t),n=this.getExpiration(s);this.expirations.delete(s),this.events.emit(ke.deleted,{target:s,expiration:n})}},this.on=(t,s)=>{this.events.on(t,s)},this.once=(t,s)=>{this.events.once(t,s)},this.off=(t,s)=>{this.events.off(t,s)},this.removeListener=(t,s)=>{this.events.removeListener(t,s)},this.logger=(0,ce.generateChildLogger)(r,this.name)}get context(){return(0,ce.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Dh(e);if(typeof e=="number")return Ih(e);let{message:r}=C("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ke.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:r}=C("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let r=this.expirations.get(e);if(!r){let{message:t}=C("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return r}checkExpiry(e,r){let{expiry:t}=r;(0,fe.toMiliseconds)(t)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(ke.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Dr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ke.created,e=>{let r=ke.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ke.expired,e=>{let r=ke.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ke.deleted,e=>{let r=ke.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}},VE=Object.defineProperty,ad=Object.getOwnPropertySymbols,zE=Object.prototype.hasOwnProperty,$E=Object.prototype.propertyIsEnumerable,cd=(i,e,r)=>e in i?VE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,ud=(i,e)=>{for(var r in e||(e={}))zE.call(e,r)&&cd(i,r,e[r]);if(ad)for(var r of ad(e))$E.call(e,r)&&cd(i,r,e[r]);return i},wi=class extends $i{constructor(e){super(e),this.protocol=vd,this.version=oE,this.name=La,this.events=new W,this.initialized=!1,this.on=(t,s)=>this.events.on(t,s),this.once=(t,s)=>this.events.once(t,s),this.off=(t,s)=>this.events.off(t,s),this.removeListener=(t,s)=>this.events.removeListener(t,s),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||xd;let r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:(0,Pa.default)((0,ce.getDefaultLoggerOptions)({level:e?.logger||aE.logger}));this.logger=(0,ce.generateChildLogger)(r,this.name),this.heartbeat=new Dr.HeartBeat,this.crypto=new Sa(this,this.logger,e?.keychain),this.history=new Na(this,this.logger),this.expirer=new Ca(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new ld.default(ud(ud({},cE),e?.storageOptions)),this.relayer=new Ra({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Aa(this,this.logger)}static async init(e){let r=new wi(e);return await r.initialize(),r}get context(){return(0,ce.getLoggerContext)(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}},Sd=wi;var Ir=oe(Nn());xt();var ue=oe(Dt());var Td="wc",Rd=2,Ad="client",Ka=`${Td}@${Rd}:${Ad}:`,Fa={name:Ad,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"};var GE="proposal";var WE="Proposal expired",JE="session",Xs=ue.SEVEN_DAYS,YE="engine",Ei={wc_sessionPropose:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ma={min:ue.FIVE_MINUTES,max:ue.SEVEN_DAYS},XE="request",QE=Object.defineProperty,ZE=Object.defineProperties,e1=Object.getOwnPropertyDescriptors,Dd=Object.getOwnPropertySymbols,t1=Object.prototype.hasOwnProperty,r1=Object.prototype.propertyIsEnumerable,Id=(i,e,r)=>e in i?QE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,Ve=(i,e)=>{for(var r in e||(e={}))t1.call(e,r)&&Id(i,r,e[r]);if(Dd)for(var r of Dd(e))r1.call(e,r)&&Id(i,r,e[r]);return i},qa=(i,e)=>ZE(i,e1(e)),ja=class extends ts{constructor(e){super(e),this.name=YE,this.events=new $t,this.initialized=!1,this.ignoredPayloadTypes=[at],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Ei)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();let t=qa(Ve({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(t);let{pairingTopic:s,requiredNamespaces:n,optionalNamespaces:o,sessionProperties:a,relays:c}=t,u=s,h,l=!1;if(u&&(l=this.client.core.pairing.pairings.get(u).active),!u||!l){let{topic:E,uri:w}=await this.client.core.pairing.create();u=E,h=w}let m=await this.client.core.crypto.generateKeyPair(),p=Ve({requiredNamespaces:n,optionalNamespaces:o,relays:c??[{protocol:Ua}],proposer:{publicKey:m,metadata:this.client.metadata}},a&&{sessionProperties:a}),{reject:f,resolve:y,done:b}=pt(ue.FIVE_MINUTES,WE);if(this.events.once(ge("session_connect"),async({error:E,session:w})=>{if(E)f(E);else if(w){w.self.publicKey=m;let D=qa(Ve({},w),{requiredNamespaces:w.requiredNamespaces,optionalNamespaces:w.optionalNamespaces});await this.client.session.set(w.topic,D),await this.setExpiry(w.topic,w.expiry),u&&await this.client.core.pairing.updateMetadata({topic:u,metadata:w.peer.metadata}),y(D)}}),!u){let{message:E}=C("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(E)}let _=await this.sendRequest(u,"wc_sessionPropose",p),S=He(ue.FIVE_MINUTES);return await this.setProposal(_,Ve({id:_,expiry:S},p)),{uri:h,approval:b}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);let{id:t,relayProtocol:s,namespaces:n,sessionProperties:o}=r,a=this.client.proposal.get(t),{pairingTopic:c,proposer:u,requiredNamespaces:h,optionalNamespaces:l}=a;c=c||"",br(h)||(h=Rh(n,"approve()"));let m=await this.client.core.crypto.generateKeyPair(),p=u.publicKey,f=await this.client.core.crypto.generateSharedKey(m,p);c&&t&&(await this.client.core.pairing.updateMetadata({topic:c,metadata:u.metadata}),await this.sendResult(t,c,{relay:{protocol:s??"irn"},responderPublicKey:m}),await this.client.proposal.delete(t,ye("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:c}));let y=Ve({relay:{protocol:s??"irn"},namespaces:n,requiredNamespaces:h,optionalNamespaces:l,pairingTopic:c,controller:{publicKey:m,metadata:this.client.metadata},expiry:He(Xs)},o&&{sessionProperties:o});await this.client.core.relayer.subscribe(f),await this.sendRequest(f,"wc_sessionSettle",y);let b=qa(Ve({},y),{topic:f,pairingTopic:c,acknowledged:!1,self:y.controller,peer:{publicKey:u.publicKey,metadata:u.metadata},controller:m});return await this.client.session.set(f,b),await this.setExpiry(f,He(Xs)),{topic:f,acknowledged:()=>new Promise(_=>_(this.client.session.get(f)))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);let{id:t,reason:s}=r,{pairingTopic:n}=this.client.proposal.get(t);n&&(await this.sendError(t,n,s),await this.client.proposal.delete(t,ye("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);let{topic:t,namespaces:s}=r,n=await this.sendRequest(t,"wc_sessionUpdate",{namespaces:s}),{done:o,resolve:a,reject:c}=pt();return this.events.once(ge("session_update",n),({error:u})=>{u?c(u):a()}),await this.client.session.update(t,{namespaces:s}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);let{topic:t}=r,s=await this.sendRequest(t,"wc_sessionExtend",{}),{done:n,resolve:o,reject:a}=pt();return this.events.once(ge("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(t,He(Xs)),{acknowledged:n}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);let{chainId:t,request:s,topic:n,expiry:o}=r,a=await this.sendRequest(n,"wc_sessionRequest",{request:s,chainId:t},o),{done:c,resolve:u,reject:h}=pt(o);return this.events.once(ge("session_request",a),({error:l,result:m})=>{l?h(l):u(m)}),this.client.events.emit("session_request_sent",{topic:n,request:s,chainId:t,id:a}),await c()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);let{topic:t,response:s}=r,{id:n}=s;Ke(s)?await this.sendResult(n,t,s.result):Pe(s)&&await this.sendError(n,t,s.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);let{topic:t}=r;if(this.client.session.keys.includes(t)){let s=await this.sendRequest(t,"wc_sessionPing",{}),{done:n,resolve:o,reject:a}=pt();this.events.once(ge("session_ping",s),({error:c})=>{c?a(c):o()}),await n()}else this.client.core.pairing.pairings.keys.includes(t)&&await this.client.core.pairing.ping({topic:t})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);let{topic:t,event:s,chainId:n}=r;await this.sendRequest(t,"wc_sessionEvent",{event:s,chainId:n})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);let{topic:t}=r;this.client.session.keys.includes(t)?(await this.sendRequest(t,"wc_sessionDelete",ye("USER_DISCONNECTED")),await this.deleteSession(t)):await this.client.core.pairing.disconnect({topic:t})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(t=>Ah(t,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,t)=>{let{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,ye("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.deleteSymKey(r),t?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,t)=>{await Promise.all([this.client.proposal.delete(r,ye("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,t,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,t),s?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,t)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:t}),this.client.core.expirer.set(r,t)},this.setProposal=async(r,t)=>{await this.client.proposal.set(r,t),this.client.core.expirer.set(r,t.expiry)},this.setPendingSessionRequest=async r=>{let t=Ei.wc_sessionRequest.req.ttl,{id:s,topic:n,params:o}=r;await this.client.pendingRequest.set(s,{id:s,topic:n,params:o}),t&&this.client.core.expirer.set(s,He(t))},this.sendRequest=async(r,t,s,n)=>{let o=bt(t,s),a=await this.client.core.crypto.encode(r,o),c=Ei[t].req;return n&&(c.ttl=n),this.client.core.history.set(r,o),this.client.core.relayer.publish(r,a,c),o.id},this.sendResult=async(r,t,s)=>{let n=wr(r,s),o=await this.client.core.crypto.encode(t,n),a=await this.client.core.history.get(t,r),c=Ei[a.request.method].res;this.client.core.relayer.publish(t,o,c),await this.client.core.history.resolve(n)},this.sendError=async(r,t,s)=>{let n=Ut(r,s),o=await this.client.core.crypto.encode(t,n),a=await this.client.core.history.get(t,r),c=Ei[a.request.method].res;this.client.core.relayer.publish(t,o,c),await this.client.core.history.resolve(n)},this.cleanup=async()=>{let r=[],t=[];this.client.session.getAll().forEach(s=>{Ye(s.expiry)&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Ye(s.expiry)&&t.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession(s)),...t.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=r=>{let{topic:t,payload:s}=r,n=s.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeRequest(t,s);case"wc_sessionSettle":return this.onSessionSettleRequest(t,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(t,s);case"wc_sessionExtend":return this.onSessionExtendRequest(t,s);case"wc_sessionPing":return this.onSessionPingRequest(t,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(t,s);case"wc_sessionRequest":return this.onSessionRequest(t,s);case"wc_sessionEvent":return this.onSessionEventRequest(t,s);default:return this.client.logger.info(`Unsupported request method ${n}`)}},this.onRelayEventResponse=async r=>{let{topic:t,payload:s}=r,n=(await this.client.core.history.get(t,s.id)).request.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeResponse(t,s);case"wc_sessionSettle":return this.onSessionSettleResponse(t,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,s);case"wc_sessionExtend":return this.onSessionExtendResponse(t,s);case"wc_sessionPing":return this.onSessionPingResponse(t,s);case"wc_sessionRequest":return this.onSessionRequestResponse(t,s);default:return this.client.logger.info(`Unsupported response method ${n}`)}},this.onSessionProposeRequest=async(r,t)=>{let{params:s,id:n}=t;try{this.isValidConnect(Ve({},t.params));let o=He(ue.FIVE_MINUTES),a=Ve({id:n,pairingTopic:r,expiry:o},s);await this.setProposal(n,a),this.client.events.emit("session_proposal",{id:n,params:a})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,t)=>{let{id:s}=t;if(Ke(t)){let{result:n}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:n});let o=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});let a=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});let c=n.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:c});let u=await this.client.core.crypto.generateSharedKey(a,c);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:u});let h=await this.client.core.relayer.subscribe(u);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:r})}else Pe(t)&&(await this.client.proposal.delete(s,ye("USER_DISCONNECTED")),this.events.emit(ge("session_connect"),{error:t.error}))},this.onSessionSettleRequest=async(r,t)=>{let{id:s,params:n}=t;try{this.isValidSessionSettleRequest(n);let{relay:o,controller:a,expiry:c,namespaces:u,requiredNamespaces:h,optionalNamespaces:l,sessionProperties:m,pairingTopic:p}=t.params,f=Ve({topic:r,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:p,requiredNamespaces:h,optionalNamespaces:l,controller:a.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},m&&{sessionProperties:m});await this.sendResult(t.id,r,!0),this.events.emit(ge("session_connect"),{session:f})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,t)=>{let{id:s}=t;Ke(t)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(ge("session_approve",s),{})):Pe(t)&&(await this.client.session.delete(r,ye("USER_DISCONNECTED")),this.events.emit(ge("session_approve",s),{error:t.error}))},this.onSessionUpdateRequest=async(r,t)=>{let{params:s,id:n}=t;try{this.isValidUpdate(Ve({topic:r},s)),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult(n,r,!0),this.client.events.emit("session_update",{id:n,topic:r,params:s})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,t)=>{let{id:s}=t;Ke(t)?this.events.emit(ge("session_update",s),{}):Pe(t)&&this.events.emit(ge("session_update",s),{error:t.error})},this.onSessionExtendRequest=async(r,t)=>{let{id:s}=t;try{this.isValidExtend({topic:r}),await this.setExpiry(r,He(Xs)),await this.sendResult(s,r,!0),this.client.events.emit("session_extend",{id:s,topic:r})}catch(n){await this.sendError(s,r,n),this.client.logger.error(n)}},this.onSessionExtendResponse=(r,t)=>{let{id:s}=t;Ke(t)?this.events.emit(ge("session_extend",s),{}):Pe(t)&&this.events.emit(ge("session_extend",s),{error:t.error})},this.onSessionPingRequest=async(r,t)=>{let{id:s}=t;try{this.isValidPing({topic:r}),await this.sendResult(s,r,!0),this.client.events.emit("session_ping",{id:s,topic:r})}catch(n){await this.sendError(s,r,n),this.client.logger.error(n)}},this.onSessionPingResponse=(r,t)=>{let{id:s}=t;setTimeout(()=>{Ke(t)?this.events.emit(ge("session_ping",s),{}):Pe(t)&&this.events.emit(ge("session_ping",s),{error:t.error})},500)},this.onSessionDeleteRequest=async(r,t)=>{let{id:s}=t;try{this.isValidDisconnect({topic:r,reason:t.params}),this.client.core.relayer.once(Ee.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(s,r,!0),this.client.events.emit("session_delete",{id:s,topic:r})}catch(n){await this.sendError(s,r,n),this.client.logger.error(n)}},this.onSessionRequest=async(r,t)=>{let{id:s,params:n}=t;try{this.isValidRequest(Ve({topic:r},n)),await this.setPendingSessionRequest({id:s,topic:r,params:n}),this.client.events.emit("session_request",{id:s,topic:r,params:n})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,t)=>{let{id:s}=t;Ke(t)?this.events.emit(ge("session_request",s),{result:t.result}):Pe(t)&&this.events.emit(ge("session_request",s),{error:t.error})},this.onSessionEventRequest=async(r,t)=>{let{id:s,params:n}=t;try{this.isValidEmit(Ve({topic:r},n)),this.client.events.emit("session_event",{id:s,topic:r,params:n})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!Re(r)){let{message:c}=C("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(c)}let{pairingTopic:t,requiredNamespaces:s,optionalNamespaces:n,sessionProperties:o,relays:a}=r;if(Se(t)||await this.isValidPairingTopic(t),!Mh(a,!0)){let{message:c}=C("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(c)}!Se(s)&&br(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!Se(n)&&br(n)!==0&&this.validateNamespaces(n,"optionalNamespaces"),Se(o)||this.validateSessionProps(o,"sessionProperties")},this.validateNamespaces=(r,t)=>{let s=Fh(r,"connect()",t);if(s)throw new Error(s.message)},this.isValidApprove=async r=>{if(!Re(r))throw new Error(C("MISSING_OR_INVALID",`approve() params: ${r}`).message);let{id:t,namespaces:s,relayProtocol:n,sessionProperties:o}=r;await this.isValidProposalId(t);let a=this.client.proposal.get(t),c=ci(s,"approve()");if(c)throw new Error(c.message);let u=Vo(a.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!be(n,!0)){let{message:h}=C("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(h)}Se(o)||this.validateSessionProps(o,"sessionProperties")},this.isValidReject=async r=>{if(!Re(r)){let{message:n}=C("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(n)}let{id:t,reason:s}=r;if(await this.isValidProposalId(t),!jh(s)){let{message:n}=C("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(n)}},this.isValidSessionSettleRequest=r=>{if(!Re(r)){let{message:u}=C("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(u)}let{relay:t,controller:s,namespaces:n,expiry:o}=r;if(!Ho(t)){let{message:u}=C("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}let a=Lh(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);let c=ci(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Ye(o)){let{message:u}=C("EXPIRED","onSessionSettleRequest()");throw new Error(u)}},this.isValidUpdate=async r=>{if(!Re(r)){let{message:c}=C("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}let{topic:t,namespaces:s}=r;await this.isValidSessionTopic(t);let n=this.client.session.get(t),o=ci(s,"update()");if(o)throw new Error(o.message);let a=Vo(n.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)},this.isValidExtend=async r=>{if(!Re(r)){let{message:s}=C("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}let{topic:t}=r;await this.isValidSessionTopic(t)},this.isValidRequest=async r=>{if(!Re(r)){let{message:c}=C("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}let{topic:t,request:s,chainId:n,expiry:o}=r;await this.isValidSessionTopic(t);let{namespaces:a}=this.client.session.get(t);if(!Ko(a,n)){let{message:c}=C("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(c)}if(!kh(s)){let{message:c}=C("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!Kh(a,n,s.method)){let{message:c}=C("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!zh(o,Ma)){let{message:c}=C("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Ma.min} and ${Ma.max}`);throw new Error(c)}},this.isValidRespond=async r=>{if(!Re(r)){let{message:n}=C("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(n)}let{topic:t,response:s}=r;if(await this.isValidSessionTopic(t),!Bh(s)){let{message:n}=C("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(n)}},this.isValidPing=async r=>{if(!Re(r)){let{message:s}=C("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}let{topic:t}=r;await this.isValidSessionOrPairingTopic(t)},this.isValidEmit=async r=>{if(!Re(r)){let{message:a}=C("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}let{topic:t,event:s,chainId:n}=r;await this.isValidSessionTopic(t);let{namespaces:o}=this.client.session.get(t);if(!Ko(o,n)){let{message:a}=C("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(a)}if(!Hh(s)){let{message:a}=C("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!Vh(o,n,s.name)){let{message:a}=C("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidDisconnect=async r=>{if(!Re(r)){let{message:s}=C("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}let{topic:t}=r;await this.isValidSessionOrPairingTopic(t)},this.validateSessionProps=(r,t)=>{Object.values(r).forEach(s=>{if(!be(s,!1)){let{message:n}=C("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(n)}})}}isInitialized(){if(!this.initialized){let{message:e}=C("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ee.message,async e=>{let{topic:r,message:t}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(t)))return;let s=await this.client.core.crypto.decode(r,t);Er(s)?(this.client.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):Ft(s)&&(await this.client.core.history.resolve(s),this.onRelayEventResponse({topic:r,payload:s}))})}registerExpirerEvents(){this.client.core.expirer.on(ke.expired,async e=>{let{topic:r,id:t}=Ds(e.target);if(t&&this.client.pendingRequest.keys.includes(t))return await this.deletePendingSessionRequest(t,C("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):t&&(await this.deleteProposal(t,!0),this.client.events.emit("proposal_expire",{id:t}))})}isValidPairingTopic(e){if(!be(e,!1)){let{message:r}=C("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:r}=C("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ye(this.client.core.pairing.pairings.get(e).expiry)){let{message:r}=C("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!be(e,!1)){let{message:r}=C("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){let{message:r}=C("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ye(this.client.session.get(e).expiry)){await this.deleteSession(e);let{message:r}=C("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(be(e,!1)){let{message:r}=C("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{let{message:r}=C("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!qh(e)){let{message:r}=C("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){let{message:r}=C("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ye(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);let{message:r}=C("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}},ka=class extends Bt{constructor(e,r){super(e,r,GE,Ka),this.core=e,this.logger=r}},Ba=class extends Bt{constructor(e,r){super(e,r,JE,Ka),this.core=e,this.logger=r}},Ha=class extends Bt{constructor(e,r){super(e,r,XE,Ka,t=>t.id),this.core=e,this.logger=r}},vi=class extends es{constructor(e){super(e),this.protocol=Td,this.version=Rd,this.name=Fa.name,this.events=new W,this.on=(t,s)=>this.events.on(t,s),this.once=(t,s)=>this.events.once(t,s),this.off=(t,s)=>this.events.off(t,s),this.removeListener=(t,s)=>this.events.removeListener(t,s),this.removeAllListeners=t=>this.events.removeAllListeners(t),this.connect=async t=>{try{return await this.engine.connect(t)}catch(s){throw this.logger.error(s.message),s}},this.pair=async t=>{try{return await this.engine.pair(t)}catch(s){throw this.logger.error(s.message),s}},this.approve=async t=>{try{return await this.engine.approve(t)}catch(s){throw this.logger.error(s.message),s}},this.reject=async t=>{try{return await this.engine.reject(t)}catch(s){throw this.logger.error(s.message),s}},this.update=async t=>{try{return await this.engine.update(t)}catch(s){throw this.logger.error(s.message),s}},this.extend=async t=>{try{return await this.engine.extend(t)}catch(s){throw this.logger.error(s.message),s}},this.request=async t=>{try{return await this.engine.request(t)}catch(s){throw this.logger.error(s.message),s}},this.respond=async t=>{try{return await this.engine.respond(t)}catch(s){throw this.logger.error(s.message),s}},this.ping=async t=>{try{return await this.engine.ping(t)}catch(s){throw this.logger.error(s.message),s}},this.emit=async t=>{try{return await this.engine.emit(t)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async t=>{try{return await this.engine.disconnect(t)}catch(s){throw this.logger.error(s.message),s}},this.find=t=>{try{return this.engine.find(t)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(t){throw this.logger.error(t.message),t}},this.name=e?.name||Fa.name,this.metadata=e?.metadata||vh();let r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:(0,Od.default)((0,Ir.getDefaultLoggerOptions)({level:e?.logger||Fa.logger}));this.core=e?.core||new Sd(e),this.logger=(0,Ir.generateChildLogger)(r,this.name),this.session=new Ba(this.core,this.logger),this.proposal=new ka(this.core,this.logger),this.pendingRequest=new Ha(this.core,this.logger),this.engine=new ja(this)}static async init(e){let r=new vi(e);return await r.initialize(),r}get context(){return(0,Ir.getLoggerContext)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}},Nd=vi;var Cd=typeof window<"u";var Md=oe(Pd());var G=oe(Wa());var qd=({connectWallet:i,openModal:e})=>{let[r,t]=vt.default.useState("");return vt.default.useEffect(()=>{Cd&&Nd.init({projectId:"dacff933c2c1886c24cbdf69b5bbf21c",metadata:{name:"izar-network",url:"my-auth-dapp.com",description:"A dapp using WalletConnect SignClient",icons:["https://my-auth-dapp.com/icons/logo.png"]}}).then(async s=>{let{uri:n,approval:o}=await s.connect({requiredNamespaces:{stellar:{methods:["stellar_signXDR"],chains:["stellar:pubnet"],events:[]}}});n&&t(n),o().then(async a=>{let c=Object.values(a.namespaces).map(l=>l.accounts).flat(),u=Object.keys(a.namespaces),h=c[0].replace("stellar:pubnet:","");await i({public_key:h,provider:"wallet_connect"})}).catch(a=>{console.log("APPROVAL ERROR",a)})})},[]),r?(0,G.jsx)("div",{children:(0,G.jsx)(Md.QRCode,{value:r,logoImage:"https://imagedelivery.net/uDbEDRBQqhBXrrfuCRrATQ/eee714c7-b85b-42cf-23f7-d986b99c1b00/public",logoHeight:48,logoWidth:48,eyeRadius:8,size:256,bgColor:"#C8D1E6",fgColor:"#03050B",removeQrCodeBehindLogo:!0,qrStyle:"dots"})}):(0,G.jsx)(Rr,{})},c1=({connectWallet:i,openModal:e})=>(new Kt("albedo","TESTNET").getPublicKey().then(async t=>{await i({public_key:t.pubkey,provider:"albedo"})}),(0,G.jsx)(Rr,{})),u1=({connectWallet:i,openModal:e})=>(vt.default.useEffect(()=>{(0,Fd.isConnected)()&&new Kt("freighter","TESTNET").getPublicKey().then(async t=>{let s=await t();console.log("public_key",s),e({type:"challenge",content:s})})},[]),(0,G.jsx)(Rr,{})),l1=({connectWalle:i,openModal:e})=>(new Kt("rabet","TESTNET").getPublicKey().then(async({publicKey:t})=>{}),(0,G.jsx)(Rr,{})),Ld=[{name:"Albedo",icon:"albedo"},{name:"Rabet",icon:"rabet"},{name:"Freighter",icon:"freighter"}],h1=(i,e,r)=>{switch(i){case"Rabet":return(0,G.jsx)(l1,{connectWallet:e,openModal:r});case"Freighter":return(0,G.jsx)(u1,{connectWallet:e,openModal:r});case"Albedo":return(0,G.jsx)(c1,{connectWallet:e,openModal:r});case"Wallet Connect":return(0,G.jsx)(qd,{connectWallet:e});default:return(0,G.jsx)(G.Fragment,{})}},Ud=({text:i,icon:e})=>(0,G.jsxs)("div",{className:"flex flex-row",children:[(0,G.jsx)(Ja,{name:e,size:"large"}),(0,G.jsx)("div",{className:"text-h3-small-bold",style:{paddingLeft:"12px"},children:i})]}),oD=({})=>{let[i,e]=vt.default.useState(""),[r,t]=vt.default.useState(Ld[0]),[s,n]=vt.default.useState({public_key:"",provider:""}),o=Ga(),{closeModal:a,openModal:c}=Qa();vt.default.useEffect(()=>{let{public_key:h,provider:l}=s;h&&o.type==="init"&&o.submit({public_key:h,provider:l},{method:"post",action:"/auth_wallet"}),o.type==="done"&&console.log("closing window ...",o.data)},[s.public_key,o]);let u={text:`${i===""?`Continue with ${r.name}`:"Cancel"}`,variant:`${i===""?"primary":"warning"}`};return(0,G.jsx)("div",{children:(0,G.jsx)("div",{style:{backgroundImage:"url('https://imagedelivery.net/uDbEDRBQqhBXrrfuCRrATQ/cb3fca94-6358-47a3-6150-a10d0d7e1100/public')",backgroundSize:"cover",height:"100vh",width:"100%"},children:(0,G.jsx)(Xa,{variant:"large",children:(0,G.jsx)("div",{className:"flex items-center h-screen",children:(0,G.jsx)("div",{className:"bg-neutral-300 rounded-[20px] p-[40px] w-full ",children:(0,G.jsxs)("div",{className:"flex flex-col",children:[(0,G.jsxs)("div",{className:"flex flex-row w-full",children:[(0,G.jsxs)("div",{className:"flex-1",children:[(0,G.jsx)(Ud,{text:"Wallet Connect",icon:"walletConnect"}),(0,G.jsx)("div",{className:"text-paragraph-medium-medium ",children:"Scan the QR with your phone from a wallet app"}),(0,G.jsx)("div",{className:"flex flex-col items-center my-8",style:{height:"300px"},children:(0,G.jsx)(qd,{connectWallet:n})})]}),(0,G.jsxs)("div",{className:"flex-1",children:[(0,G.jsx)(Ud,{text:"Extensions",icon:"extensions"}),(0,G.jsx)("div",{className:"text-paragraph-medium-medium ",children:"Other login options to login from your browser"}),(0,G.jsx)("div",{children:(0,G.jsx)("div",{className:"flex flex-col space-y-4",children:i===""?(0,G.jsx)(G.Fragment,{children:Ld.map((h,l)=>(0,G.jsx)("div",{children:(0,G.jsx)(Ya,{customCss:"w-full",variant:"basic",icon:h.icon,text:h.name,onClick:()=>e(h.name)})},l))}):h1(i,n,c)})})]})]}),(0,G.jsx)("div",{children:(0,G.jsxs)("div",{className:"text-caption-medium text-center",children:[(0,G.jsx)("span",{children:"By continuing you accept our "}),(0,G.jsx)("span",{className:"text-caption-underlined text-primary-700",children:"term of conditioons"}),(0,G.jsx)("span",{children:" and our "}),(0,G.jsx)("span",{className:"text-caption-underlined text-primary-700",children:"privacy policy"})]})})]})})})})})})};export{oD as a};
